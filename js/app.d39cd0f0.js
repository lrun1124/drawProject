(function(t){function e(e){for(var o,s,r=e[0],h=e[1],c=e[2],d=0,u=[];d<r.length;d++)s=r[d],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&u.push(n[s][0]),n[s]=0;for(o in h)Object.prototype.hasOwnProperty.call(h,o)&&(t[o]=h[o]);l&&l(e);while(u.length)u.shift()();return a.push.apply(a,c||[]),i()}function i(){for(var t,e=0;e<a.length;e++){for(var i=a[e],o=!0,r=1;r<i.length;r++){var h=i[r];0!==n[h]&&(o=!1)}o&&(a.splice(e--,1),t=s(s.s=i[0]))}return t}var o={},n={app:0},a=[];function s(e){if(o[e])return o[e].exports;var i=o[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=t,s.c=o,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)s.d(i,o,function(e){return t[e]}.bind(null,o));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],h=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var l=h;a.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"034f":function(t,e,i){"use strict";var o=i("85ec"),n=i.n(o);n.a},"274b":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFQAAABWCAYAAABRo7HKAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAGCSURBVHhe7dkxjoJAAEbhvTY3sbChsbChsaFAExoKDsAJvAMNmd1ZgaxxNlnhxcjmfclf2MGLQYGPIJRBYQaFzUG7rnMrNrkLqmUMCjMozKAwg8IMCjMozKAwg8IMCjMozKAwg8IMCjMozKAwg8IMCjMozKAwg8IMCjMozKAwg8JeFrRt23C9XsdP/9dLgjZNE7IsMyihruvvmAYFVFU1xzToSmVZ3sU06Aqn0+khpkEXKooiGTPOoE86Ho/JkNMM+oTD4ZCM+HMG/YNhGEKe58mAW9jlchnPhLEqaN/3Yb/fJw90K3uroLvdLnmQW5rfUHjn83k8G8aqoNHWr6FvF3Tir/wNFjTyfygcNPJOCQ4aeS9/gwWNfNoEB418HjqigkY+sf9CBo18pwQHjXzrqUUMCjMozKAwg8IMCjMozKAwg8IMCjMozKAwg8IMCjMozKAwg8IMCjMozKAwg8IMCjMozKAwg8IMCjMozKAwg8IMCvs1qFu+yRxUDIPCDIoK4RPZa+LRDGJ3GgAAAABJRU5ErkJggg=="},3504:function(t){t.exports=JSON.parse('{"node":{"head":"外形","fill":"背景","stroke":"边框","font":"文字","fontSize":"大小","fontStyle":"样式","textFill":"颜色","position":"位置","nodeAlign":"对齐方式","prefabrication":"预制样式"},"group":{"head":"外形","fill":"背景","stroke":"边框","showHead":"显示头部","font":"文字","fontStyle":"样式","fontSize":"大小","fontBackground":"背景","align":"对齐方式","textFill":"颜色","position":"位置","prefabrication":"预制样式"},"edge":{"head":"样式","fill":"文字背景","stroke":"边框","lineDash":"线段样式","lineStyle":"线段形式","turningDistance":"转折距离","font":"文字","fontStyle":"样式","fontSize":"大小","textFill":"颜色","nodeAlign":"节点对齐","position":"Position","prefabrication":"预制样式"}}')},"3e69":function(t,e,i){},"3efa":function(t,e,i){},"42ec":function(t,e,i){},4813:function(t,e,i){},"4e4d":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFcAAABVCAYAAAA8AHhnAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAGSSURBVHhe7dA9isJQGEbh2bYLsbGxsbCwSWNjkYCNO3ANWYGFRYZPGHDMHfybY74L54GXEL25xfkahDEuyLigUdzj8eje2LViXL3GuCDjgowLqjZu27ajZVNt3NlsNlo2xgUZF2RckHFBxgUZF2RckHFBxgUZF2RckHFBxgUZF2RckHFBxgUZF2RckHFBxgUZF2RckHFBxgUZF2RckHFBxgUZF2RckHFBxgUZF2RckHFBxgUZF2RckHFBxgUZF2RckHFBxgUZF2RckHFBxgWljNv3/d2V4pbO3e6TUsY9HA7FeO8u7v2klHHDfr8vBnp1cd+npY0buq4rhnp2cc8UUscNu92uGOzRxfdTSR83bLfbYrh7i++mVEXc0DRNMeBfi/NTqyZu2Gw2xZC3i3MZVBU3rNfrYtCfxf9ZVBc3rFarYtj4PZMq44blcvkrbLxnU23c8/k8LBaLS9h4xns21cYNp9NpmM/nl2dGVcfNzrgg44KMCzIuyLgg44KMCzIuyLigh+K613dtFFf/x7iYYfgGt8Uegdxhb5AAAAAASUVORK5CYII="},5490:function(t,e,i){"use strict";var o=i("a6b6"),n=i.n(o);n.a},"56d7":function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d"),i("b64b"),i("159b");var o=i("2b0e"),n=i("a925");o["a"].use(n["a"]);var a="zh",s="localeLanguage",r={zh:i("3504"),en:i("edd4")},h=new n["a"]({locale:a,messages:r}),c=function(t){void 0===t&&(t=window.localStorage.getItem(s),void 0===r[t]&&(t=a)),window.localStorage.setItem(s,t),Object.keys(r).forEach((function(t){document.body.classList.remove("lang-".concat(t))})),document.body.classList.add("lang-".concat(t)),document.body.setAttribute("lang",t),o["a"].config.lang=t,h.locale=t};window.i18n=h;var l=h,d=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("MainPage")],1)},u=[],f=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"MainPage"},[i("Header"),i("Toolbar"),i("Editor"),i("Property"),i("Map")],1)},p=[],g=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"header"},[i("span",{staticStyle:{float:"left","margin-left":"20px","font-size":"20px","font-weight":"bold"}},[t._v("云绘图")]),i("span",{staticClass:"iconfont icon-open",staticStyle:{float:"left","margin-left":"10px","font-size":"18px",display:"none"},on:{click:function(e){return e.stopPropagation(),t.openFile(e)}}}),i("ul",[i("li",[i("button",{on:{click:function(e){return t.command(t.delAllIcon)}}},[t._v("清除")])]),t._l(t.icon,(function(e,o){return i("li",{key:o,class:"iconfont "+e.icon+" "+e.class,attrs:{title:e.cmd},on:{click:function(i){return t.command(e)}}})})),i("li",[i("span",{staticClass:"iconfont icon-upload-demo",on:{click:function(e){return e.stopPropagation(),t.save("png")}}})])],2),i("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"file"}})])},y=[],x=(i("c975"),i("b0c0"),i("8a79"),new o["a"]),v={name:"Header",data:function(){return{language:"zh",showLang:!1,delAllIcon:{icon:"icon-shanchu",name:"清除",cmd:"deleteAll",class:"enable"},icon:[{icon:"icon-fengexian",name:"分割",cmd:"line",class:"disable"},{icon:"icon-copy",name:"复制",cmd:"copy",class:"disable"},{icon:"icon-shanchu",name:"删除",cmd:"delete",class:"disable"},{icon:"icon-redo",name:"旋转",cmd:"rotate",class:"disable"},{icon:"icon-fengexian",name:"分割",cmd:"line",class:"disable"}],disable:!0,upload:!1}},computed:{lang:function(){return"zh"==this.language?"中文":"English"}},mounted:function(){var t=this;x.$on("selectNode",(function(){t.status="selectNode",t.changeDisable(!0)})),x.$on("clearSelect",(function(){t.status="clearSelect",t.changeDisable(!1)})),x.$on("selectGroup",(function(){t.status="selectGroup",t.changeDisable(!0)})),x.$on("undoredo",(function(e){t.enableUndo(e.undo),t.enableRedo(e.redo)})),x.$on("selectEdge",(function(){t.status="selectEdge",t.changeDisable(!0)}));var e=document.getElementById("file");e.addEventListener("change",(function(t){var i=t.target.files[0];if(i&&i.name.endsWith("json")){var o=new FileReader;o.readAsText(i),o.onload=function(){try{x.$emit("initFlow",{data:JSON.parse(this.result)})}catch(t){alert("数据出错")}}}e.value=""}),!1),this.language=localStorage.getItem("localeLanguage")||"zh",this.changeLanguage(this.language)},methods:{openFile:function(){document.getElementById("file").click()},changeLanguage:function(t){this.language=t,x.$emit("changeLanguage",{language:t})},mouseenter:function(){this.showLang=!0},mouseleave:function(){this.showLang=!1},command:function(t){"disable"!=t.class&&x.$emit(t.cmd)},changeDisable:function(t){t?this.icon.forEach((function(t){-1==["undo","redo","deleteAll"].indexOf(t.cmd)&&(t.class="")})):this.icon.forEach((function(t){-1==["undo","redo","deleteAll"].indexOf(t.cmd)&&(t.class="disable")})),this.disable=t},enableUndo:function(t){this.icon[0].class=t?"":"disable"},enableRedo:function(t){this.icon[1].class=t?"":"disable"},showUpload:function(){this.upload=!this.upload},save:function(t){this.upload=!1,x.$emit("saveData",{type:t})}}},m=v,w=(i("ee1c"),i("2877")),b=Object(w["a"])(m,g,y,!1,null,"0acc3e79",null),k=b.exports,O=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"toolbar"},[t.facilites.length?i("div",{staticClass:"shape clearfix shape-image"},[i("div",[i("div",[i("button",{staticClass:"toolbar-switch-button",on:{click:function(e){return t.command(1)}}},[t._v("设备")])]),i("div",[i("button",{staticClass:"toolbar-switch-button",on:{click:function(e){return t.command(2)}}},[t._v("组合")])]),i("div",[i("button",{staticClass:"toolbar-switch-button",on:{click:function(e){return t.command(3)}}},[t._v("障碍物")])]),i("div",[i("button",{staticClass:"toolbar-switch-button",on:{click:function(e){return t.command(4)}}},[t._v("房间")])])]),1==t.currentPanel?i("ul",{staticClass:"clearfix child-panel"},t._l(t.preFacilites,(function(e){return i("li",{key:e.command,class:"iconfont "+e.iconName,attrs:{draggable:"true"},on:{dragstart:function(i){return t.dragstart(i,e)}}},[i("div",{attrs:{title:e.text},domProps:{innerHTML:t._s(e.path)}})])})),0):t._e()]):t._e(),3==t.currentPanel?i("div",{staticClass:"shape clearfix shape-image"},[i("ul",{staticClass:"clearfix child-panel"},t._l(t.preObstacle,(function(e){return i("li",{key:e.command,class:"iconfont "+e.iconName,attrs:{draggable:"true"},on:{dragstart:function(i){return t.dragstart(i,e)}}},[i("div",{attrs:{title:e.text},domProps:{innerHTML:t._s(e.path)}})])})),0)]):t._e(),4==t.currentPanel?i("div",{staticClass:"shape clearfix shape-image"},[i("ul",{staticClass:"clearfix child-panel"},t._l(t.precustomize,(function(e,o){return i("li",{key:o,attrs:{draggable:"true"},on:{dragstart:function(i){return t.dragstart(i,e)}}},[i("div",{staticStyle:{"font-size":"20px",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"},domProps:{innerHTML:t._s(e.roomName)}})])})),0)]):t._e(),1==t.currentPanel?i("div",{staticClass:"toolbar-btn",on:{click:function(e){e.stopPropagation(),t.showFacilityDialog=!t.showFacilityDialog}}},[t._v(" 设备管理 ")]):t._e(),t.showFacilityDialog?i("div",{staticClass:"customize-win"},[i("div",{staticClass:"customize-win-header"},[i("span",[t._v("设备")]),i("div",{staticClass:"close iconfont icon-guanbi",on:{click:function(e){e.stopPropagation(),t.showFacilityDialog=!1}}})]),i("div",{staticClass:"customize-image"},[i("ul",[t._l(t.facilites,(function(e,o){return i("li",{key:o,attrs:{draggable:"true"}},[i("span",{staticClass:"iconfont icon-guanbi",on:{click:function(i){return i.stopPropagation(),t.removeFacility(e)}}}),i("div",{staticStyle:{"font-size":"15px","max-width":"50px",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"},domProps:{innerHTML:t._s(e.name)}})])})),i("li",{on:{click:function(e){e.stopPropagation(),t.showFacilityDetail=!t.showFacilityDetail}}},[i("span",{staticClass:"iconfont icon-add",staticStyle:{color:"#666","font-size":"48px","line-height":"44px","text-align":"center",cursor:"pointer"}})])],2)])]):t._e(),t.showFacilityDetail?i("div",{staticClass:"facility-win"},[i("div",{staticClass:"customize-win-header"},[i("div",{staticClass:"close iconfont icon-guanbi",on:{click:function(e){e.stopPropagation(),t.showFacilityDetail=!1}}})]),i("div",{staticClass:"upload-win-content"},[t._m(0),i("div",{staticStyle:{"margin-bottom":"10px"}},[i("span",[t._v("名称：")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.facility.name,expression:"facility.name"}],staticClass:"image-url",attrs:{placeholder:"名字/编号",type:"text"},domProps:{value:t.facility.name},on:{input:function(e){e.target.composing||t.$set(t.facility,"name",e.target.value)}}})]),i("div",{staticStyle:{"margin-bottom":"10px"}},[i("span",[t._v("长度：")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.facility.width,expression:"facility.width"}],staticClass:"image-url",attrs:{placeholder:"单位cm",type:"text"},domProps:{value:t.facility.width},on:{input:function(e){e.target.composing||t.$set(t.facility,"width",e.target.value)}}})]),i("div",{staticStyle:{"margin-bottom":"10px"}},[i("span",[t._v("宽度：")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.facility.height,expression:"facility.height"}],staticClass:"image-url",attrs:{placeholder:"单位cm",type:"text"},domProps:{value:t.facility.height},on:{input:function(e){e.target.composing||t.$set(t.facility,"height",e.target.value)}}})]),i("div",{staticStyle:{"margin-bottom":"10px"}},[i("span",[t._v("价格：")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.facility.cost,expression:"facility.cost"}],staticClass:"image-url",attrs:{placeholder:"单位:元",type:"text"},domProps:{value:t.facility.cost},on:{input:function(e){e.target.composing||t.$set(t.facility,"cost",e.target.value)}}})]),t._m(1),i("div",{staticStyle:{"margin-bottom":"10px"}},[i("span",[t._v("上侧：")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.facility.safe.up,expression:"facility.safe.up"}],staticClass:"image-url",attrs:{placeholder:"单位cm，默认为0",type:"text"},domProps:{value:t.facility.safe.up},on:{input:function(e){e.target.composing||t.$set(t.facility.safe,"up",e.target.value)}}})]),i("div",{staticStyle:{"margin-bottom":"10px"}},[i("span",[t._v("下侧：")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.facility.safe.down,expression:"facility.safe.down"}],staticClass:"image-url",attrs:{placeholder:"单位cm，默认为0",type:"text"},domProps:{value:t.facility.safe.down},on:{input:function(e){e.target.composing||t.$set(t.facility.safe,"down",e.target.value)}}})]),i("div",{staticStyle:{"margin-bottom":"10px"}},[i("span",[t._v("左侧：")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.facility.safe.left,expression:"facility.safe.left"}],staticClass:"image-url",attrs:{placeholder:"单位cm，默认为0",type:"text"},domProps:{value:t.facility.safe.left},on:{input:function(e){e.target.composing||t.$set(t.facility.safe,"left",e.target.value)}}})]),i("div",{staticStyle:{"margin-bottom":"10px"}},[i("span",[t._v("右侧：")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.facility.safe.right,expression:"facility.safe.right"}],staticClass:"image-url",attrs:{placeholder:"单位cm，默认为0",type:"text"},domProps:{value:t.facility.safe.right},on:{input:function(e){e.target.composing||t.$set(t.facility.safe,"right",e.target.value)}}})]),i("div",{staticStyle:{"margin-bottom":"40px"}},[i("span",[t._v("操作台朝向：")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.facility.face,expression:"facility.face"}],attrs:{type:"radio",name:"face",value:"0"},domProps:{checked:t._q(t.facility.face,"0")},on:{change:function(e){return t.$set(t.facility,"face","0")}}}),i("label",{attrs:{for:"up"}},[t._v("上")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.facility.face,expression:"facility.face"}],attrs:{type:"radio",name:"face",value:"2"},domProps:{checked:t._q(t.facility.face,"2")},on:{change:function(e){return t.$set(t.facility,"face","2")}}}),i("label",{attrs:{for:"down"}},[t._v("下")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.facility.face,expression:"facility.face"}],attrs:{type:"radio",name:"face",value:"3"},domProps:{checked:t._q(t.facility.face,"3")},on:{change:function(e){return t.$set(t.facility,"face","3")}}}),i("label",{attrs:{for:"left"}},[t._v("左")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.facility.face,expression:"facility.face"}],attrs:{type:"radio",name:"face",value:"1"},domProps:{checked:t._q(t.facility.face,"1")},on:{change:function(e){return t.$set(t.facility,"face","1")}}}),i("label",{attrs:{for:"right"}},[t._v("右")])])]),i("div",{staticClass:"upload-win-footer"},[i("button",{on:{click:t.addFacility}},[t._v("确定")])])]):t._e(),3==t.currentPanel?i("div",{staticClass:"toolbar-btn",on:{click:function(e){e.stopPropagation(),t.showObstacleDialog=!t.showObstacleDialog}}},[t._v(" 障碍物管理 ")]):t._e(),t.showObstacleDialog?i("div",{staticClass:"customize-win"},[i("div",{staticClass:"customize-win-header"},[i("span",[t._v("障碍物")]),i("div",{staticClass:"close iconfont icon-guanbi",on:{click:function(e){e.stopPropagation(),t.showObstacleDialog=!1}}})]),i("div",{staticClass:"customize-image"},[i("ul",[t._l(t.obstacles,(function(e,o){return i("li",{key:o,attrs:{draggable:"true"}},[i("span",{staticClass:"iconfont icon-guanbi",on:{click:function(i){return i.stopPropagation(),t.removeObstacle(e)}}}),i("div",{staticStyle:{"font-size":"15px","max-width":"50px",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"},domProps:{innerHTML:t._s(e.name)}})])})),i("li",{on:{click:function(e){e.stopPropagation(),t.showObstacleDetail=!t.showObstacleDetail}}},[i("span",{staticClass:"iconfont icon-add",staticStyle:{color:"#666","font-size":"48px","line-height":"44px","text-align":"center",cursor:"pointer"}})])],2)])]):t._e(),t.showObstacleDetail?i("div",{staticClass:"upload-win-child"},[i("div",{staticClass:"customize-win-header"},[i("div",{staticClass:"close iconfont icon-guanbi",on:{click:function(e){e.stopPropagation(),t.showObstacleDetail=!1}}})]),i("div",{staticClass:"upload-win-content"},[t._m(2),i("div",{staticStyle:{"margin-bottom":"20px"}},[i("span",[t._v("名称：")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.obstacle.name,expression:"obstacle.name"}],staticClass:"image-url",attrs:{placeholder:"名字/编号",type:"text",text:"obstacleName"},domProps:{value:t.obstacle.name},on:{input:function(e){e.target.composing||t.$set(t.obstacle,"name",e.target.value)}}})]),i("div",{staticStyle:{"margin-bottom":"20px"}},[i("span",[t._v("长度：")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.obstacle.width,expression:"obstacle.width"}],staticClass:"image-url",attrs:{placeholder:"单位cm",type:"text",text:"obstacleWidth"},domProps:{value:t.obstacle.width},on:{input:function(e){e.target.composing||t.$set(t.obstacle,"width",e.target.value)}}})]),i("div",{staticStyle:{"margin-bottom":"20px"}},[i("span",[t._v("宽度：")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.obstacle.height,expression:"obstacle.height"}],staticClass:"image-url",attrs:{placeholder:"单位cm",type:"text",text:"obstacleHeight"},domProps:{value:t.obstacle.height},on:{input:function(e){e.target.composing||t.$set(t.obstacle,"height",e.target.value)}}})])]),i("div",{staticClass:"upload-win-footer"},[i("button",{on:{click:t.addObstacle}},[t._v("确定")])])]):t._e(),4==t.currentPanel?i("div",{staticClass:"toolbar-btn",on:{click:function(e){e.stopPropagation(),t.showCustomize=!t.showCustomize}}},[t._v(" 房间管理 ")]):t._e(),t.showCustomize?i("div",{staticClass:"customize-win"},[i("div",{staticClass:"customize-win-header"},[i("span",[t._v("房间")]),i("div",{staticClass:"close iconfont icon-guanbi",on:{click:function(e){e.stopPropagation(),t.showCustomize=!1}}})]),i("div",{staticClass:"customize-image"},[i("ul",[t._l(t.customize,(function(e,o){return i("li",{key:o,attrs:{draggable:"true"}},[i("span",{staticClass:"iconfont icon-guanbi",on:{click:function(i){return i.stopPropagation(),t.removeRoom(e)}}}),i("div",{staticStyle:{"font-size":"15px","max-width":"50px",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"},domProps:{innerHTML:t._s(e.roomName)}})])})),i("li",{on:{click:function(e){e.stopPropagation(),t.showUpload=!t.showUpload}}},[i("span",{staticClass:"iconfont icon-add",staticStyle:{color:"#666","font-size":"48px","line-height":"44px","text-align":"center",cursor:"pointer"}})])],2)])]):t._e(),t.showUpload?i("div",{staticClass:"upload-win"},[i("div",{staticClass:"customize-win-header"},[i("div",{staticClass:"close iconfont icon-guanbi",on:{click:function(e){e.stopPropagation(),t.showUpload=!1}}})]),i("div",{staticClass:"upload-win-content"},[i("div",{staticStyle:{"margin-bottom":"20px"}},[i("span",{staticStyle:{"padding-right":"12px"}},[t._v("房间名：")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.roomName,expression:"roomName"}],staticClass:"image-url",staticStyle:{width:"200px"},attrs:{placeholder:"房间名",type:"text",text:"roomData"},domProps:{value:t.roomName},on:{input:function(e){e.target.composing||(t.roomName=e.target.value)}}})]),i("div",{staticStyle:{"margin-bottom":"20px"}},[i("span",[t._v("房间参数：")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.roomData,expression:"roomData"}],staticClass:"image-url",attrs:{placeholder:"例如: 右:500;下:300;左:500;上:300。或者使用以下方向生成 (单位cm)",type:"text",text:"roomData"},domProps:{value:t.roomData},on:{input:function(e){e.target.composing||(t.roomData=e.target.value)}}})]),i("div",{staticStyle:{"margin-bottom":"20px"}},[t._v("请按顺时针方向绘制参数:")]),i("div",{staticStyle:{"text-align":"center"}},[i("img",{attrs:{src:t.imgUrlRight},on:{click:function(e){e.stopPropagation(),t.showRight=!t.showRight}}}),i("img",{attrs:{src:t.imgUrlDown},on:{click:function(e){e.stopPropagation(),t.showDown=!t.showDown}}}),i("img",{attrs:{src:t.imgUrlLeft},on:{click:function(e){e.stopPropagation(),t.showLeft=!t.showLeft}}}),i("img",{attrs:{src:t.imgUrlUp},on:{click:function(e){e.stopPropagation(),t.showUp=!t.showUp}}})])]),i("div",{staticClass:"upload-win-footer"},[i("button",{on:{click:t.addRoom}},[t._v("确定")])])]):t._e(),t.showRight?i("div",{staticClass:"upload-win-child"},[i("div",{staticClass:"customize-win-header"},[i("div",{staticClass:"close iconfont icon-guanbi",on:{click:function(e){e.stopPropagation(),t.showRight=!1}}})]),i("div",{staticClass:"upload-win-content"},[t._m(3),i("div",{staticStyle:{"margin-bottom":"20px"}},[i("span",[t._v("实际长度：")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.rightLength,expression:"rightLength"}],staticClass:"image-url",attrs:{placeholder:"单位cm",type:"text",text:"rightLength"},domProps:{value:t.rightLength},on:{input:function(e){e.target.composing||(t.rightLength=e.target.value)}}})])]),i("div",{staticClass:"upload-win-footer"},[i("button",{on:{click:t.addRight}},[t._v("确定")])])]):t._e(),t.showDown?i("div",{staticClass:"upload-win-child"},[i("div",{staticClass:"customize-win-header"},[i("div",{staticClass:"close iconfont icon-guanbi",on:{click:function(e){e.stopPropagation(),t.showDown=!1}}})]),i("div",{staticClass:"upload-win-content"},[t._m(4),i("div",{staticStyle:{"margin-bottom":"20px"}},[i("span",[t._v("实际长度：")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.downLength,expression:"downLength"}],staticClass:"image-url",attrs:{placeholder:"单位cm",type:"text",text:"rightLength"},domProps:{value:t.downLength},on:{input:function(e){e.target.composing||(t.downLength=e.target.value)}}})])]),i("div",{staticClass:"upload-win-footer"},[i("button",{on:{click:t.addDown}},[t._v("确定")])])]):t._e(),t.showLeft?i("div",{staticClass:"upload-win-child"},[i("div",{staticClass:"customize-win-header"},[i("div",{staticClass:"close iconfont icon-guanbi",on:{click:function(e){e.stopPropagation(),t.showLeft=!1}}})]),i("div",{staticClass:"upload-win-content"},[t._m(5),i("div",{staticStyle:{"margin-bottom":"20px"}},[i("span",[t._v("实际长度：")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.leftLength,expression:"leftLength"}],staticClass:"image-url",attrs:{placeholder:"单位cm",type:"text",text:"leftLength"},domProps:{value:t.leftLength},on:{input:function(e){e.target.composing||(t.leftLength=e.target.value)}}})]),t._m(6),t._m(7)]),i("div",{staticClass:"upload-win-footer"},[i("button",{on:{click:t.addLeft}},[t._v("确定")])])]):t._e(),t.showUp?i("div",{staticClass:"upload-win-child"},[i("div",{staticClass:"customize-win-header"},[i("div",{staticClass:"close iconfont icon-guanbi",on:{click:function(e){e.stopPropagation(),t.showUp=!1}}})]),i("div",{staticClass:"upload-win-content"},[t._m(8),i("div",{staticStyle:{"margin-bottom":"20px"}},[i("span",[t._v("实际长度：")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.upLength,expression:"upLength"}],staticClass:"image-url",attrs:{placeholder:"单位cm",type:"text",text:"upLength"},domProps:{value:t.upLength},on:{input:function(e){e.target.composing||(t.upLength=e.target.value)}}})])]),i("div",{staticClass:"upload-win-footer"},[i("button",{on:{click:t.addUp}},[t._v("确定")])])]):t._e()])},A=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{"margin-bottom":"10px"}},[i("span",[t._v("请输入设备参数")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{"margin-bottom":"10px"}},[i("span",[t._v("请输入安全距离")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{"margin-bottom":"20px"}},[i("span",[t._v("请输入障碍物尺寸")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{"margin-bottom":"20px"}},[i("span",[t._v("请输入向右的参数")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{"margin-bottom":"20px"}},[i("span",[t._v("请输入向下的参数")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{"margin-bottom":"20px"}},[i("span",[t._v("请输入向左的参数")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{"margin-bottom":"20px"}},[i("span",[t._v("倾斜角度：")]),i("input",{attrs:{type:"radio",name:"radio",value:"or_me"}}),t._v("无 "),i("input",{attrs:{type:"radio",name:"radio",value:"or_me"}}),t._v("有")])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{"margin-bottom":"20px"}},[i("span",[t._v("垂直长度：")]),i("input",{staticClass:"image-url",attrs:{placeholder:"默认不用填，斜线需要",type:"text",text:"name"}})])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{"margin-bottom":"20px"}},[i("span",[t._v("请输入向上的参数")])])}],D=(i("99af"),i("fb6a"),i("a434"),i("a9e3"),i("c35a"),i("25eb"),i("ac1f"),i("1276"),i("2909")),P={name:"Toolbar",data:function(){return{currentPanel:1,customize:[],showCustomize:!1,showUpload:!1,showRight:!1,showDown:!1,showLeft:!1,showUp:!1,roomData:"",roomName:"",currentScale:1,imgUrlRight:i("859b"),imgUrlDown:i("4e4d"),imgUrlLeft:i("274b"),imgUrlUp:i("dc17"),rightLength:"",downLength:"",leftLength:"",upLength:"",obstacles:[],obstacle:{width:"",height:"",name:"",kind:2},showObstacleDialog:!1,showObstacleDetail:!1,facilites:[],facility:{kind:3,name:"",width:"",height:"",cost:"",safe:{up:"",right:"",down:"",left:""},face:"0"},showFacilityDialog:!1,showFacilityDetail:!1,shape:[{id:"flowChart",header:"设备",icon:[{path:'<svg style="left: 1px; top: 1px; width: 32px; height: 30px; display: block; position: relative; overflow: hidden;"><g><g></g><g><g transform="translate(0.5,0.5)" style="visibility: visible;"><rect x="1.44" y="7.68" width="28.8" height="14.4"  fill="#ffffff" stroke="#000000" stroke-width="1.3" pointer-events="all"></rect></g></g><g></g><g></g></g></svg>',iconName:"",text:"rounded rectangle",command:"rectangle"},{path:'<svg style="left: 1px; top: 1px; width: 32px; height: 30px; display: block; position: relative; overflow: hidden;"><g><g></g><g><g transform="translate(0.5,0.5)" style="visibility: visible;"><rect x="0.73" y="7.3" width="29.2" height="14.6" fill="none" stroke="white" pointer-events="stroke" visibility="hidden" stroke-width="9"></rect><rect x="0.73" y="7.3" width="29.2" height="14.6" fill="none" stroke="none" pointer-events="all"></rect></g><g style=""><g transform="translate(7,10)scale(0.73)"><foreignObject style="overflow:visible;" pointer-events="all" width="22" height="12"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 24px; white-space: normal; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">Text</div></div></foreignObject></g></g></g><g></g><g></g></g></svg>',iconName:"",text:"text",command:"text"},{path:'<svg style="left: 1px; top: 1px; width: 32px; height: 30px; display: block; position: relative; overflow: hidden;"><g><g></g><g><g transform="translate(0.5,0.5)" style="visibility: visible;"><rect x="1.44" y="7.68" width="28.8" height="14.4" fill="#ffffff" stroke="#000000" stroke-width="1.3" pointer-events="all"></rect><path d="M 4.32 7.68 L 4.32 22.08 M 27.36 7.68 L 27.36 22.08" fill="none" stroke="white" stroke-width="9.3" stroke-miterlimit="10" pointer-events="stroke" visibility="hidden"></path><path d="M 4.32 7.68 L 4.32 22.08 M 27.36 7.68 L 27.36 22.08" fill="none" stroke="#000000" stroke-width="1.3" stroke-miterlimit="10" pointer-events="all"></path></g></g><g></g><g></g></g></svg>',iconName:"",text:"process",command:"preRect"}]}]}},computed:{precustomize:function(){return this.customize.slice().splice(0,15)},preObstacle:function(){return this.obstacles.slice().splice(0,15)},preFacilites:function(){return this.facilites.slice().splice(0,15)}},mounted:function(){var t=localStorage.getItem("customize-icon"),e=localStorage.getItem("obstacles-icon"),i=localStorage.getItem("facilities-icon");try{if(t){var o=JSON.parse(t);this.customize=o}if(e){var n={width:"60",height:"14",name:"门",kind:1};n.path=this.buildPath(n);var a=JSON.parse(e);this.obstacles=[n].concat(Object(D["a"])(a))}if(i){var s=JSON.parse(i);this.facilites=s}}catch(r){window.console.log(r)}},methods:{command:function(t){this.currentPanel=t},addRoom:function(){if(this.roomData&&this.roomName){var t={roomName:this.roomName,roomData:this.roomData};this.customize.push(t),this.storeRoom(),this.showUpload=!1,this.showCustomize=!1,this.roomData="",this.roomName=""}},addObstacle:function(){if(this.obstacle.width&&this.obstacle.height&&this.obstacle.name){var t=JSON.parse(JSON.stringify(this.obstacle));t.path=this.buildPath(this.obstacle),this.obstacles.push(t),this.storeObstacles(),this.showObstacleDetail=!1,this.showObstacleDialog=!1,this.obstacle.width="",this.obstacle.height="",this.obstacle.name=""}},addFacility:function(){if(this.facility.name&&this.facility.width&&this.facility.height){var t=JSON.parse(JSON.stringify(this.facility));t.path=this.buildPath(this.facility),this.facilites.push(t),this.storeFacilities(),this.showFacilityDetail=!1,this.showFacilityDialog=!1,this.facility.name="",this.facility.width="",this.facility.height="",this.facility.face=0,this.facility.safe.up="",this.facility.safe.down="",this.facility.safe.left="",this.facility.safe.right="",this.facility.cost=""}},buildPath:function(t){var e=function(t){return t.length>10?t.slice(0,5)+"...":t},i=function(t){return t.width+" × "+t.height+" cm"},o=110,n=35;if(1===t.kind&&(n=35),2===t.kind&&(n=35),t)return'<svg style="left: 1px; top: 1px; width: 130px; height: 80px; display: block; position: relative; overflow: hidden;"><g><g></g><g><g transform="translate(0.5,0.5)" style="visibility: visible;"><rect x="1.44" y="7.68" width="'+o+'" height="'+n+'"  fill="#ffffff" stroke="#000000" stroke-width="1.3" pointer-events="all"></rect><text x="18" y="35" fill="black" font-size="20">'+e(t.name)+'</text><text x="12" y="65" fill="black" font-size="16">'+i(t)+"</text></g></g><g></g><g></g></g></svg>"},addRight:function(){this.rightLength&&(this.roomData+="右:"+this.rightLength+";",this.showRight=!1)},addDown:function(){this.downLength&&(this.roomData+="下:"+this.downLength+";",this.showDown=!1)},addLeft:function(){this.leftLength&&(this.roomData+="左:"+this.leftLength+";",this.showLeft=!1)},addUp:function(){this.rightLength&&(this.roomData+="上:"+this.upLength+";",this.showUp=!1)},storeRoom:function(){localStorage.setItem("customize-icon",JSON.stringify(this.customize))},storeObstacles:function(){localStorage.setItem("obstacles-icon",JSON.stringify(this.obstacles))},storeFacilities:function(){localStorage.setItem("facilities-icon",JSON.stringify(this.facilites))},removeRoom:function(t){var e=this.customize.indexOf(t);e>-1&&(this.customize.splice(e,1),this.storeRoom())},removeObstacle:function(t){var e=this.obstacles.indexOf(t);e>-1&&(this.obstacles.splice(e,1),this.storeObstacles())},removeFacility:function(t){var e=this.facilites.indexOf(t);e>-1&&(this.facilites.splice(e,1),this.storeFacilities())},getRoomScale:function(t){for(var e,i=0,o=t.split(";"),n=0;n<o.length;n++){var a=o[n].split(":");0===n&&(e=Number.parseInt(a[1])),a[1]>i&&(i=a[1])}var s=window.innerWidth-150,r=window.innerHeight-150,h=Math.min(s,r),c=i/h*1.1,l=s/2-e/c/2;return{scale:c,offsetX:l}},buildRoomCommand:function(t,e){for(var i=[],o=t.split(";"),n=e.scale,a=0+e.offsetX,s=50,r=a,h=s,c=2,l=0;l<o.length;l++){var d={command:"line",kind:0,scale:n};if(""!==o[l]){var u=o[l].split(":"),f=u[0],p=u[1],g=Number.parseFloat(p)/n,y={x1:r,y1:h},x={style:{text:Number.parseInt(p)+"cm",fontSize:15},command:"text",position:[0,0],draggable:!1};switch(x.style.text>=6&&(x.style.fontSize=12),d.text=g,f){case"右":y.x2=y.x1+g,y.y2=y.y1,x.x=(y.x1+y.x2)/2-25,x.y=(y.y1+y.y2)/2-25,d.direction=0;break;case"下":y.y1-=c,y.x2=y.x1,y.y2=y.y1+g+c,x.x=(y.x1+y.x2)/2+5,x.y=(y.y1+y.y2)/2,d.direction=1;break;case"左":y.x2=y.x1-g,y.y2=y.y1,x.x=(y.x1+y.x2)/2-25,x.y=(y.y1+y.y2)/2+5,d.direction=2;break;case"上":y.y1+=c,y.x2=y.x1,y.y2=y.y1-g-c,x.x=(y.x1+y.x2)/2-60,x.y=(y.y1+y.y2)/2-2,d.direction=3;break}d.shape=y,i.push(d),i.push(x),r=y.x2,h=y.y2}}return i},buildObstacleCommand:function(t){if(t){var e=this.currentScale,i=Number.parseFloat(t.width)/e,o=Number.parseFloat(t.height)/e,n=t.name;return{style:{fill:"#A9C4EB",stroke:"#333",lineWidth:1,text:n,textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"inside",fontSize:12,opacity:1},kind:2,shape:{width:i,height:o},z:200,draggable:!0,command:"rectangle"}}},buildFacilityCommand:function(t){if(t){var e=this.currentScale,i=Number.parseFloat(t.width)/e,o=Number.parseFloat(t.height)/e,n=t.name,a=t.face;return{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:n,textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"inside",fontSize:12,opacity:1},safe:{up:Number.parseFloat(t.safe.up),down:Number.parseFloat(t.safe.down),left:Number.parseFloat(t.safe.left),right:Number.parseFloat(t.safe.right)},face:a,kind:3,shape:{width:i,height:o},z:200,draggable:!0,command:"preRect"}}},dragstart:function(t,e){var i="";if(e.roomData){var o=this.getRoomScale(e.roomData);i=JSON.stringify(this.buildRoomCommand(e.roomData,o)),this.currentScale=o.scale}else 2===e.kind?i=JSON.stringify(this.buildObstacleCommand(e)):3===e.kind&&(i=JSON.stringify(this.buildFacilityCommand(e)));""!==i&&t.dataTransfer.setData("addShape",i)},uploadImage:function(t){var e=t.target.files[0];if(e){var i=e.type,o=new FormData;o.append("smfile",e),["image/jpeg","image/png"].indexOf(i)>-1&&this.ajax({method:"POST",url:"https://sm.ms//api/v2/upload",body:o,succseeFn:function(t){window.console.log(t)},failFn:function(t){window.console.log(t)}})}},ajax:function(t){var e=t.method,i=t.url,o=t.body,n=t.succseeFn,a=t.failFn,s=new XMLHttpRequest;s.open(e,i,!0),s.setRequestHeader("Content-type","multipart/form-data"),s.setRequestHeader("Authorization",""),s.onreadystatechange=function(){4===s.readyState&&(s.status>=200&&s.status<300?n.call(void 0,s.responseText):s.status>=400&&a.call(void 0,s))},s.send(o)}}},S=P,T=(i("be14"),Object(w["a"])(S,O,A,!1,null,"698aff02",null)),C=T.exports,j=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"editor",on:{dragover:t.dragover,dragstart:t.dragstart,drop:t.drop}},[i("div",{attrs:{id:"flowEditor"}}),i("Edit",{directives:[{name:"show",rawName:"v-show",value:t.editModel,expression:"editModel"}],ref:"edit",staticClass:"text-editor",style:{left:t.left+"px",top:t.top+"px","min-width":t.width+"px","min-height":t.height+"px"},on:{blurFunc:t.updateText},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}})],1)},E=[],N=(i("a15b"),i("d3b7"),i("e25e"),i("3ca3"),i("5319"),i("498a"),i("ddb0"),i("2b3d"),i("a4d3"),i("4de4"),i("d81d"),i("e439"),i("dbb4"),i("acd8"),i("25f0"),i("ade3")),z=i("d4ec"),F=i("bee2"),G=i("99de"),_=i("7e84"),B=i("257e"),I=i("262e"),R=i("95c0"),L=i.n(R),$=function(){function t(e){Object(z["a"])(this,t),this.limit=e||30,this.undos=[],this.redos=[],this.saveCommand=null}return Object(F["a"])(t,[{key:"execute",value:function(t){this.clearRedo(),t.execute();var e=this.undos.length;e>=this.limit&&this.undos.shift(),this.undos.push(t),this.change(t)}},{key:"undo",value:function(){if(this.canUndo()){var t=this.undos.pop();this.redos.push(t),t.undo(),this.change(t)}}},{key:"canUndo",value:function(){return this.undos.length}},{key:"redo",value:function(){if(this.canRedo()){var t=this.redos.pop();this.undos.push(t),t.redo(),this.change(t)}}},{key:"canRedo",value:function(){return this.redos.length}},{key:"save",value:function(){this.saveCommand,this.undos[this.undos.length-1]}},{key:"dirty",value:function(){return this.saveCommand!=this.undos[this.undos.length-1]}},{key:"clearRedo",value:function(){this.redos=[]}},{key:"clear",value:function(){this.undos=[],this.redos=[],this.saveCommand=null,this.change({name:"clear"})}},{key:"change",value:function(){}}]),t}(),M=$;i("cb29");function W(t,e){for(var i in t)i in e||(e[i]=t[i]);return e}var U=W,H={getAnchors:function(){return this.anchors.slice()},getAnchorByIndex:function(t){return this.anchors.filter((function(e){return e.index==t}))[0]},active:function(){this.selected=!0,this.attr({style:{shadowColor:"yellow",shadowBlur:3}})},unactive:function(){this.selected=!1,this.attr({style:{shadowColor:"",shadowBlur:0}})},refreshEdge:function(){this.createAnchors(),this.anch&&this.anch.refresh(),this.__zr&&this.__zr.trigger("refreshEdge",{node:this})}},q=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new L.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},a={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,a)}}]),e}(L.a.Rect);U(H,q.prototype);var J=q,Y=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.anchors=[],i}return Object(I["a"])(e,t),e}(L.a.Line);U(H,Y.prototype);var K=Y,Q=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new L.a.Group,e=t.getBoundingRect([this]),i=e.y+e.height/2,o={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},n={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},a={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},s={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(o,n,a,s);var r=this.getPoint(e.width/4,e),h={x:e.x+3*e.width/4,y:i+r-2,index:5,node:this,direct:"right"},c={x:e.x+3*e.width/4,y:i-r+2,index:6,node:this,direct:"right"},l={x:e.x+e.width/4,y:i+r-2,index:7,node:this,direct:"left"},d={x:e.x+e.width/4,y:i-r+2,index:8,node:this,direct:"left"};this.anchors.push(h,c,l,d)}},{key:"getPoint",value:function(t,e){var i=e.width/2,o=e.height/2,n=Math.sqrt(o*o*Math.sqrt(1-t*t/(i*i)));return n}}]),e}(L.a.Ellipse);U(H,Q.prototype);var X=Q,V=L.a.Path.extend({type:"diamond",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.height,a=e.width;t.moveTo(i+a/2,o),t.lineTo(i+a,o+n/2),t.lineTo(i+a/2,o+n),t.lineTo(i,o+n/2),t.closePath()}}),Z=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"createAnchors",value:function(){var t=new L.a.Group;this.anchors=[];var e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},a={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,a)}}]),e}(V);U(H,Z.prototype);var tt=Z,et=L.a.Path.extend({type:"parallelogram",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.height,a=e.width;t.moveTo(i+a/6,o),t.lineTo(i+a,o),t.lineTo(i+5*a/6,o+n),t.lineTo(i,o+n),t.closePath()}}),it=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new L.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+11*e.width/12,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},a={x:e.x+e.width/12,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,a)}}]),e}(et);U(H,it.prototype);var ot=it,nt=L.a.Path.extend({type:"cloud",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i,o,n=e.x,a=e.y,s=e.height,r=e.width,h=20,c=parseInt(r/h),l=parseInt(s/h);t.moveTo(n,a);for(var d=1;d<=c;d++){i=n+d*h,o=a;var u=i-h/2,f=o-h/2;t.quadraticCurveTo(u,f,i,o)}if(r%h!=0){var p=r-c*h,g=i+p/2,y=a-h/2;t.quadraticCurveTo(g,y,n+r,a)}for(var x=1;x<=l;x++){i=n+r,o=a+x*h;var v=i+h/2,m=o-h/2;t.quadraticCurveTo(v,m,i,o)}if(s%h!=0){var w=s-l*h,b=i+h/2,k=o+w/2;t.quadraticCurveTo(b,k,n+r,a+s)}for(var O=1;O<=c;O++){i=n+r-h*O,o=a+s;var A=i+h/2,D=o+h/2;t.quadraticCurveTo(A,D,i,o),t.lineTo(i,o)}if(r%h!=0){var P=r-c*h,S=i-P/2,T=o+h/2;t.quadraticCurveTo(S,T,n,a+s)}for(var C=1;C<=l;C++){i=n,o=a+s-C*h;var j=i-h/2,E=o+h/2;t.quadraticCurveTo(j,E,i,o)}if(s%h!=0){var N=s-l*h,z=i-h/2,F=o-N/2;t.quadraticCurveTo(z,F,n,a)}t.closePath()}}),at=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.antchrs=[],i.nodeType="node",i.createAntchrs(),i}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"createAntchrs",value:function(){this.antchrs=[];var t=new L.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},a={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.antchrs.push(i,o,n,a)}}]),e}(nt);U(H,at.prototype);var st=at,rt=L.a.Path.extend({type:"arrowRight",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.height,a=e.width,s=parseInt(i+a-36),r=parseInt(o+n/5),h=parseInt(o+n/5*4);t.moveTo(i,r),t.lineTo(s,r),t.lineTo(s,o),t.lineTo(i+a,o+n/2),t.lineTo(s,o+n),t.lineTo(s,h),t.lineTo(i,h),t.closePath()}}),ht=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"createAnchors",value:function(){var t=new L.a.Group;this.anchors=[];var e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y+e.height/5,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height/5*4,index:3,node:this,direct:"bottom"},a={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,a)}}]),e}(rt);U(H,ht.prototype);var ct=ht;function lt(t,e){var i,o,n,a,s,r=e.x,h=e.y,c=e.width,l=e.height,d=e.r;c<0&&(r+=c,c=-c),l<0&&(h+=l,l=-l),"number"===typeof d?i=o=n=a=d:d instanceof Array?1===d.length?i=o=n=a=d[0]:2===d.length?(i=n=d[0],o=a=d[1]):3===d.length?(i=d[0],o=a=d[1],n=d[2]):(i=d[0],o=d[1],n=d[2],a=d[3]):i=o=n=a=0,i+o>c&&(s=i+o,i*=c/s,o*=c/s),n+a>c&&(s=n+a,n*=c/s,a*=c/s),o+n>l&&(s=o+n,o*=l/s,n*=l/s),i+a>l&&(s=i+a,i*=l/s,a*=l/s),t.moveTo(r+i,h),t.lineTo(r+c-o,h),0!==o&&t.arc(r+c-o,h+o,o,-Math.PI/2,0),t.lineTo(r+c,h+l-n),0!==n&&t.arc(r+c-n,h+l-n,n,0,Math.PI/2),t.lineTo(r+a,h+l),0!==a&&t.arc(r+a,h+l-a,a,Math.PI/2,Math.PI),t.lineTo(r,h+i),0!==i&&t.arc(r+i,h+i,i,Math.PI,1.5*Math.PI)}var dt=L.a.Path.extend({type:"aroundRect",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.width,o=e.height,n=Math.max(i,o);e.r=n,lt(t,e),t.closePath()}}),ut=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new L.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},a={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,a)}}]),e}(dt);U(H,ut.prototype);var ft=ut,pt=L.a.Path.extend({type:"preRect",shape:{x:0,y:0,width:0,height:0},kind:3,alerts:[],safe:{up:0,right:150,down:0,left:100},face:"1",buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,a=e.height,s=2;if(e.r=s,lt(t,e),"2"===this.face){var r=parseInt(o+a/10*9);t.moveTo(i,r),t.lineTo(i+n,r)}else if("1"===this.face){var h=parseInt(i+n/10*9);t.moveTo(h,o),t.lineTo(h,o+a)}else if("0"===this.face){var c=parseInt(o+a/10);t.moveTo(i,c),t.lineTo(i+n,c)}else{var l=parseInt(i+n/10);t.moveTo(l,o),t.lineTo(l,o+a)}t.closePath()}}),gt=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"createAnchors",value:function(){}}]),e}(pt);U(H,gt.prototype);var yt=gt,xt=L.a.Path.extend({type:"document",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.width,o=e.height,n=e.x,a=e.y;t.moveTo(n,a),t.lineTo(n+i,a),t.lineTo(n+i,a+o-14),t.quadraticCurveTo(n+i/4*3,parseInt(a+o-20),n+i/2,parseInt(a+o-14)),t.quadraticCurveTo(n+i/4,a+o,n,parseInt(a+o-7)),t.lineTo(n,a),t.closePath()}}),vt=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new L.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height-10,index:3,node:this,direct:"bottom"},a={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,a)}}]),e}(xt);U(H,vt.prototype);var mt=vt,wt=L.a.Path.extend({type:"delay",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,a=e.height,s=a/2;t.moveTo(i,o),t.lineTo(i+n-s,o),t.arc(i+n-s,o+s,s,-Math.PI/2,Math.PI/2,!1),t.lineTo(i,o+a),t.closePath()}}),bt=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new L.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},a={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,a)}}]),e}(wt);U(H,bt.prototype);var kt=bt,Ot=L.a.Path.extend({type:"card",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,a=e.height;t.moveTo(i+15,o),t.lineTo(i+n,o),t.lineTo(i+n,o+a),t.lineTo(i,o+a),t.lineTo(i,o+15),t.closePath()}}),At=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new L.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},a={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,a)}}]),e}(Ot);U(H,At.prototype);var Dt=At,Pt=L.a.Path.extend({type:"cylinder",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.height,a=e.width;t.moveTo(i,o+5),t.quadraticCurveTo(i+a/6,o,i+a/2,o),t.quadraticCurveTo(i+5*a/6,o,i+a,o+5),t.lineTo(i+a,o+n-5),t.quadraticCurveTo(i+5*a/6,o+n,i+a/2,o+n),t.quadraticCurveTo(i+a/6,o+n,i,o+n-5),t.closePath(),t.moveTo(i+a,o+5),t.quadraticCurveTo(i+5*a/6,o+10,i+a/2,o+10),t.quadraticCurveTo(i+a/6,o+10,i,o+5)}}),St=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"createAnchors",value:function(){var t=new L.a.Group;this.anchors=[];var e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},a={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,a)}}]),e}(Pt);U(H,St.prototype);var Tt=St,Ct=L.a.Path.extend({type:"prepare",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,a=e.height;t.moveTo(i+16,o),t.lineTo(i+n-16,o),t.lineTo(i+n,o+a/2),t.lineTo(i+n-16,o+a),t.lineTo(i+16,o+a),t.lineTo(i,o+a/2),t.closePath()}}),jt=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new L.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},a={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,a)}}]),e}(Ct);U(H,jt.prototype);var Et=jt,Nt=L.a.Path.extend({type:"loop",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,a=e.height;t.moveTo(i+16,o),t.lineTo(i+n-16,o),t.lineTo(i+n,o+16),t.lineTo(i+n,o+a),t.lineTo(i,o+a),t.lineTo(i,o+16),t.closePath()}}),zt=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new L.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},a={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,a)}}]),e}(Nt);U(H,zt.prototype);var Ft=zt,Gt=L.a.Path.extend({type:"perhaps",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,a=e.height,s=.5522848,r=i+n/2,h=o+a/2,c=n/2,l=a/2,d=c*s,u=l*s;t.moveTo(r-c,h),t.bezierCurveTo(r-c,h-u,r-d,h-l,r,h-l),t.bezierCurveTo(r+d,h-l,r+c,h-u,r+c,h),t.bezierCurveTo(r+c,h+u,r+d,h+l,r,h+l),t.bezierCurveTo(r-d,h+l,r-c,h+u,r-c,h),t.closePath(),t.moveTo(r,o),t.lineTo(r,o+a),t.moveTo(i,h),t.lineTo(i+n,h)}}),_t=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new L.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},a={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,a)}}]),e}(Gt);U(H,_t.prototype);var Bt=_t,It=L.a.Path.extend({type:"contrast",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,a=e.height;t.moveTo(i,o),t.lineTo(i+n,o),t.lineTo(i,o+a),t.lineTo(i+n,o+a),t.closePath()}}),Rt=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new L.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},a={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,a)}}]),e}(It);U(H,Rt.prototype);var Lt=Rt,$t=L.a.Path.extend({type:"sort",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,a=e.height;t.moveTo(i+n/2,o),t.lineTo(i+n,o+a/2),t.lineTo(i+n/2,o+a),t.lineTo(i,o+a/2),t.closePath(),t.moveTo(i,o+a/2),t.lineTo(i+n,o+a/2)}}),Mt=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new L.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},a={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,a)}}]),e}($t);U(H,Mt.prototype);var Wt=Mt,Ut=L.a.Path.extend({type:"display",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,a=e.height,s=a/2;t.moveTo(i+16,o),t.lineTo(i+n-s,o),t.arc(i+n-s,o+s,s,-Math.PI/2,Math.PI/2,!1),t.lineTo(i+16,o+a),t.lineTo(i,o+a/2),t.closePath()}}),Ht=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new L.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},a={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,a)}}]),e}(Ut);U(H,Ht.prototype);var qt=Ht,Jt=L.a.Path.extend({type:"store",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,a=e.height;t.moveTo(i,o),t.lineTo(i+n,o),t.lineTo(i+n,o+a),t.lineTo(i,o+a),t.closePath(),t.moveTo(i+10,o),t.lineTo(i+10,o+a),t.moveTo(i,o+10),t.lineTo(i+n,o+10)}}),Yt=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new L.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},a={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,a)}}]),e}(Jt);U(H,Yt.prototype);var Kt=Yt,Qt=L.a.Path.extend({type:"manualInput",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,a=e.height;t.moveTo(i,o+16),t.lineTo(i+n,o),t.lineTo(i+n,o+a),t.lineTo(i,o+a),t.closePath()}}),Xt=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new L.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},a={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,a)}}]),e}(Qt);U(H,Xt.prototype);var Vt=Xt,Zt=L.a.Path.extend({type:"paperBag",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,a=e.height;t.moveTo(i,o),t.quadraticCurveTo(i+n/4,o+10,i+n/2,o),t.quadraticCurveTo(i+3*n/4,o-10,i+n,o),t.lineTo(i+n,o+a),t.quadraticCurveTo(i+3*n/4,o+a-10,i+n/2,o+a),t.quadraticCurveTo(i+n/4,o+a+10,i,o+a),t.closePath()}}),te=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new L.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},a={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,a)}}]),e}(Zt);U(H,te.prototype);var ee=te,ie=L.a.Path.extend({type:"ordinaldata",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,a=e.height,s=.5522848,r=i+n/2,h=o+a/2,c=n/2,l=a/2,d=c*s,u=l*s;t.moveTo(r-c,h),t.bezierCurveTo(r-c,h-u,r-d,h-l,r,h-l),t.bezierCurveTo(r+d,h-l,r+c,h-u,r+c,h),t.bezierCurveTo(r+c,h+u,r+d,h+l,r,h+l),t.bezierCurveTo(r-d,h+l,r-c,h+u,r-c,h),t.closePath(),t.moveTo(r,o+a),t.lineTo(i+n,o+a)}}),oe=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new L.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},a={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,a)}}]),e}(ie);U(H,oe.prototype);var ne=oe,ae=L.a.Path.extend({type:"manualOperation",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,a=e.height;t.moveTo(i,o),t.lineTo(i+n,o),t.lineTo(i+n-16,o+a),t.lineTo(i+16,o+a),t.closePath()}}),se=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new L.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},a={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,a)}}]),e}(ae);U(H,se.prototype);var re=se,he=L.a.Path.extend({type:"directData",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,a=e.height,s=i+n;t.moveTo(i+5,o),t.lineTo(s-5,o),t.quadraticCurveTo(s,o+a/6,s,o+a/2),t.quadraticCurveTo(s,o+5*a/6,s-5,o+a),t.lineTo(i+5,o+a),t.quadraticCurveTo(i,o+5*a/6,i,o+a/2),t.quadraticCurveTo(i,o+a/6,i+5,o),t.closePath(),t.moveTo(s-5,o+a),t.quadraticCurveTo(i+n-10,o+5*a/6,s-10,o+a/2),t.quadraticCurveTo(i+n-10,o+a/6,s-5,o)}}),ce=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new L.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},a={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,a)}}]),e}(he);U(H,ce.prototype);var le=ce,de=L.a.Path.extend({type:"storeData",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,a=e.height;t.moveTo(i+5,o),t.lineTo(i+n-5,o),t.quadraticCurveTo(i+n-10,o+a/6,i+n-10,o+a/2),t.quadraticCurveTo(i+n-10,o+5*a/6,i+n-5,o+a),t.lineTo(i+5,o+a),t.quadraticCurveTo(i,o+5*a/6,i,o+a/2),t.quadraticCurveTo(i,o+a/6,i+5,o),t.closePath()}}),ue=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new L.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},a={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,a)}}]),e}(de);U(H,ue.prototype);var fe=ue,pe=L.a.Path.extend({type:"parallelModel",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,a=e.height;t.moveTo(i,o),t.lineTo(i+n,o),t.moveTo(i,o+a),t.lineTo(i+n,o+a)}}),ge=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new L.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/4,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width/2,y:e.y,index:2,node:this,direct:"top"},n={x:e.x+3*e.width/4,y:e.y,index:3,node:this,direct:"top"},a={x:e.x,y:e.y,index:4,node:this,direct:"top"},s={x:e.x+e.width,y:e.y,index:5,node:this,direct:"top"},r={x:e.x+e.width/4,y:e.y+e.height,index:6,node:this,direct:"bottom"},h={x:e.x+e.width/2,y:e.y+e.height,index:7,node:this,direct:"bottom"},c={x:e.x+3*e.width/4,y:e.y+e.height,index:8,node:this,direct:"bottom"},l={x:e.x,y:e.y+e.height,index:9,node:this,direct:"bottom"},d={x:e.x+e.width,y:e.y+e.height,index:10,node:this,direct:"bottom"};this.anchors.push(i,o,n,s,a,r,h,c,l,d)}}]),e}(pe);U(H,ge.prototype);var ye=ge,xe=L.a.Path.extend({type:"annotation",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,a=e.height;t.moveTo(i+n,o),t.lineTo(i,o),t.lineTo(i,o+a),t.lineTo(i+n,o+a)}}),ve=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new L.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/4,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width/2,y:e.y,index:2,node:this,direct:"top"},n={x:e.x+3*e.width/4,y:e.y,index:3,node:this,direct:"top"},a={x:e.x+e.width/4,y:e.y+e.height,index:4,node:this,direct:"bottom"},s={x:e.x+e.width/2,y:e.y+e.height,index:5,node:this,direct:"bottom"},r={x:e.x+3*e.width/4,y:e.y+e.height,index:6,node:this,direct:"bottom"},h={x:e.x,y:e.y+e.height/4,index:7,node:this,direct:"left"},c={x:e.x,y:e.y+e.height/2,index:8,node:this,direct:"left"},l={x:e.x,y:e.y+3*e.height/4,index:9,node:this,direct:"left"};this.anchors.push(i,o,n,a,s,r,h,c,l)}}]),e}(xe);U(H,ve.prototype);var me=ve,we=L.a.Path.extend({type:"induce",shape:{x:0,y:0,width:0,height:0,direct:"right"},buildPath:function(t,e){var i=e.x,o=e.y,n=e.width,a=e.height,s=e.direct;"right"==s?(t.moveTo(i,o+a/2),t.lineTo(i+n/2,o+a/2),t.moveTo(i+n,o),t.lineTo(i+n/2,o),t.lineTo(i+n/2,o+a),t.lineTo(i+n,o+a)):"left"==s?(t.moveTo(i,o),t.lineTo(i+n/2,o),t.lineTo(i+n/2,o+a),t.lineTo(i,o+a),t.moveTo(i+n/2,o+a/2),t.lineTo(i+n,o+a/2)):"top"==s?(t.moveTo(i,o),t.lineTo(i,o+a/2),t.lineTo(i+n,o+a/2),t.lineTo(i+n,o),t.moveTo(i+n/2,o+a/2),t.lineTo(i+n/2,o+a)):"bottom"==s&&(t.moveTo(i+n/2,o),t.lineTo(i+n/2,o+a/2),t.moveTo(i,o+a),t.lineTo(i,o+a/2),t.lineTo(i+n,o+a/2),t.lineTo(i+n,o+a))}}),be=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new L.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/4,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width/2,y:e.y,index:2,node:this,direct:"top"},n={x:e.x+3*e.width/4,y:e.y,index:3,node:this,direct:"top"},a={x:e.x+e.width/4,y:e.y+e.height,index:4,node:this,direct:"bottom"},s={x:e.x+e.width/2,y:e.y+e.height,index:5,node:this,direct:"bottom"},r={x:e.x+3*e.width/4,y:e.y+e.height,index:6,node:this,direct:"bottom"},h={x:e.x,y:e.y+e.height/4,index:7,node:this,direct:"left"},c={x:e.x,y:e.y+e.height/2,index:8,node:this,direct:"left"},l={x:e.x,y:e.y+3*e.height/4,index:9,node:this,direct:"left"};this.anchors.push(i,o,n,a,s,r,h,c,l)}}]),e}(we);U(H,be.prototype);var ke=be,Oe=L.a.Path.extend({type:"multidocument",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.width,o=e.height,n=e.x,a=e.y;De(t,n+8,a,i-8,o-22),De(t,n+4,a+4,i-8,o-22),Ae(t,n,a+8,i-8,o-8)}});function Ae(t,e,i,o,n){t.moveTo(e,i),t.lineTo(e+o,i),t.lineTo(e+o,i+n-14),t.quadraticCurveTo(e+o/4*3,parseInt(i+n-20),e+o/2,parseInt(i+n-14)),t.quadraticCurveTo(e+o/4,i+n,e,parseInt(i+n-7)),t.lineTo(e,i),t.closePath()}function De(t,e,i,o,n){t.moveTo(e,i),t.lineTo(e+o,i),t.lineTo(e+o,i+n),t.lineTo(e+o-4,i+n),t.lineTo(e+o-4,i+4),t.lineTo(e,i+4),t.closePath()}var Pe=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new L.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height-10,index:3,node:this,direct:"bottom"},a={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,a)}}]),e}(Oe);U(H,Pe.prototype);var Se=Pe,Te=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"createAnchors",value:function(){}}]),e}(L.a.Text);U(H,Te.prototype);var Ce=Te,je=L.a.Path.extend({type:"processBar",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,o=e.y,n=e.height,a=e.width;t.moveTo(i,o),t.lineTo(i+a-20,o),t.lineTo(i+a,o+n/2),t.lineTo(i+a-20,o+n),t.lineTo(i,o+n),t.lineTo(i+20,o+n/2),t.closePath()}}),Ee=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"createAnchors",value:function(){var t=new L.a.Group;this.anchors=[];var e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},a={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,a)}}]),e}(je);U(H,Ee.prototype);var Ne=Ee,ze=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,t)),i.data=t,i.oldfill=i.data.style.fill,i.anchors=[],i.nodeType="node",i.createAnchors(),i}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"createAnchors",value:function(){this.anchors=[];var t=new L.a.Group,e=t.getBoundingRect([this]),i={x:e.x+e.width/2,y:e.y,index:1,node:this,direct:"top"},o={x:e.x+e.width,y:e.y+e.height/2,index:2,node:this,direct:"right"},n={x:e.x+e.width/2,y:e.y+e.height,index:3,node:this,direct:"bottom"},a={x:e.x,y:e.y+e.height/2,index:4,node:this,direct:"left"};this.anchors.push(i,o,n,a)}}]),e}(L.a.Image);U(H,ze.prototype);var Fe=ze,Ge=L.a.Path.extend({type:"polyLine",shape:{points:[]},style:{fill:null},buildPath:function(t,e){var i=e.points;if(i&&i.length>=2){t.moveTo(i[0][0],i[0][1]);for(var o=1,n=i.length;o<n;o++)t.lineTo(i[o][0],i[o][1])}}}),_e=Ge,Be=function(){function t(e){Object(z["a"])(this,t),this.node=e,this.bars=[],this.create()}return Object(F["a"])(t,[{key:"create",value:function(){var t=this,e=this.node.getAnchors();e.forEach((function(e){var i=new L.a.Circle({style:{fill:"#fff",stroke:"rgb(0,181,237)",lineWidth:1},shape:{cx:e.x,cy:e.y,r:3},cursor:"crosshair",z:30001});i.point=e,i.mark="anch",i.node=t.node,e.anch=i,i.on("mouseover",(function(){i.oldfill=i.style.fill,i.setStyle("fill","rgb(0,181,237)"),t.node.time&&clearTimeout(t.node.time),t.show()})),i.on("mouseout",(function(){i.setStyle("fill",i.oldfill),t.hide()})),i.on("mousedown",(function(){i.setStyle("fill","rgb(0,181,237)")})),t.bars.push(i)}))}},{key:"getBarByIndex",value:function(t){return this.bars.filter((function(e){return e.point.index==t}))[0]}},{key:"show",value:function(){this.bars.forEach((function(t){t.show()}))}},{key:"hide",value:function(){this.bars.forEach((function(t){t.hide()}))}},{key:"refresh",value:function(){var t=this;this.bars.forEach((function(e){var i=t.node.getAnchorByIndex(e.point.index);e.attr({shape:{cx:i.x,cy:i.y}}),e.point=i}))}}]),t}(),Ie=Be;function Re(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,o)}return i}function Le(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Re(Object(i),!0).forEach((function(e){Object(N["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Re(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var $e={common:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"title",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"inside",fontSize:12,opacity:1},shape:{x:0,y:0,width:100,height:40,r:[3]},z:10,draggable:!0},rectangle:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"变电箱",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"inside",fontSize:12,opacity:1},shape:{x:0,y:0,width:100,height:80},z:200,draggable:!0},room:{style:{fill:"#fff",stroke:"#333",lineWidth:3,textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"inside",fontSize:12,opacity:1},shape:{x:0,y:0,width:600,height:600,r:[0]},z:100,draggable:!0},line:{style:{fill:"#fff",stroke:"#333",lineWidth:4,textFill:"#333",fontWeight:"normal",fontStyle:"",fontSize:12,opacity:1},shape:{x1:0,y1:0,x2:500,y2:500,smooth:.8},z:100,draggable:!1},polyLine:{style:{fill:"#fff",stroke:"#333",lineWidth:5,textFill:"#333",fontWeight:"normal",fontStyle:"",fontSize:12,opacity:1},point:[[20,20],[20,100],[100,100],[100,20],[20,20]],z:100,draggable:!1},cloud:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"title",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"inside",fontSize:12,textAlign:"left"},shape:{x:0,y:0,width:100,height:40},z:10,draggable:!0},diamond:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"title",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"inside",fontSize:12},shape:{x:0,y:0,width:100,height:60},z:10,draggable:!0},parallelogram:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"title",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"inside",fontSize:12},shape:{x:0,y:0,width:100,height:40},z:10,draggable:!0},circular:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"title",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"inside",fontSize:12},shape:{cx:0,cy:0,rx:40,ry:40},z:10,draggable:!0},arrowRight:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"title",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"inside",fontSize:12},shape:{x:0,y:0,width:100,height:50},z:10,draggable:!0},document:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"title",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"inside",fontSize:12,textOffset:[0,-4]},shape:{x:0,y:0,width:100,height:60},z:10,draggable:!0},cylinder:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"title",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"inside",fontSize:12},shape:{x:0,y:0,width:100,height:40},z:10,draggable:!0},loop:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"title",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"inside",fontSize:12},shape:{x:0,y:0,width:100,height:50},z:10,draggable:!0},perhaps:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"title",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"bottom",fontSize:12},shape:{x:0,y:0,width:30,height:30},z:10,draggable:!0},contrast:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"title",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"bottom",fontSize:12},shape:{x:0,y:0,width:40,height:30},z:10,draggable:!0},sort:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"title",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"bottom",fontSize:12},shape:{x:0,y:0,width:40,height:40},z:10,draggable:!0},ordinaldata:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"title",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"inside",fontSize:12},shape:{x:0,y:0,width:60,height:60},z:10,draggable:!0},parallelModel:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"inside",fontSize:12},shape:{x:0,y:0,width:100,height:30},z:10,draggable:!0},annotation:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"inside",fontSize:12,lineDash:[6,4]},shape:{x:0,y:0,width:60,height:100},z:10,draggable:!0},induce:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"inside",fontSize:12},shape:{x:0,y:0,width:60,height:100,direct:"right"},z:10,draggable:!0},multidocument:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"inside",fontSize:12},shape:{x:0,y:0,width:100,height:80},z:10,draggable:!0},store:{style:{fill:"#fff",stroke:"#333",lineWidth:1,text:"",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"inside",fontSize:12},shape:{x:0,y:0,width:60,height:60},z:10,draggable:!0},image:{style:{fill:"#fff",stroke:"#333",lineWidth:1,image:"",text:"",textFill:"#333",fontWeight:"normal",fontStyle:"",textPosition:"bottom",fontSize:12,x:0,y:0,width:60,height:60},draggable:!0}},Me={rectangle:J,room:J,line:K,polyLine:_e,circular:X,diamond:tt,parallelogram:ot,cloud:st,arrowRight:ct,roundRect:ft,preRect:yt,document:mt,delay:kt,card:Dt,cylinder:Tt,prepare:Et,loop:Ft,perhaps:Bt,contrast:Lt,sort:Wt,display:qt,store:Kt,manualInput:Vt,paperBag:ee,ordinaldata:ne,manualOperation:re,directData:le,storeData:fe,parallelModel:ye,annotation:me,induce:ke,multidocument:Se,text:Ce,processBar:Ne,image:Fe},We={addShape:function(t,e){Me[t]=e},removeShape:function(t){delete Me[t]},getShape:function(t,e,i){var o=L.a.util.clone($e[t]||$e.common);o.z=200,o.position=[e.x,e.y],o.command=t,e.image&&(o.style.image=e.image),e.style&&(o.style=Le({},o.style,{},L.a.util.clone(e.style),{},{transformText:!0})),e.shape&&(o.shape=Le({},o.shape,{},L.a.util.clone(e.shape))),void 0!==e.draggable&&(o.draggable=e.draggable),void 0!==e.direction&&(o.direction=e.direction),void 0!==e.kind&&(o.kind=e.kind),void 0!==e.scale&&(o.scale=e.scale),void 0!==e.safe&&(o.safe=e.safe),void 0!==e.face&&(o.face=e.face),void 0!==e.z&&(o.z=e.z);var n=new Me[t](o);if(n.getData=function(){var t={type:this.type,style:L.a.util.clone(this.style),z:this.oldz,command:this.data.command,id:this.data.id||this.id,position:this.position.slice(),draggable:!0};return"image"!=this.type&&(t.shape=L.a.util.clone(this.shape)),t},n.setData=function(t){this.data=Le({},this.data,{},L.a.util.clone(t)),this.attr(this.data),this.oldz=this.data.z},n.getId=function(){return this.data.id||this.id},n.getAnchByIndex=function(t){if(this.anch)return this.anch.getBarByIndex(t)},!i){var a=new Ie(n);n.anch=a,n.refresh=function(){this.refreshEdge()},n.setShadow=function(){this.attr({style:{shadowBlur:6,shadowColor:"#ccc"}})},n.cancelShadow=function(){this.attr({style:{shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0}})},n.on("mouseover",(function(){this.dragging||this.anch.show(),this.oldz=this.z,this.attr({z:2e4})})),n.on("mouseout",(function(){this.attr({z:this.oldz})})),n.on("click",(function(){this.__zr&&this.__zr.trigger("selectNode",{node:this})})),n.on("dragstart",(function(){this.oldPos=this.position.slice()})),n.on("drag",(function(){this.refreshEdge(),this.anch.hide(),this.__zr&&this.__zr.trigger("hideFrame")})),n.on("dragend",(function(){if(this.createAnchors(),this.anch.refresh(),this.__zr&&this.__zr.trigger("refreshSelectGroup"),this.nodeGroup)if(this.groupTimeout)clearTimeout(this.groupTimeout);else if(this.leaveGroup)return this.__zr.trigger("removeNodeFromGroup",{node:this}),void(this.leaveGroup=!1);this.addToNodeGroup||this.__zr&&this.__zr.trigger("moveNode",{node:this})})),n.on("dblclick",(function(){this.__zr&&this.__zr.trigger("edit",{status:"editNode",node:this,text:this.style.text})}))}return n},hasShape:function(t){return!!Me[t]}},Ue=function(){function t(e){Object(z["a"])(this,t),this.name=e}return Object(F["a"])(t,[{key:"execute",value:function(){}},{key:"undo",value:function(){}},{key:"redo",value:function(){this.execute()}}]),t}(),He=Ue;function qe(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,o)}return i}function Je(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?qe(Object(i),!0).forEach((function(e){Object(N["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):qe(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var Ye=function(t){function e(t,i){var o;return Object(z["a"])(this,e),o=Object(G["a"])(this,Object(_["a"])(e).call(this,"addShape")),o.nodes=t,o.editor=i,o}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"execute",value:function(){var t=this;this.nodes.forEach((function(e){t.editor.addNode(e)}))}},{key:"undo",value:function(){var t=this;this.nodes.forEach((function(e){t.editor.removeNode(e)}))}}]),e}(He),Ke=function(t){function e(t,i){var o;return Object(z["a"])(this,e),o=Object(G["a"])(this,Object(_["a"])(e).call(this,"RemoveShape")),o.nodes=t,o.editor=i,o.edges=o.getEdges(),o}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"getEdges",value:function(){var t=this,e=[];return this.nodes.forEach((function(i){var o=t.editor.getEdgesByNode(i);o.forEach((function(t){-1==e.indexOf(t)&&e.push(t)}))})),e}},{key:"execute",value:function(){var t=this;this.edges.forEach((function(e){t.editor.removeEdge(e)})),this.nodes.forEach((function(e){if(e.nodeGroup){var i=e.nodeGroup;e.oldRemoveGroup=i,i.removeNode(e),i.refresh()}t.editor.removeNode(e)})),this.editor.frame.hide()}},{key:"undo",value:function(){var t=this;this.edges.forEach((function(e){t.editor.addEdge(e),t.editor.add(e)})),this.nodes.forEach((function(e){t.editor.addNode(e),e.oldRemoveGroup&&(e.oldRemoveGroup.addNode(e),e.nodeGroup.refresh(),e.oldRemoveGroup=null)}))}}]),e}(He),Qe=function(t){function e(t,i,o){var n;return Object(z["a"])(this,e),n=Object(G["a"])(this,Object(_["a"])(e).call(this,"movePos")),n.item=t,n.oldPos=i.slice(),n.newPos=o.slice(),n.isExec=!0,n}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"execute",value:function(){this.isExec||(this.item.attr({position:this.newPos.slice()}),this.isExec=!0,this.item.refreshEdge())}},{key:"undo",value:function(){this.item.attr({position:this.oldPos.slice()}),this.isExec=!1,this.item.refreshEdge()}},{key:"refreshGroup",value:function(){"group"==this.item.nodeType&&this.item.refresh(),this.item.nodeGroup&&this.item.nodeGroup.refresh()}}]),e}(He),Xe=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,"manyCmd")),i.cmds=t,i}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"execute",value:function(){this.cmds.forEach((function(t){t.execute(),"movePos"==t.name&&(t.refreshEdge&&t.refreshEdge(),t.refreshGroup())}))}},{key:"undo",value:function(){this.cmds.forEach((function(t){t.undo(),"movePos"==t.name&&(t.refreshEdge&&t.refreshEdge(),t.refreshGroup())}))}}]),e}(He),Ve=function(t){function e(t,i){var o;return Object(z["a"])(this,e),o=Object(G["a"])(this,Object(_["a"])(e).call(this,"addedge")),o.edge=t,o.editor=i,o}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"execute",value:function(){this.editor.addEdge(this.edge)}},{key:"undo",value:function(){this.editor.removeEdge(this.edge)}}]),e}(He),Ze=function(t){function e(t,i){var o;return Object(z["a"])(this,e),o=Object(G["a"])(this,Object(_["a"])(e).call(this,"removeEdge")),o.edge=t,o.editor=i,o}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"execute",value:function(){this.editor.removeEdge(this.edge)}},{key:"undo",value:function(){this.editor.addEdge(this.edge)}}]),e}(He),ti=function(t){function e(t,i,o){var n;return Object(z["a"])(this,e),n=Object(G["a"])(this,Object(_["a"])(e).call(this,"createGroup")),n.group=t,n.topGroup=i,n.editor=o,n}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"execute",value:function(){var t=this;this.topGroup&&(this.topGroup.redoGroup(),this.editor.addGroup(this.topGroup),this.topGroup.addNode(this.group),this.group.nodes.forEach((function(e){var i=t.topGroup.nodes,o=i.indexOf(e);i.splice(o,1)}))),this.editor.addGroup(this.group),this.group.redoGroup()}},{key:"undo",value:function(){this.topGroup&&(this.topGroup.cancelGroup(),this.editor.removeGroup(this.topGroup)),this.group.cancelGroup(),this.editor.removeGroup(this.group)}}]),e}(He),ei=function(t){function e(t,i){var o;return Object(z["a"])(this,e),o=Object(G["a"])(this,Object(_["a"])(e).call(this,"cancelGroup")),o.group=t,o.editor=i,o.topGroup=t.topGroup,o.edges=i.getEdgesByGroup(t),o}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"execute",value:function(){var t=this;this.editor.removeGroup(this.group),this.topGroup&&this.topGroup.removeNode(this.group),this.group.nodes.forEach((function(e){t.topGroup?("group"==e.nodeType?e.topGroup=t.topGroup:e.nodeGroup=t.topGroup,t.topGroup.addNode(e)):"group"==e.nodeType?e.topGroup=null:e.nodeGroup=null})),this.edges.forEach((function(e){t.editor.removeEdge(e)}))}},{key:"undo",value:function(){var t=this;this.editor.addGroup(this.group),this.group.topGroup=this.topGroup,this.group.nodes.forEach((function(e){t.topGroup&&t.topGroup.removeNode(e),"group"==e.nodeType?e.topGroup=t.group:e.nodeGroup=t.group})),this.topGroup&&this.topGroup.addNode(this.group),this.edges.forEach((function(e){t.editor.addEdge(e)}))}}]),e}(He),ii=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,"removeNodeFromGroup")),i.node=t,i.group=i.node.nodeGroup,i.oldPos=i.node.oldPos.slice(),i.newPos=i.node.position.slice(),i}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"execute",value:function(){this.node.attr({position:[this.newPos[0],this.newPos[1]]}),this.group.removeNode(this.node),this.node.refreshEdge()}},{key:"undo",value:function(){this.node.attr({position:[this.oldPos[0],this.oldPos[1]]}),this.group.addNode(this.node),this.node.refreshEdge()}}]),e}(He),oi=function(t){function e(t,i){var o;return Object(z["a"])(this,e),o=Object(G["a"])(this,Object(_["a"])(e).call(this,"addNodeToGroup")),o.node=t,o.oldGroup=t.nodeGroup,o.newGroup=i,o.oldPos=t.oldPos.slice(),o.newPos=t.position.slice(),o}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"execute",value:function(){this.oldGroup&&(this.oldGroup.removeNode(this.node),this.node.groupTimeout&&(clearTimeout(this.node.groupTimeout),this.node.groupTimeout=null)),this.node.attr({position:this.newPos.slice()}),this.newGroup.addNode(this.node),this.node.refreshEdge()}},{key:"undo",value:function(){this.newGroup.removeNode(this.node),this.oldGroup&&(this.node.attr({position:this.oldPos.slice()}),this.oldGroup.addNode(this.node)),this.node.attr({position:this.oldPos.slice()}),this.node.refreshEdge()}}]),e}(He),ni=function(t){function e(t,i,o){var n;return Object(z["a"])(this,e),n=Object(G["a"])(this,Object(_["a"])(e).call(this,"changeNode")),n.node=t,n.oldData=i,n.newData=o,n}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"execute",value:function(){this.node.setData(this.newData),this.node.refresh()}},{key:"undo",value:function(){this.node.setData(this.oldData),this.node.refresh()}}]),e}(He),ai=function(t){function e(t,i,o,n){var a;return Object(z["a"])(this,e),a=Object(G["a"])(this,Object(_["a"])(e).call(this,"changeGroup")),a.group=t,a.oldData=i,a.newData=o,a.mark=n,a}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"execute",value:function(){"head"==this.mark?this.group.setHeadStyle(this.newData):this.group.setGroupStyle(this.newData)}},{key:"undo",value:function(){"head"==this.mark?this.group.setHeadStyle(this.oldData):this.group.setGroupStyle(this.oldData)}}]),e}(He),si=function(t){function e(t){var i;return Object(z["a"])(this,e),i=Object(G["a"])(this,Object(_["a"])(e).call(this,"removeGroup")),i.group=t,i.topGroup=i.group.topGroup,i.allItems=i.group.getAllItems(),i.editor=i.group.editor,i.edges=i.getAllEdges(),i}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"getAllEdges",value:function(){var t=this,e=this.editor.getAllEdgesByGroup(this.group);return this.allItems.forEach((function(i){if("node"==i.nodeType){var o=t.editor.getEdgesByNode(i);o.forEach((function(t){-1==e.indexOf(t)&&e.push(t)}))}})),e}},{key:"execute",value:function(){var t=this;this.group.editor.removeGroup(this.group),this.allItems.forEach((function(e){"node"==e.nodeType?t.editor.removeNode(e):"group"==e.nodeType&&t.editor.removeGroup(e)})),this.edges.forEach((function(e){t.editor.removeEdge(e)})),this.topGroup&&this.topGroup.removeNode(this.group)}},{key:"undo",value:function(){var t=this;this.editor.addGroup(this.group),this.allItems.forEach((function(e){"node"==e.nodeType?t.editor.addNode(e):"group"==e.nodeType&&t.editor.addGroup(e)})),this.edges.forEach((function(e){t.editor.addEdge(e),t.editor.add(e)})),this.group.refresh(),this.topGroup&&(this.topGroup.addNode(this.group),this.group.topGroup=this.topGroup)}}]),e}(He),ri=function(t){function e(t,i){var o;return Object(z["a"])(this,e),o=Object(G["a"])(this,Object(_["a"])(e).call(this,"changeGroupHead")),o.group=t,o.showHead=i,o}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"execute",value:function(){this.group.changeHead(this.showHead)}},{key:"undo",value:function(){this.group.changeHead(!this.showHead)}}]),e}(He),hi=function(t){function e(t,i,o){var n;return Object(z["a"])(this,e),n=Object(G["a"])(this,Object(_["a"])(e).call(this,"changeEdge")),n.edge=t,n.oldData=i,n.newData=o,n.edge.unactive(),n}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"execute",value:function(){this.edge.setData(this.newData)}},{key:"undo",value:function(){this.edge.setData(this.oldData)}}]),e}(He),ci=function(t){function e(t,i,o){var n;return Object(z["a"])(this,e),n=Object(G["a"])(this,Object(_["a"])(e).call(this,"changeEdgeText")),n.edge=t,n.oldText=i,n.newText=o,n}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"execute",value:function(){this.edge.setText(this.newText)}},{key:"undo",value:function(){this.edge.setText(this.oldText)}}]),e}(He),li=function(t){function e(t,i){var o;return Object(z["a"])(this,e),o=Object(G["a"])(this,Object(_["a"])(e).call(this,"changeEdge")),o.edge=t,o.data=i,o.edge.unactive(),o}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"execute",value:function(){"anch"==this.data.mark?"from"==this.data.position?(this.data.newCenter&&this.edge.setFromPoint(Je({},this.data.newCenter),!0),this.data.newNode&&(this.edge.setFromNode(this.data.newNode),this.edge.setFromAnch(this.data.newAnch))):(this.data.newCenter&&this.edge.setToPoint(Je({},this.data.newCenter),!0),this.data.newNode&&(this.edge.setToNode(this.data.newNode),this.edge.setToAnch(this.data.newAnch))):"point"==this.data.mark&&("from"==this.data.position?(this.edge.setFromPoint({x:this.data.newCenter.x,y:this.data.newCenter.y},!0),this.data.newNode&&(this.edge.setFromNode(this.data.newNode),this.edge.setFromAnch(this.data.newAnch))):(this.edge.setToPoint({x:this.data.newCenter.x,y:this.data.newCenter.y}),this.data.newNode&&(this.edge.setToNode(this.data.newNode),this.edge.setToAnch(this.data.newAnch))))}},{key:"undo",value:function(){"anch"==this.data.mark?"from"==this.data.position?(this.data.oldCenter&&this.edge.setFromPoint(Je({},this.data.oldCenter),!0),this.data.oldNode&&(this.edge.setFromNode(this.data.oldNode),this.edge.setFromAnch(this.data.oldAnch))):(this.data.oldCenter&&this.edge.setToPoint(Je({},this.data.oldCenter),!0),this.data.oldNode&&(this.edge.setToNode(this.data.oldNode),this.edge.setToAnch(this.data.oldAnch))):"point"==this.data.mark&&("from"==this.data.position?(this.edge.setFromPoint({x:this.data.oldCenter.x,y:this.data.oldCenter.y},!0),this.data.newNode&&this.edge.removeFromNode()):(this.edge.setToPoint({x:this.data.oldCenter.x,y:this.data.oldCenter.y}),this.data.newNode&&this.edge.removeToNode()))}}]),e}(He),di=function(){function t(e){Object(z["a"])(this,t),this.editor=e,this.w=6,this.isShow=!0,this.createBar(),this.initEvent(),this.hide()}return Object(F["a"])(t,[{key:"addTo",value:function(t){this.zr=t,t.add(this.lefttopbar),t.add(this.leftbottombar),t.add(this.righttopbar),t.add(this.rightbottombar),t.add(this.frame)}},{key:"createBar",value:function(){var t=this.w;this.frame=new L.a.Rect({style:{fill:"transparent"}}),this.lefttopbar=new L.a.Rect({style:{fill:"#fff",stroke:"red",lineWidth:1},shape:{width:t,height:t},draggable:!0,cursor:"nw-resize",z:30001}),this.righttopbar=new L.a.Rect({style:{fill:"#fff",stroke:"red",lineWidth:1},shape:{width:t,height:t},draggable:!0,cursor:"ne-resize",z:30001}),this.leftbottombar=new L.a.Rect({style:{fill:"#fff",stroke:"red",lineWidth:1},shape:{width:t,height:t},draggable:!0,cursor:"sw-resize",z:30001}),this.rightbottombar=new L.a.Rect({style:{fill:"#fff",stroke:"red",lineWidth:1},shape:{width:t,height:t},draggable:!0,cursor:"se-resize",z:30001}),this.hide()}},{key:"hide",value:function(){this.isShow&&(this.lefttopbar.hide(),this.leftbottombar.hide(),this.righttopbar.hide(),this.rightbottombar.hide(),this.frame.hide(),this.isShow=!1)}},{key:"show",value:function(){this.isShow||(this.lefttopbar.show(),this.leftbottombar.show(),this.righttopbar.show(),this.rightbottombar.show(),this.frame.show(),this.isShow=!0)}},{key:"boxSelect",value:function(t,e){this.boxItem=e,t.x=parseInt(t.x)+.5,t.y=parseInt(t.y)+.5,t.width=t.width-1,t.height=t.height-1,this.box=t,this.frame.attr({position:[t.x,t.y],style:{stroke:"red",lineWidth:1},shape:{x:0,y:0,width:t.width,height:t.height}}),this.show()}},{key:"refreshBar",value:function(){var t=this.w;this.lefttopbar.attr({position:[this.box.x,this.box.y],shape:{x:-t/2,y:-t/2}}),this.righttopbar.attr({position:[this.box.x+this.box.width,this.box.y],shape:{x:-t/2,y:-t/2}}),this.leftbottombar.attr({position:[this.box.x,this.box.y+this.box.height],shape:{x:-t/2,y:-t/2}}),this.rightbottombar.attr({position:[this.box.x+this.box.width,this.box.y+this.box.height],shape:{x:-t/2,y:-t/2}})}},{key:"refreshGroup",value:function(){var t=this.box,e=this.boxItem.position.slice();if("ellipse"==this.boxItem.type){var i=t.width/2,o=t.height/2,n=t.x+i,a=t.y+o;this.boxItem.attr({shape:{cx:n-e[0],cy:a-e[1],rx:i,ry:o}})}else"image"==this.boxItem.type?this.boxItem.attr({position:[t.x,t.y],style:{width:t.width,height:t.height}}):this.boxItem.attr({position:[t.x,t.y],shape:{x:0,y:0,width:t.width,height:t.height}})}},{key:"initEvent",value:function(){var t,e,i,o,n,a,s,r=this,h=this,c=!1,l=[this.lefttopbar,this.leftbottombar,this.righttopbar,this.rightbottombar];l.forEach((function(r,l){r.on("dragstart",(function(r){o=h.box.x,n=h.box.y,a=h.box.width,s=h.box.height,c=!0,t=r.offsetX,e=r.offsetY,i=h.boxItem.getData(),h.editor.status="resizeNode"})),r.on("drag",(function(i){if(c){var r=i.offsetX-t,d=i.offsetY-e;0==l?(h.box.x=o+r,h.box.y=n+d,h.box.width=a-r,h.box.height=s-d):1==l?(h.box.x=o+r,h.box.y=n,h.box.width=a-r,h.box.height=s+d):2==l?(h.box.x=o,h.box.y=n+d,h.box.width=a+r,h.box.height=s-d):(h.box.x=o,h.box.y=n,h.box.width=a+r,h.box.height=s+d),h.refreshGroup(),h.boxSelect(h.box,h.boxItem),h.refreshBar(),h.boxItem.refreshEdge(),h.boxItem.nodeGroup&&h.boxItem.nodeGroup.refresh()}})),r.on("dragend",(function(){this.__zr&&this.__zr.trigger("resizeNode",{oldData:i}),c=!1,h.editor.status=""}))})),document.addEventListener("mouseup",(function(){c&&(c=!1,r.editor.status="")}))}}]),t}(),ui=di,fi=i("3835"),pi=(i("7db0"),function(t,e){return[t[0]+e[0],t[1]+e[1]]}),gi=function(t,e){return[t[0]*e,t[1]*e]},yi=function(t,e){return[e[0]-t[0],e[1]-t[1]]},xi=function(t,e){return t[0]*e[1]-t[1]*e[0]===0},vi=function(t,e){return t[0]*e[0]+t[1]*e[1]},mi=function(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]);return[t[0]/e,t[1]/e]};function wi(t){var e=t.entryPoint,i=void 0===e?[0,0]:e,o=t.entryDirection,n=void 0===o?[0,1]:o,a=t.entryExt,s=void 0===a?10:a,r=t.exitPoint,h=void 0===r?[10,10]:r,c=t.exitDirection,l=void 0===c?[1,0]:c,d=t.exitExt,u=void 0===d?10:d,f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;if(null===l||"0,0"==l.join()){var p=yi(h,i);l=Math.abs(p[0])>Math.abs(p[1])?[p[0]/Math.abs(p[0]),0]:[0,p[1]/Math.abs(p[1])]}var g=pi(i,gi(n,s)),y=pi(h,gi(l,u));l=gi(l,-1);var x,v,m=[y[0]-g[0],0],w=[0,y[1]-g[1]],b=[m,w],k=b.find((function(t){return xi(t,n)}));x=vi(k,n)>0?k:bi(b,k);var O=b.find((function(t){return xi(t,l)}));v=vi(O,l)>0?O:bi(b,O);var A=vi(x,v)>0?2:1,D=bi(b,v),P=[];if(P.push({position:i,direction:null},{position:g,direction:n}),1==A){var S=pi(g,x),T=ki(x),C=pi(S,v),j=ki(v);P.push({position:S,direction:T},{position:C,direction:j})}else{var E=pi(g,gi(x,f)),N=ki(x),z=pi(E,D),F=ki(D),G=pi(z,gi(v,1-f)),_=ki(v);P.push({position:E,direction:N},{position:z,direction:F,type:"pathMiddleP"},{position:G,direction:_})}return P.push({position:h,direction:l}),P.filter((function(t){return!1!==t.direction}))}function bi(t,e){return t.find((function(t){return t!=e}))}function ki(t){return(0!=t[0]||0!=t[1])&&(0==t[0]?[0,t[1]/Math.abs(t[1])]:0==t[1]?[t[0]/Math.abs(t[0]),0]:mi(t))}var Oi=wi;function Ai(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,o)}return i}function Di(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Ai(Object(i),!0).forEach((function(e){Object(N["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Ai(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var Pi=function(t){function e(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#666",s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"#666",r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"#fff",h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"polyline",c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"solid";return Object(z["a"])(this,e),t=Object(G["a"])(this,Object(_["a"])(e).call(this)),t.fromNode=i,t.toNode=o,t.direct="",t.stroke=a,t.textFill=s||"#fff",t.lineDashType=c,t.textBackgroundColor=r,t.fontStyle="normal",t.fontWeight="normal",t.lineCenter=[],t.status="create",t.cpx={cpx1:0,cpy1:0,cpx2:0,cpy2:0,fromcx:0,fromcy:0,tocx:0,tocy:0},t.entryDirection=[1,0],t.exitDirection=[-1,0],t.entryExt=20,t.exitExt=20,t.text=n,t.lineWidth=1,t.type=h,t.temx=0,t.temy=0,t.nodeType="edge",t.create(),t.initEvent(),t.relateText.hide(),t}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"setLineDashType",value:function(){"solid"==this.lineDashType?this.lineDash=[0]:"dott"==this.lineDashType?this.lineDash=[2,2]:"dash"==this.lineDashType?this.lineDash=[6,3]:"dashed"==this.lineDashType&&(this.lineDash=[10,4,4,4])}},{key:"create",value:function(){var t=this;this.setLineDashType(),"bs"==this.type?this.bs=new L.a.BezierCurve({style:{stroke:this.stroke,lineWidth:this.lineWidth,lineDash:this.lineDash},z:16}):"polyline"==this.type?this.bs=new L.a.Polyline({style:{stroke:this.stroke,lineWidth:this.lineWidth,lineDash:this.lineDash},z:16}):this.bs=new L.a.Line({style:{stroke:this.stroke,lineWidth:this.lineWidth,lineDash:this.lineDash},z:16}),this.cpx1=new L.a.Circle({style:{stroke:"#666",fill:"#fff"},shape:{r:4},draggable:!0,z:2e4}),this.cpx2=new L.a.Circle({style:{stroke:"#666",fill:"#fff"},shape:{r:4},draggable:!0,z:2e4}),this.fromPointCircle=new L.a.Circle({style:{fill:"#fff",stroke:"red",shadowColor:"yellow",shadowBlur:3},shape:{r:4},z:1e4}),this.toPointCircle=new L.a.Circle({style:{fill:"#fff",stroke:"red",shadowColor:"yellow",shadowBlur:3},shape:{r:4},z:1e4}),this.fromPointCircle.edge=this,this.fromPointCircle.edgeType="from",this.toPointCircle.edge=this,this.toPointCircle.edgeType="to",this.line1=new L.a.Line({style:{stroke:"#ccc"},z:1e4}),this.line2=new L.a.Line({style:{stroke:"#ccc"},z:1e4}),this.pl=new L.a.Polygon({style:{stroke:this.stroke,fill:this.stroke},z:17}),this.relateText=new L.a.Text({style:{text:this.text,textFill:this.textFill,fontSize:12,fontStyle:this.fontSize,fontWeight:this.fontWeight,textBackgroundColor:this.textBackgroundColor,textPadding:[2,2],textBorderRadius:2},z:17}).on("dblclick",(function(e){e.relate=t,t.__zr.trigger("editRelate",e)})),this.add(this.bs),this.add(this.line1),this.add(this.line2),this.add(this.cpx1),this.add(this.cpx2),this.add(this.fromPointCircle),this.add(this.toPointCircle),this.add(this.pl),this.add(this.relateText),this.cpx1.relate=this,this.cpx1.mark="from",this.cpx2.relate=this,this.cpx2.mark="to",this.cpx1.hide(),this.cpx2.hide(),this.line1.hide(),this.line2.hide(),this.fromPointCircle.hide(),this.toPointCircle.hide(),this.pl.hide()}},{key:"setFromNode",value:function(t){this.fromNode=t}},{key:"setFromAnch",value:function(t){this.fromAnch=t,t&&(this.setFromPoint(this.fromNode.getAnchorByIndex(t.point.index)),this._refresh())}},{key:"removeFromNode",value:function(){this.fromNode=null,this.fromAnch=null}},{key:"setFromPoint",value:function(t,e){this.fromPoint=Di({},this.fromPoint,{},t),this.cpx.x1=t.x,this.cpx.y1=t.y,this.calcDirection(),e&&(this._refresh(),this.renderText())}},{key:"calc",value:function(t,e){var i,o=this.fromPoint;t&&e?(this.toPoint={x:t,y:e},i=this.toPoint):i=this.toPoint;var n=o.x+(i.x-o.x)/4,a=o.y+(i.y-o.y)/4,s=o.x+(i.x-o.x)/4*3,r=o.y+(i.y-o.y)/4*3;return{x1:o.x,y1:o.y,x2:i.x,y2:i.y,cpx1:n,cpx2:s,cpy1:a,cpy2:r}}},{key:"judgeDirect",value:function(t,e){var i="";return i=t.x>=e.x?"left":"right",t.y>=e.y?i+="top":i+="bottom",i}},{key:"calcDirection",value:function(){this.fromPoint&&this.fromPoint.direct&&("top"==this.fromPoint.direct?this.entryDirection=[0,-1]:"right"==this.fromPoint.direct?this.entryDirection=[1,0]:"bottom"==this.fromPoint.direct?this.entryDirection=[0,1]:this.entryDirection=[-1,0]),this.toPoint&&this.toPoint.direct&&("top"==this.toPoint.direct?this.exitDirection=[0,-1]:"right"==this.toPoint.direct?this.exitDirection=[1,0]:"bottom"==this.toPoint.direct?this.exitDirection=[0,1]:this.exitDirection=[-1,0])}},{key:"polylineConnection",value:function(t,e){t&&e&&(this.toPoint={x:t,y:e}),this.calcDirection();var i={entryPoint:[this.fromPoint.x,this.fromPoint.y],exitPoint:[this.toPoint.x,this.toPoint.y],entryDirection:this.entryDirection,exitDirection:this.exitDirection,entryExt:this.entryExt,exitExt:this.exitExt};if("number"==typeof i.entryPoint[0]&&"number"==typeof i.entryPoint[0]&&"number"==typeof i.exitPoint[0]&&"number"==typeof i.exitPoint[0]){var o=Oi(i),n=[];o.forEach((function(t){n.push(t.position)})),this.cpx.cpx1=n[1][0],this.cpx.cpy1=n[1][1],this.cpx.cpx2=n[n.length-2][0],this.cpx.cpy2=n[n.length-2][1];var a=o.length,s=parseInt(a/2)-1;this.lineCenter=[(n[s][0]+n[s+1][0])/2,(n[s][1]+n[s+1][1])/2],this.lineWidth%2==1?n.forEach((function(t){t[0]=parseInt(t[0])+.5,t[1]=parseInt(t[1])+.5})):n.forEach((function(t){t[0]=parseInt(t[0]),t[1]=parseInt(t[1])})),this.cpx.points=L.a.util.clone(n),this.cpx.lineCenter=this.lineCenter.slice(),this.bs.attr({shape:{points:n}}),this.renderText()}}},{key:"move",value:function(t,e){if("left"==this.fromPoint.direct||"right"==this.fromPoint.direct?t>this.fromPoint.x||t>this.temx?this.exitDirection=[-1,0]:(t<this.fromPoint.x||t<this.temx)&&(this.exitDirection=[1,0]):e>this.fromPoint.y||e>this.temy?this.exitDirection=[0,-1]:(e<this.fromPoint.y||t<this.temy)&&(this.exitDirection=[0,1]),this.temx=t,this.temy=e,"polyline"==this.type)this.polylineConnection(t,e);else{var i=this.calc(t,e);this.bs.attr({shape:i}),this._refresh()}}},{key:"calcPoints",value:function(t){if(t){var e;e="line"==this.type?Math.atan((t.x1-t.x2)/(t.y1-t.y2)):Math.atan((t.cpx2-t.x2)/(t.cpy2-t.y2));var i=8,o=3,n=[],a=[],s=[];"line"==this.type?t.y1>=t.y2?(a[0]=i*Math.sin(e)- -o*Math.cos(e)+t.x2,a[1]=i*Math.cos(e)+-o*Math.sin(e)+t.y2,s[0]=i*Math.sin(e)-o*Math.cos(e)+t.x2,s[1]=i*Math.cos(e)+o*Math.sin(e)+t.y2):(a[0]=-i*Math.sin(e)- -o*Math.cos(e)+t.x2,a[1]=-i*Math.cos(e)+-o*Math.sin(e)+t.y2,s[0]=-i*Math.sin(e)-o*Math.cos(e)+t.x2,s[1]=-i*Math.cos(e)+o*Math.sin(e)+t.y2):t.cpy2>=t.y2?(a[0]=i*Math.sin(e)- -o*Math.cos(e)+t.x2,a[1]=i*Math.cos(e)+-o*Math.sin(e)+t.y2,s[0]=i*Math.sin(e)-o*Math.cos(e)+t.x2,s[1]=i*Math.cos(e)+o*Math.sin(e)+t.y2):(a[0]=-i*Math.sin(e)- -o*Math.cos(e)+t.x2,a[1]=-i*Math.cos(e)+-o*Math.sin(e)+t.y2,s[0]=-i*Math.sin(e)-o*Math.cos(e)+t.x2,s[1]=-i*Math.cos(e)+o*Math.sin(e)+t.y2);var r=[t.x2,t.y2];return n.push(a,s,r),n}}},{key:"setToNode",value:function(t){this.toNode=t}},{key:"setToAnch",value:function(t){this.toAnch=t,t&&(this.setToPoint(this.toNode.getAnchorByIndex(t.point.index)),this._refresh())}},{key:"removeToNode",value:function(){this.toNode=null,this.toAnch=null}},{key:"setToPoint",value:function(t){this.toPoint=Di({},this.toPoint,{},t),this.cpx.x2=t.x,this.cpx.y2=t.y,this.calcDirection(),this._refresh(),this.renderText()}},{key:"active",value:function(){if(this.status="active",this.bs.setStyle("stroke","orange"),this.fromPointCircle.attr({shape:{cx:this.cpx.x1,cy:this.cpx.y1}}),this.toPointCircle.attr({shape:{cx:this.cpx.x2,cy:this.cpx.y2}}),this.fromPointCircle.show(),this.toPointCircle.show(),"bs"==this.type){var t=this.cpx;this.cpx1.attr({position:[t.cpx1,t.cpy1]}),this.cpx2.attr({position:[t.cpx2,t.cpy2]}),this.cpx1.show(),this.cpx2.show(),this.line1.show(),this.line2.show()}}},{key:"unactive",value:function(){this.status="over",this.bs.setStyle("stroke",this.stroke),this.cpx1.hide(),this.cpx2.hide(),this.line1.hide(),this.line2.hide(),this.fromPointCircle.hide(),this.toPointCircle.hide()}},{key:"isactive",value:function(){return"active"==this.status}},{key:"setTextBackground",value:function(t){this.textBackgroundColor=t,this.relateText.attr({style:{textBackgroundColor:t}})}},{key:"flush",value:function(){this._refresh()}},{key:"refresh",value:function(){this._refresh()}},{key:"doRefresh",value:function(){this._refresh()}},{key:"showCircle",value:function(){this.fromPointCircle.show(),this.toPointCircle.show()}},{key:"initEvent",value:function(){var t=this;this.bs.on("click",(function(){t.active(),t.__zr&&t.__zr.trigger("clearSelectNode"),t.__zr&&t.__zr.trigger("selectEdge",{edge:t})})),this.bs.on("dblclick",(function(e){e.edge=t,e.status="editEdge",e.text=t.relateText.style.text,t.__zr&&t.__zr.trigger("edit",e)})),this.bs.on("contextmenu",(function(e){t.active(),t.__zr&&t.__zr.trigger("showRelateLinkMenu",e)})),this.fromPointCircle.on("mousedown",(function(){t.fromPointCircle.oldCenter={x:t.fromPointCircle.shape.cx,y:t.fromPointCircle.shape.cy}})),this.toPointCircle.on("mousedown",(function(){t.toPointCircle.oldCenter={x:t.toPointCircle.shape.cx,y:t.toPointCircle.shape.cy}})),this.cpx1.on("drag",(function(){var e=t.cpx1.position.slice();t.cpx.cpx1=e[0],t.cpx.cpy1=e[1],t._refresh()})),this.cpx2.on("drag",(function(){var e=t.cpx2.position.slice();t.cpx.cpx2=e[0],t.cpx.cpy2=e[1],t._refresh()}))}},{key:"setCpx1",value:function(t,e,i,o){this.cpx.cpx1=t,this.cpx.cpy1=e,this.setx1(t,e,i,o),this._refresh()}},{key:"setCpx2",value:function(t,e,i,o){this.cpx.cpx2=t,this.cpx.cpy2=e,this.setx2(t,e,i,o),this._refresh()}},{key:"_refresh",value:function(){var t;this.setLineDashType();var e=this.cpx;"bs"==this.type||"line"==this.type?this.bs.attr({shape:e}):(this.fromPoint=Di({},this.fromPoint,{},{x:this.cpx.x1,y:this.cpx.y1}),this.toPoint=Di({},this.toPoint,{},{x:this.cpx.x2,y:this.cpx.y2}),this.polylineConnection()),this.line1.attr({shape:{x1:e.x1,y1:e.y1,x2:e.cpx1,y2:e.cpy1}}),this.line2.attr({shape:{x1:e.x2,y1:e.y2,x2:e.cpx2,y2:e.cpy2}}),t=this.calcPoints(e),this.pl.attr({shape:{points:t}}),this.pl.show(),this.renderText()}},{key:"setx1",value:function(t,e){var i=this.fromNode.getPosition(),o=this.fromNode.getBoundingRect();t>=i.x-2&&t<=i.x+o.width+2?(this.cpx.x1=t,this.cpx.fromcx=t-i.x):(t<i.x-2||t>i.x+o.width+2)&&e>i.y-2&&e<i.y+o.height+2&&(this.cpx.y1=e,this.cpx.fromcy=e-i.y)}},{key:"setx2",value:function(t,e){var i=this.toNode.getPosition(),o=this.toNode.getBoundingRect();t>i.x-2&&t<i.x+o.width+2?(this.cpx.x2=t,this.cpx.tocx=t-i.x):(t<i.x-2||t>i.x+o.width+2)&&e>i.y-2&&e<i.y+o.height+2&&(this.cpx.y2=e,this.cpx.tocy=e-i.y)}},{key:"getCpx",value:function(){return{cpx1:this.cpx.cpx1,cpx2:this.cpx.cpx2,cpy1:this.cpx.cpy1,cpy2:this.cpx.cpy2,x1:this.cpx.x1,y1:this.cpx.y1,x2:this.cpx.x2,y2:this.cpx.y2,points:L.a.util.clone(this.cpx.points),lineCenter:this.lineCenter.slice(),type:this.type}}},{key:"setCpx",value:function(t){if(this.cpx=L.a.util.clone(t),"polyline"==t.type){this.cpx=t,this.lineCenter=this.cpx.lineCenter.slice(),this.bs.attr({shape:{points:t.points}});var e=this.calcPoints(t);this.pl.attr({shape:{points:e}}),this.renderText()}else this._refresh()}},{key:"setPosition",value:function(t,e){this.attr({position:[t,e]})}},{key:"renderText",value:function(){var t,e=this.cpx,i=[e.x1,e.y1],o=[e.cpx1,e.cpy1],n=[e.cpx2,e.cpy2],a=[e.x2,e.y2];t="bs"==this.type?this.threeBezier(.5,i,o,n,a):"polyline"==this.type?this.lineCenter:[(i[0]+a[0])/2,(i[1]+a[1])/2];var s=this.relateText.getBoundingRect(),r=t[0]-s.width/2,h=t[1]-s.height/2;this.relateText.attr({style:{textBackgroundColor:this.textBackgroundColor},position:[r,h]}),this.text?this.relateText.show():this.relateText.hide()}},{key:"setText",value:function(t){this.text=t,this.relateText.setStyle("text",this.text),this.renderText()}},{key:"getText",value:function(){return this.text||this.relateText.style.text}},{key:"setColor",value:function(t){this.stroke=t,this.bs.attr({style:{stroke:t}}),this.pl.attr({style:{stroke:t}})}},{key:"oneBezier",value:function(t,e,i){var o=Object(fi["a"])(e,2),n=o[0],a=o[1],s=Object(fi["a"])(i,2),r=s[0],h=s[1],c=n+(r-n)*t,l=a+(h-a)*t;return[c,l]}},{key:"twoBezier",value:function(t,e,i,o){var n=Object(fi["a"])(e,2),a=n[0],s=n[1],r=Object(fi["a"])(i,2),h=r[0],c=r[1],l=Object(fi["a"])(o,2),d=l[0],u=l[1],f=(1-t)*(1-t)*a+2*t*(1-t)*h+t*t*d,p=(1-t)*(1-t)*s+2*t*(1-t)*c+t*t*u;return[f,p]}},{key:"threeBezier",value:function(t,e,i,o,n){var a=Object(fi["a"])(e,2),s=a[0],r=a[1],h=Object(fi["a"])(n,2),c=h[0],l=h[1],d=Object(fi["a"])(i,2),u=d[0],f=d[1],p=Object(fi["a"])(o,2),g=p[0],y=p[1],x=s*(1-t)*(1-t)*(1-t)+3*u*t*(1-t)*(1-t)+3*g*t*t*(1-t)+c*t*t*t,v=r*(1-t)*(1-t)*(1-t)+3*f*t*(1-t)*(1-t)+3*y*t*t*(1-t)+l*t*t*t;return[x,v]}},{key:"getTextPosition",value:function(){var t=this.position.slice(),e=this.relateText.position.slice();return{x:t[0]+e[0],y:t[1]+e[1]}}},{key:"getTextBox",value:function(){return this.relateText.getBoundingRect()}},{key:"setAttr",value:function(t){this.bs.attr({style:{stroke:t}}),this.pl.attr({style:{stroke:t,fill:this.stroke}}),this.relateText.attr({style:{text:this.text,textFill:this.textFill,fontSize:this.fontSize,fontStyle:this.fontStyle,fontWeight:this.fontWeight,textBackgroundColor:this.textBackgroundColor}})}},{key:"setData",value:function(t){this.id=t["id"],this.text=t["text"],this.stroke=t["stroke"],this.textFill=t["textFill"],this.type=t["type"],this.textBackgroundColor=t["fill"],this.lineDashType=t["lineDashType"]||this.lineDashType,this.lineWidth=t["lineWidth"]||1,this.fontSize=t["fontSize"]||12,this.fontStyle=t["fontStyle"]||"normal",this.fontWeight=t["fontWeight"],this.entryExt=t["ext"],this.exitExt=t["ext"],this.entryDirection=t["entryDirection"],this.exitDirection=t["exitDirection"],t["position"]&&this.setPosition(t["position"][0],t["position"][1]),this.cpx=t["cpx"]||this.getCpx(),this.lineCenter=t["lineCenter"],this.setLineDashType(),this.setAttr(this.stroke,this.textFill,this.textBackgroundColor),this.setText(this.text),this.changeType(this.type),"bs"==this.type&&this.setCpx(t.cpx),this.text?this.relateText.show():this.relateText.hide()}},{key:"getData",value:function(){var t=this.getCpx();return Di({},{id:this.id||this.bs.id,fromNode:this.fromNode&&this.fromNode.getId()||"",endNode:this.toNode&&this.toNode.getId()||"",fromAnch:this.fromAnch&&this.fromAnch.point.index||"",toAnch:this.toAnch&&this.toAnch.point.index||"",text:this.text,stroke:this.stroke,textFill:this.textFill,lineWidth:this.lineWidth,lineDashType:this.lineDashType,fontSize:this.fontSize,fontStyle:this.fontStyle,fontWeight:this.fontWeight,type:this.type,ext:this.entryExt,lineDash:this.lineDash.slice(),fill:this.textBackgroundColor,lineCenter:this.lineCenter.slice(),entryDirection:this.entryDirection.slice(),entryExt:this.entryExt,exitDirection:this.exitDirection.slice(),exitExt:this.exitExt,cpx:t,position:this.position.slice()})}},{key:"changeType",value:function(t){this.type=t||this.type,this.remove(this.bs),this.bs="bs"==t?new L.a.BezierCurve({style:{stroke:this.stroke,lineWidth:this.lineWidth||1,lineDash:this.lineDash},z:16}):"polyline"==t?new L.a.Polyline({style:{stroke:this.stroke,lineWidth:this.lineWidth||1,lineDash:this.lineDash},z:16}):new L.a.Line({style:{stroke:this.stroke,lineWidth:this.lineWidth||1,lineDash:this.lineDash},z:16}),this.add(this.bs),this.initEvent(),this._refresh()}}]),e}(L.a.Group);function Si(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,o)}return i}function Ti(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Si(Object(i),!0).forEach((function(e){Object(N["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Si(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var Ci=function(t){function e(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"新建分组",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#fafafa",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#ccc",s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"#333",r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"dash",h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return Object(z["a"])(this,e),t=Object(G["a"])(this,Object(_["a"])(e).call(this)),t.nodes=i,t.groupText=o,t.stroke=a,t.fill=n,t.textFill=s,t.strokeType=r,t.headFill="",t.locked=!1,t.lockImage={lockImage:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABEklEQVQ4T2NkoBAwYtOvKCkgz/iftZfhP4MEWJ6R4cV/xt/F959/eIiuHsMAJUFBfgY25tP/GBlSH7x4cxCkQU5CSIuFgWnGvx9//B58+PAB2RBMAyREGv/9/Xf8wet3O5AVKkiIODAyMDjdf/GmDr8B4iKb7718E8TAwPAbzbmsSuIi6++9fONDyIDd916+ccUWNkriIhhycC/IifErMTGxyjH9Y+j5x8RQgs0AmNy/f78fPXr18R4kfKFAWUKk6/9/Br5///+LMTExXsJmwL9///WYGBlfMTIyfLr74k0ZhgF//jIuf/j69Xl8SUNeVNSQhfl/5KgBtAoDBgYGJwYGhi8EMigPAwPDPoxYIDdXAwB8nKARpjp7NAAAAABJRU5ErkJggg==",unLockImage:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA00lEQVQ4T93TIUuDURSA4WdJmC4blvQ/iHmiYYYV2/6FMEw2MSwOhIFhdTBYmFXDksExFlzSosXmTxDkwhe+Xa67sDVPPuc9977nnIoto/JH/Q7ucI49zHGN5zg/BQjFUyzQwzcu0MUZZmVICnCFJhpRt07xopMcYIwn9CPAIZao5gCPGGAYAXbxhvqmgKTvsoMa3rGfmewHWngNeWXAESZoZwCXeMFtDDgu/h1krYsg9ws3/xAQJI5wkHFwj8+UxLAoD1hZ1QTsB6fFvayMcaPD/gW+1yoRIiSCtwAAAABJRU5ErkJggg=="},t.lockImageItem=new L.a.Image({style:{image:t.lockImage.unLockImage,width:16,height:16},z:h+1}),t.getLineDash(),t.showHead=!0,t.anchors=[],t.groupStyle={fill:t.fill,lineWidth:1,stroke:t.stroke,lineDash:t.lineDash},t.headStyle={fill:t.fill,lineWidth:1,stroke:t.stroke,text:t.groupText,textFill:t.textFill,lineDash:t.lineDash,textPosition:"insideLeft",fontSize:12,fontStyle:"",fontWeight:"",transformText:!0},t.z=h,t.groupRect=new L.a.Rect({style:t.groupStyle,z:h}),t.groupHead=new L.a.Rect({style:t.headStyle,z:h}),t.gtext=new L.a.Text({style:{textPadding:[6,10],fontSize:14,text:t.groupText}}),t.nodeType="group",t.add(t.groupRect),t.add(t.groupHead),t.add(t.lockImageItem),t.redoGroup(),t.groupHead.nodeGroup=Object(B["a"])(t),t.groupRect.nodeGroup=Object(B["a"])(t),t.create(),t.createAnchors(),t.anch=new Ie(Object(B["a"])(t)),t.anch.hide(),t.initEvent(),t}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"getId",value:function(){return this.id||this.groupRect.id}},{key:"setId",value:function(t){this.id=t}},{key:"getLineDash",value:function(){"solid"==this.strokeType?this.lineDash=[]:this.lineDash=[4,2]}},{key:"create",value:function(t){if(this.locked){var e=this.position.slice(),i=new L.a.Group,o=i.getBoundingRect([this]);return o.width=parseInt(o.width),o.height=parseInt(o.height),o={x:e[0],y:e[1],width:o.width,height:o.height},this.box=o,void this._refresh()}var n=new L.a.Group,a={};this.gtext.setStyle("text",this.groupText),this.tb=this.gtext.getBoundingRect();var s=this.tb;if(s.height=Math.ceil(s.height),this.nodes.length>0)a=n.getBoundingRect(t||this.nodes),a.x=parseInt(a.x),a.y=parseInt(a.y),a.width=parseInt(a.width),a.height=parseInt(a.height),a.width<40&&(a.width=40),a.height<40&&(a.height=40),a.x-=20,a.width+=40,this.showHead?(a.y=a.y-s.height-20,a.height+=40+s.height,this.groupHead.show()):(a.y=a.y-20,a.height+=40,this.groupHead.hide()),this.box=a;else{var r=this.position.slice();a={x:r[0],y:r[1],width:80,height:60+s.height},this.box=a}this._refresh()}},{key:"toggleLock",value:function(){this.locked=!this.locked,this.locked?this.lockImageItem.attr({style:{image:this.lockImage.lockImage}}):this.lockImageItem.attr({style:{image:this.lockImage.unLockImage}})}},{key:"createAnchors",value:function(){this.anchors=[];var t=this.box,e={x:t.x+t.width/4,y:t.y,index:1,node:this,direct:"top"},i={x:t.x+t.width/2,y:t.y,index:2,node:this,direct:"top"},o={x:t.x+t.width/4*3,y:t.y,index:3,node:this,direct:"top"},n={x:t.x+t.width,y:t.y+t.height/4,index:4,node:this,direct:"right"},a={x:t.x+t.width,y:t.y+t.height/2,index:5,node:this,direct:"right"},s={x:t.x+t.width,y:t.y+t.height/4*3,index:6,node:this,direct:"right"},r={x:t.x+t.width/4,y:t.y+t.height,index:7,node:this,direct:"bottom"},h={x:t.x+t.width/2,y:t.y+t.height,index:8,node:this,direct:"bottom"},c={x:t.x+t.width/4*3,y:t.y+t.height,index:9,node:this,direct:"bottom"},l={x:t.x,y:t.y+t.height/4,index:10,node:this,direct:"left"},d={x:t.x,y:t.y+t.height/2,index:11,node:this,direct:"left"},u={x:t.x,y:t.y+t.height/4*3,index:12,node:this,direct:"left"};this.anchors.push(e,i,o,n,a,s,r,h,c,l,d,u)}},{key:"getAnchorByIndex",value:function(t){return this.anchors.filter((function(e){return e.index==t}))[0]}},{key:"getAnchByIndex",value:function(t){if(this.anch)return this.anch.getBarByIndex(t)}},{key:"getAnchors",value:function(){return this.anchors}},{key:"_refresh",value:function(){var t=this.box;if(this.attr({position:[t.x,t.y]}),this.locked)this.groupRect.attr({style:this.groupStyle}),this.groupHead.attr({style:this.headStyle});else{var e=this.tb;this.groupRect.attr({style:this.groupStyle,shape:{x:.5,y:.5,width:t.width,height:t.height}}),this.groupHead.attr({style:this.headStyle,shape:{x:.5,y:.5,width:t.width,height:e.height}}),this.lockImageItem.attr({position:[t.width-20,5]})}}},{key:"setPosition",value:function(t,e){this.attr({position:[t,e]})}},{key:"getPosition",value:function(){var t=this.position.slice();return{x:t[0],y:t[1]}}},{key:"viewTemGroup",value:function(t,e){if("up"==t){var i=this.nodes.slice();this.create(i.concat(e))}else{var o=this.nodes.filter((function(t){return t!=e}));o.length?this.create(o):this.create([this])}}},{key:"move",value:function(t,e){var i=this.getPosition();this.attr({position:[i.x+t,i.y+e]})}},{key:"addNode",value:function(t){t.nodeGroup=this,this.nodes.indexOf(-1==t)&&(this.nodes.push(t),this.refresh())}},{key:"setLevel",value:function(t){this.z=t,this.groupRect.attr({z:t}),this.groupHead.attr({z:t})}},{key:"getLevel",value:function(){return this.z}},{key:"removeNode",value:function(t){var e=this.nodes.indexOf(t);e>-1&&this.nodes.splice(e,1),t.nodeGroup=null,this.refresh()}},{key:"refresh",value:function(){this.create(),this.refreshEdge();var t=this.topGroup;while(t)t.refresh(),t=t.topGroup}},{key:"refreshEdge",value:function(){this.createAnchors(),this.anch.refresh(),this.__zr&&this.__zr.trigger("refreshEdge",{node:this})}},{key:"cancelGroup",value:function(){this.nodes.forEach((function(t){t.nodeGroup=null}))}},{key:"redoGroup",value:function(){var t=this;this.nodes.forEach((function(e){e.nodeGroup=t}))}},{key:"getStyle",value:function(){var t=this.groupHead.style;return Ti({stroke:this.stroke,groupFill:this.fill,text:this.text,showHead:this.showHead},t)}},{key:"getGroupStyle",value:function(){return L.a.util.clone(this.groupStyle)}},{key:"setGroupStyle",value:function(t){this.stroke=t.stroke,this.fill=t.fill,this.groupStyle=Ti({},this.groupStyle,{},t),this.headStyle.stroke=this.stroke,this.refresh()}},{key:"getHeadStyle",value:function(){return L.a.util.clone(this.headStyle)}},{key:"setHeadStyle",value:function(t){this.headFill=t.fill,this.groupText=t.text,this.headStyle=Ti({},this.headStyle,{},t),this.gtext.setStyle("fontSize",t.fontSize),this.gtext.setStyle("text",t.groupText),this.refresh()}},{key:"changeHead",value:function(t){this.showHead=t,t?this.groupHead.show():this.groupHead.hide(),this.refresh()}},{key:"getGroupData",value:function(t){var e=[];t.nodes.forEach((function(t){if("node"==t.nodeType){var i={type:"node",node:t.getId()};e.push(i)}}));var i={id:t.getId(),nodes:e,topGroup:t.topGroup&&t.topGroup.getId()||"",headStyle:L.a.util.clone(t.groupHead.style),groupStyle:L.a.util.clone(t.groupRect.style),showHead:t.showHead,locked:t.locked};return t.locked&&(i.box=L.a.util.clone(t.box)),i}},{key:"setBox",value:function(t){this.box=t}},{key:"getData",value:function(){return this.getGroupData(this)}},{key:"setOldPos",value:function(){function t(e){e.oldPos=e.position.slice(),e.nodes.forEach((function(e){e.oldPos=e.position.slice(),"group"==e.type&&t(e)}))}t(this)}},{key:"getAllItems",value:function(){var t=[this];function e(i){i.nodes.forEach((function(i){t.push(i),"group"==i.type&&e(i)}))}return e(this),t}},{key:"initEvent",value:function(){var t,e,i,o,n,a,s=this,r=!1,h=!1,c=this;this.on("mouseover",(function(){s.create(),s.createAnchors(),s.anch.refresh(),s.anch.show(),s.lockImageItem.show()})),this.on("mouseout",(function(){s.anch.hide(),s.lockImageItem.hide()})),this.on("mousedown",(function(o){if(s.__zr.trigger("clearSelectItems"),s.__zr.trigger("selectGroup",{group:s}),t=parseInt(o.offsetX),e=parseInt(o.offsetY),r=!0,i=s.position.slice(),s.setOldPos(),a=s.getAllItems(),s.editor){s.editor.multipleSelectEdges(a);var n=new L.a.Group,h=n.getBoundingRect([s]);s.editor.cover.attr({position:[i[0],i[1]],shape:{width:h.width,height:h.height}})}a.forEach((function(t){t.anch&&t.anch.hide()})),s.dragging=!1,document.addEventListener("mousemove",l),document.addEventListener("mouseup",d),o.stopPropagation&&o.stopPropagation()}));var l=function(a){r&&(o=parseInt(a.offsetX-t),n=parseInt(a.offsetY-e),s.editor&&(s.editor.cover.show(),s.editor.cover.attr({position:[i[0]+o,i[1]+n]})),h=!0,s.dragging=!0,s.anch.hide())};this.on("dblclick",(function(){this.showHead&&this.__zr.trigger("edit",{status:"editGroup",group:this,text:this.headStyle.text})})),this.groupRect.on("dragenter",(function(t){var e=t.topTarget;e&&"node"!=e.nodeType||(-1==c.nodes.indexOf(e)?(this.setStyle("stroke","red"),e.addToNodeGroup=!0):(e.groupTime&&(e.groupTime=null,e.leaveGroup=!1,e.groupTimeout&&(clearTimeout(e.groupTimeout),e.groupTimeout=null)),e.addToNodeGroup=!1))})).on("dragleave",(function(t){var e=t.topTarget;e&&"node"!=e.nodeType||(c.nodes.indexOf(e)>-1?c.locked?(this.setStyle("stroke","red"),e.groupTime=+new Date,e.leaveGroup=!0,e.groupTimeout=setTimeout((function(){c.groupRect.setStyle("stroke","#ccc"),clearTimeout(e.groupTimeout),e.groupTimeout=null,e.groupTime=null,e.leaveGroup=!0,c.refresh()}),50)):(this.setStyle("stroke","red"),e.groupTime=+new Date,e.leaveGroup=!0,e.groupTimeout=setTimeout((function(){c.viewTemGroup("down",e),clearTimeout(e.groupTimeout),e.groupTimeout=null,e.groupTime=null,e.leaveGroup=!0}),1500)):(this.setStyle("stroke",c.stroke),e&&(e.addToNodeGroup=!1,e.leaveGroup=!1)))})).on("drop",(function(t){var e=t.topTarget;if(e){if("node"!=e.nodeType)return;-1==c.nodes.indexOf(e)&&(e.addToNodeGroup=!1,this.__zr.trigger("addNodeToGroup",{node:e,group:c}),this.setStyle("stroke",c.stroke),e.leaveGroup=!1)}}));var d=function t(){r&&(s.dragging=!1,r=!1,h&&(s.attr({position:[i[0]+o,i[1]+n]}),s.editor.moveNode(o,n,a),s.__zr.trigger("moveGroup",{group:s}),h=!1,s.create(),s.createAnchors(),s.refreshEdge(),s.anch.refresh(),s.anch.show(),s.editor.cover.hide()),a.forEach((function(t){t.create&&t.create(),t.createAnchors(),t.anch&&t.anch.refresh()}))),document.removeEventListener("mousemove",l),document.removeEventListener("mouseup",t)};document.addEventListener("mouseup",d),this.lockImageItem.on("click",(function(){s.toggleLock()}))}}]),e}(L.a.Group),ji=Ci;function Ei(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,o)}return i}function Ni(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Ei(Object(i),!0).forEach((function(e){Object(N["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Ei(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var zi=function(t){function e(t,i){var o;return Object(z["a"])(this,e),o=Object(G["a"])(this,Object(_["a"])(e).call(this)),o.zr=L.a.init(document.getElementById(t),{renderer:"canvas"}),o.id=o.uuid(),o.data=i||{},o.stack=new M(o.data.stackStep||50),o.nodes=[],o.facilities=[],o.borders=[],o.rightBorders=[],o.downBorders=[],o.leftBorders=[],o.upBorders=[],o.fAndO=[],o.edges=[],o.groups=[],o.alertLines={},o.status="",o.scale=1,o.frame=new ui(Object(B["a"])(o)),o.frame.addTo(Object(B["a"])(o)),o.selectFrame=new L.a.Rect({style:{fill:"#1890ff",opacity:.1},shape:{x:0,y:0,width:0,heigt:0},z:1e4}),o.zr.add(o.selectFrame),o.selectFrame.hide(),o.zr.add(Object(B["a"])(o)),o.cover=new L.a.Rect({style:{fill:"rgb(231, 247, 254)",stroke:"rgb(178, 222, 254)",opacity:.6},shape:{width:0,height:0},z:1e5}),o.cover.hide(),o.add(o.cover),o.commandChange(),o.initEvent(),o}return Object(I["a"])(e,t),Object(F["a"])(e,[{key:"init",value:function(t,e){var i=this;if(this.nodes=[],this.edges=[],this.groups=[],this.removeAll(),this.add(this.cover),this.frame.addTo(this),this.attr({position:[0,0]}),!t||!t.type||"cicadaFlow"!=t.type)throw new Error("不支持的数据");this.initData=t;var o=t.node,n=t.group,a=t.edge;o.forEach((function(t){var o=We.getShape(t.command,t,e);o.setData(t),e||(o.createAnchors(),o.anch.refresh()),i.addNode(o)})),n.forEach((function(t){var e=[];t.nodes.forEach((function(t){e.push(i.getNodeById(t.node))}));var o=new ji(e);o.setHeadStyle(t.headStyle),o.setGroupStyle(t.groupStyle),o.setId(t.id),o.changeHead(t.showHead),t.locked&&(o.setBox(t.box),o.toggleLock()),i.addGroup(o)})),n.forEach((function(t){if(t.topGroup){var e=i.getGroupById(t.topGroup),o=i.getGroupById(t.id);o.topGroup=e,e.nodes.push(o),e.refresh()}})),a.forEach((function(t){var e=new Pi;if(e.setData(t),t.fromNode){var o=i.getItemById(t.fromNode),n=o.getAnchByIndex(t.fromAnch);e.setFromNode(o),e.setFromAnch(n)}if(t.endNode){var a=i.getItemById(t.endNode),s=a.getAnchByIndex(t.toAnch);e.setToNode(a),e.setToAnch(s)}i.addEdge(e)}))}},{key:"clearHistory",value:function(){this.stack.clear()}},{key:"getItemById",value:function(t){var e=this.nodes.concat(this.groups);return e.filter((function(e){return e.getId()==t}))[0]}},{key:"getNodeById",value:function(t){return this.nodes.filter((function(e){return e.getId()==t}))[0]}},{key:"getGroupById",value:function(t){return this.groups.filter((function(e){return e.getId()==t}))[0]}},{key:"getEdgeById",value:function(t){return this.edges.filter((function(e){return e.getId()==t}))[0]}},{key:"parseSvg",value:function(){}},{key:"addShape",value:function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)this.execute("addShape",t[e]);else this.execute("addShape",t)}},{key:"getSafeArea",value:function(t,e,i){var o,n,a,s,r=t.position,h=t.shape.width,c=t.shape.height;if(i){var l=9999;o=l,n=l,a=l,s=l}else o=t.safe.right/e,n=t.safe.left/e,a=t.safe.up/e,s=t.safe.down/e;return{right:{topLeft:{x:r[0]+h,y:r[1]},topRight:{x:r[0]+h+o,y:r[1]},downRight:{x:r[0]+h,y:r[1]+c},downLeft:{x:r[0]+h+o,y:r[1]+c},start:{x:r[0]+h,y:r[1]+c/2}},left:{topLeft:{x:r[0]-n,y:r[1]},topRight:{x:r[0],y:r[1]},downRight:{x:r[0],y:r[1]+c},downLeft:{x:r[0]-n,y:r[1]+c},start:{x:r[0],y:r[1]+c/2}},up:{topLeft:{x:r[0],y:r[1]-a},topRight:{x:r[0]+h,y:r[1]-a},downRight:{x:r[0]+h,y:r[1]},downLeft:{x:r[0],y:r[1]},start:{x:r[0]+h/2,y:r[1]}},down:{topLeft:{x:r[0],y:r[1]+c},topRight:{x:r[0]+h,y:r[1]},downRight:{x:r[0]+h,y:r[1]+c+s},downLeft:{x:r[0],y:r[1]+c+s},start:{x:r[0]+h/2,y:r[1]+c}}}}},{key:"checkRight",value:function(t,e,i){for(var o=t.indexOf(i),n=0;n<t.length;n++){var a,s,r;if(n!==o)if(0===t[n].kind?(a=t[n].shape.x1,s=t[n].shape.y1,r=t[n].shape.y2):(a=t[n].position[0],s=t[n].position[1],r=s+t[n].shape.height),!(s>e.downRight.y||r<e.topRight.y)&&a>e.topLeft.x&&a<e.topRight.x){var h=a-e.topLeft.x;return{x1:e.start.x,y1:e.start.y,x2:e.start.x+h,y2:e.start.y,text:this.getLength(h)}}}return!0}},{key:"checkLeft",value:function(t,e,i){for(var o=t.indexOf(i),n=0;n<t.length;n++){var a,s,r;if(n!==o)if(0===t[n].kind?(a=t[n].shape.x1,s=t[n].shape.y2,r=t[n].shape.y1):(a=t[n].position[0]+t[n].shape.width,s=t[n].position[1],r=s+t[n].shape.height),!(s>e.downRight.y||r<e.topRight.y)&&a>e.topLeft.x&&a<e.topRight.x){var h=e.topRight.x-a;return{x1:e.start.x,y1:e.start.y,x2:e.start.x-h,y2:e.start.y,text:this.getLength(h)}}}return!0}},{key:"checkUp",value:function(t,e,i){for(var o=t.indexOf(i),n=0;n<t.length;n++){var a,s,r;if(n!==o)if(0===t[n].kind?(a=t[n].shape.x1,s=t[n].shape.x2,r=t[n].shape.y1):(a=t[n].position[0],s=a+t[n].shape.width,r=t[n].position[1]+t[n].shape.height),!(a>e.downRight.x||s<e.downLeft.x)&&r<e.downLeft.y&&r>e.topLeft.y){var h=e.downLeft.y-r;return{x1:e.start.x,y1:e.start.y,x2:e.start.x,y2:e.start.y-h,text:this.getLength(h)}}}return!0}},{key:"checkDown",value:function(t,e,i){for(var o=t.indexOf(i),n=0;n<t.length;n++){var a,s,r;if(n!==o)if(0===t[n].kind?(a=t[n].shape.x2,s=t[n].shape.x1,r=t[n].shape.y1):(a=t[n].position[0],s=a+t[n].shape.width,r=t[n].position[1]),!(a>e.downRight.x||s<e.downLeft.x)&&r<e.downLeft.y&&r>e.topLeft.y){var h=r-e.topLeft.y;return{x1:e.start.x,y1:e.start.y,x2:e.start.x,y2:e.start.y+h,text:this.getLength(h)}}}return!0}},{key:"getLength",value:function(t){t*=this.scale;var e=t+"",i=e.indexOf(".");return e.substring(0,i+2)}},{key:"checkSafe",value:function(){var t=this;this.facilities.forEach((function(e){e.alerts=[];var i=t.getSafeArea(e,t.scale),o=t.checkRight(t.fAndO,i.right,e);if(!0!==o)t.buildAlertLineCmd(e.alerts,o,1);else{var n=t.checkRight(t.downBorders,i.right);!0!==n&&t.buildAlertLineCmd(e.alerts,n,1)}var a=t.checkLeft(t.fAndO,i.left,e);if(!0!==a)t.buildAlertLineCmd(e.alerts,a,1);else{var s=t.checkLeft(t.upBorders,i.left);!0!==s&&t.buildAlertLineCmd(e.alerts,s,1)}var r=t.checkUp(t.fAndO,i.up,e);if(!0!==r)t.buildAlertLineCmd(e.alerts,r,0);else{var h=t.checkUp(t.rightBorders,i.up);!0!==h&&t.buildAlertLineCmd(e.alerts,h,0)}var c=t.checkDown(t.fAndO,i.down,e);if(!0!==c)t.buildAlertLineCmd(e.alerts,c,0,4);else{var l=t.checkDown(t.leftBorders,i.down);!0!==l&&t.buildAlertLineCmd(e.alerts,l,0,4)}})),t.updateAlertLine(t.facilities)}},{key:"buildParameter",value:function(){this.facilities=this.nodes.filter((function(t){return 3===t.kind})),this.fAndO=this.nodes.filter((function(t){return 3===t.kind||2===t.kind})),this.borders=this.nodes.filter((function(t){return 0===t.kind})),this.rightBorders=this.borders.filter((function(t){return 0===t.direction})),this.downBorders=this.borders.filter((function(t){return 1===t.direction})),this.leftBorders=this.borders.filter((function(t){return 2===t.direction})),this.upBorders=this.borders.filter((function(t){return 3===t.direction}))}},{key:"checkObstaceDistance",value:function(t){var e=this;t.alerts=[];var i=e.getSafeArea(t,e.scale,!0),o=e.checkRight(this.fAndO,i.right,t);if(!0!==o)e.buildAlertLineCmd(t.alerts,o,1,5);else{var n=e.checkRight(this.downBorders,i.right);!0!==n&&e.buildAlertLineCmd(t.alerts,n,1,5)}var a=e.checkLeft(this.fAndO,i.left,t);if(!0!==a)e.buildAlertLineCmd(t.alerts,a,1,5);else{var s=e.checkLeft(this.upBorders,i.left);!0!==s&&e.buildAlertLineCmd(t.alerts,s,1,5)}var r=e.checkUp(this.fAndO,i.up,t);if(!0!==r)e.buildAlertLineCmd(t.alerts,r,0,5);else{var h=e.checkUp(this.rightBorders,i.up);!0!==h&&e.buildAlertLineCmd(t.alerts,h,0,5)}var c=e.checkDown(this.fAndO,i.down,t);if(!0!==c)e.buildAlertLineCmd(t.alerts,c,0,5);else{var l=e.checkDown(this.leftBorders,i.down);!0!==l&&e.buildAlertLineCmd(t.alerts,l,0,5)}e.updateObLine([t])}},{key:"buildAlertLineCmd",value:function(t,e,i,o){var n,a,s=e.x1,r=e.x2,h=e.y1,c=e.y2,l=e.text,d=5===o?"blue":"red";t.push({command:"line",kind:o||4,shape:{x1:s,y1:h,x2:r,y2:c},draggable:!1,style:{stroke:d,lineWidth:2},z:300}),0===i?(n=(s+r)/2+2,a=(h+c)/2-10):(n=(s+r)/2-10,a=(h+c)/2+2),t.push({command:"text",kind:o||4,x:n,y:a,draggable:!1,style:{text:l,fontSize:15,textFill:d}})}},{key:"updateAlertLine",value:function(t){this.clearFaAlert();for(var e=0;e<t.length;e++)for(var i=0;i<t[e].alerts.length;i++)this.execute("addAlertLine",t[e].alerts[i])}},{key:"updateObLine",value:function(t){this.clearOBAlert();for(var e=0;e<t.length;e++)for(var i=0;i<t[e].alerts.length;i++)this.execute("addAlertLine",t[e].alerts[i])}},{key:"clearFaAlert",value:function(){this.execute("clearAlert")}},{key:"clearOBAlert",value:function(){this.execute("clearOBAlert")}},{key:"execute",value:function(t,e,i){var o,n=[];switch(t){case"addShape":e.x=e.x-this.position[0],e.y=e.y-this.position[1];try{e.image&&(e.command="image");var a=We.getShape(e.command,e);this.stack.execute(new Ye([a],this))}catch(A){window.console.log(A)}0===a.kind&&this.scale!==a.scale&&(this.scale=a.scale),3!==a.kind&&2!==a.kind||this.checkSafe();break;case"addAlertLine":e.x=e.x-this.position[0],e.y=e.y-this.position[1];try{var s=We.getShape(e.command,e);this.stack.execute(new Ye([s],this))}catch(A){window.console.log(A)}break;case"moveNode":i.length&&(i.forEach((function(t){if("node"==t.nodeType){var e=t.oldPos.slice(),i=t.position.slice(),o=new Qe(t,e,i);n.push(o)}})),n.length&&(o=new Xe(n),this.stack.execute(o))),3!==i[0].kind&&2!==i[0].kind||this.checkSafe(),2===i[0].kind&&this.checkObstaceDistance(i[0]);break;case"addEdge":var r=e.edge;this.stack.execute(new Ve(r,this));break;case"createGroup":this.stack.execute(new ti(e.group,e.topGroup,this));break;case"cancelGroup":this.stack.execute(new ei(e.group,this.zr));break;case"removeNodeFromGroup":this.stack.execute(new ii(e.node));break;case"addNodeToGroup":this.stack.execute(new oi(e.node,e.group));break;case"changeNode":i.length&&(i.forEach((function(t){var i=t.getData(),o=L.a.util.clone(i);e.style&&(o.style=Ni({},o.style,{},e.style)),e.shape&&(o.shape=Ni({},o.shape,{},e.shape)),e.hasOwnProperty("z")&&(o.z=parseInt(e.z));var a=new ni(t,i,o);n.push(a)})),o=new Xe(n),this.stack.execute(o));break;case"resizeNode":var h=this.getSelectNodes()[0],c=h.getData(),l=new ni(h,e.oldData,c);this.stack.execute(l);break;case"changeGroup":var d,u,f=e.mark,p=e.group,g=e.style;"head"==f?(d=Ni({},p.getHeadStyle()),u=Ni({},d,{},g),this.stack.execute(new ai(p,d,u,f))):"group"==f?(d=Ni({},p.getGroupStyle()),u=Ni({},d,{},g),this.stack.execute(new ai(p,d,u,f))):this.stack.execute(new ri(p,e.showHead));break;case"deleteNode":this.stack.execute(new Ke([e.node],this)),this.clearOBAlert(),this.clearFaAlert(),this.checkSafe();break;case"deleteAll":while(this.nodes.length>0)this.stack.execute(new Ke(this.nodes,this));break;case"clearAlert":var y=this.nodes.filter((function(t){return 4===t.kind}));this.stack.execute(new Ke(y,this));break;case"clearOBAlert":var x=this.nodes.filter((function(t){return 5===t.kind}));this.stack.execute(new Ke(x,this));break;case"deleteNodes":this.stack.execute(new Ke(e.nodes,this));break;case"deleteGroup":this.stack.execute(new si(e.group,this));break;case"deleteEdge":this.stack.execute(new Ze(e.edge,this));break;case"changeEdge":var v=e.type;if("changeAnch"==v)"anch"==e.mark?this.stack.execute(new li(e.edge,e)):"point"==e.mark&&this.stack.execute(new li(e.edge,e));else if("text"==e.mark){var m=e.edge.getText(),w=e.style.text;this.stack.execute(new ci(e.edge,m,w))}else{var b,k;b=e.edge.getData(),k=Ni({},b,{},e.style),this.stack.execute(new hi(e.edge,b,k))}break;case"ungroup":var O=e.group;O&&this.stack.execute(new ei(O,this));break}this.buildParameter()}},{key:"undo",value:function(){this.stack.undo()}},{key:"redo",value:function(){this.stack.redo()}},{key:"commandChange",value:function(){var t=this;this.stack.change=function(){t.refreshHistory()}}},{key:"refreshFullEdge",value:function(){this.fullSelectEdges.length&&this.fullSelectEdges.forEach((function(t){var e=t.oldPos?t.oldPos.slice():t.position.slice(),i=t.position.slice(),o=i[0]-e[0],n=i[1]-e[1],a=L.a.util.clone(t.oldCpx);if(a.x1=a.x1+o,a.x2=a.x2+o,a.y1=a.y1+n,a.y2=a.y2+n,a.cpx1=parseFloat(a.cpx1)+o,a.cpy1=parseFloat(a.cpy1)+n,a.cpx2=parseFloat(a.cpx2)+o,a.cpy2=parseFloat(a.cpy2)+n,"polyline"==t.type){var s=a.points;s.forEach((function(t){t[0]=t[0]+o,t[1]=t[1]+n})),a.points=s;var r=a.lineCenter.slice();a.lineCenter[0]=r[0]+o,a.lineCenter[1]=r[1]+n}t.setCpx(a),t.refresh(),t.setPosition(0,0)}))}},{key:"refreshHistory",value:function(){this.zr.trigger("undoredo",{undo:!!this.stack.canUndo(),redo:!!this.stack.canRedo()})}},{key:"uuid",value:function(){function t(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function e(){return t()+t()+t()+t()}return e()}},{key:"getData",value:function(){var t=this.nodes.map((function(t){return t.getData()})),e=this.groups.map((function(t){return t.getData()})),i=this.edges.map((function(t){return t.getData()}));return{id:this.id,type:"cicadaFlow",node:t,group:e,edge:i}}},{key:"copy",value:function(t,e){var i=this,o=[],n=[];if("node"==t){if(e.forEach((function(t){var e=t.position.slice(),n=L.a.util.clone(t.getData());n.id=i.uuid();var a=We.getShape(n.command,n,!1);o.push(a),a.attr({position:[e[0]+20,e[1]+20]}),a.kind=t.kind,a.face=t.face,a.safe=Object.assign({},t.safe),a.createAnchors(),a.anch.refresh()})),o.length){var a=new Ye(o,this);this.stack.execute(a)}}else if("group"==t){var s=L.a.util.clone(e.getData());e.nodes.forEach((function(t){if("node"==t.nodeType){var e=t.position.slice(),n=L.a.util.clone(t.getData());n.id=i.uuid();var a=We.getShape(n.command,n,!1);o.push(a),a.attr({position:[e[0]+20,e[1]+20]}),a.createAnchors(),a.anch.refresh()}}));var r=new ji(o);r.editor=this,r.setGroupStyle(s.groupStyle),r.setHeadStyle(s.headStyle),r.changeHead(s.showHead);var h=new ti(r,null,this),c=new Ye(o,this);n.push(h),n.push(c),this.stack.execute(new Xe(n))}}},{key:"selectItem",value:function(t){this.clearSelectItems(),t.active();var e=new L.a.Group,i=e.getBoundingRect([t]);this.frame.boxSelect(i,t),this.frame.refreshBar(),this.frame.show()}},{key:"selectItems",value:function(t){this.clearSelectItems();var e=new L.a.Group;t.forEach((function(t){t.selected=!0,e.add(t)}));var i=e.getBoundingRect(t);this.frame.boxSelect(i,t)}},{key:"getSelectItems",value:function(){return this.nodes.filter((function(t){return t.selected})).concat(this.edges.filter((function(t){return t.selected})))}},{key:"getSelectNodes",value:function(){return this.nodes.filter((function(t){return t.selected||t.dragging}))}},{key:"getSelectEdges",value:function(){return this.edges.filter((function(t){return t.selected}))}},{key:"getEdgesByNode",value:function(t){var e=[];return this.edges.forEach((function(i){i.fromNode!=t&&i.toNode!=t||-1==e.indexOf(i)&&e.push(i)})),e}},{key:"clearSelectItems",value:function(){this.nodes.forEach((function(t){t.unactive()})),this.edges.forEach((function(t){t.unactive()})),this.groups.forEach((function(t){return t.selected=!1})),this.frame.hide()}},{key:"addNode",value:function(t){var e=this;this.nodes.push(t),this.add(t),t.anch&&t.anch.bars.forEach((function(t){e.add(t)}))}},{key:"addEdge",value:function(t){-1==this.edges.indexOf(t)&&(this.edges.push(t),this.add(t),t.editor=this)}},{key:"removeEdge",value:function(t){var e=this.edges.indexOf(t);e>-1&&(this.remove(t),this.edges.splice(e,1))}},{key:"removeNode",value:function(t){var e=this,i=this.nodes.indexOf(t);i>-1&&(this.nodes.splice(i,1),t.anch&&t.anch.bars.forEach((function(t){e.remove(t)})),this.remove(t))}},{key:"getAllEdgesByGroup",value:function(t){var e=this;if(t){var i=this.getEdgesByGroup(t),o=t.nodes;return o.forEach((function(t){var o=e.getEdgesByNode(t);o.forEach((function(t){-1==i.indexOf(t)&&i.push(t)}))})),i}return[]}},{key:"showAllAnch",value:function(){this.hasShowAllAnch||(this.nodes.forEach((function(t){t.time&&clearTimeout(t.time),t.anch.show()})),this.groups.forEach((function(t){t.time&&clearTimeout(t.time),t.anch.show()})),this.hasShowAllAnch=!0)}},{key:"hideAllAnch",value:function(){this.nodes.forEach((function(t){t.anch.hide()})),this.hasShowAllAnch=!1}},{key:"getEdgesByGroup",value:function(t){var e=[];return this.edges.forEach((function(i){i.fromNode!=t&&i.toNode!=t||-1==e.indexOf(i)&&e.push(i)})),e}},{key:"multipleSelect",value:function(){var t=this.selectFrame.getBoundingRect(),e=new L.a.Group,i=this.position.slice();this.nodes.forEach((function(o){var n=e.getBoundingRect([o]);n.x=n.x+i[0],n.y=n.y+i[1],t.intersect(n)?o.active():o.unactive()}))}},{key:"multipleSelectEdges",value:function(t){var e=this;this.selectGroups=[],this.fullSelectEdges=[],this.notFullSelectEdges=[];var i=t||this.getSelectNodes(),o=[],n=[];i.forEach((function(t){if("node"==t.nodeType){t.nodeGroup&&-1==e.selectGroups.indexOf(t.nodeGroup)&&e.selectGroups.push(t.nodeGroup);var a=e.getEdgesByNode(t);a.forEach((function(t){i.indexOf(t.fromNode)>-1&&i.indexOf(t.toNode)>-1?-1==n.indexOf(t)&&(n.push(t),t.oldCpx=Ni({},{},{},t.getCpx()),t.oldPos=t.position.slice()):-1==o.indexOf(t)&&(o.push(t),t.oldCpx=Ni({},{},{},t.getCpx()),t.oldPos=t.position.slice())}))}else if("group"==t.nodeType){var s=e.getEdgesByGroup(t);s.forEach((function(t){i.indexOf(t.fromNode)>-1&&i.indexOf(t.toNode)>-1?-1==n.indexOf(t)&&(n.push(t),t.oldCpx=Ni({},{},{},t.getCpx()),t.oldPos=t.position.slice()):-1==o.indexOf(t)&&(o.push(t),t.oldCpx=Ni({},{},{},t.getCpx()),t.oldPos=t.position.slice())}))}})),this.fullSelectEdges=n,this.notFullSelectEdges=o}},{key:"moveNode",value:function(t,e,i){var o=this;window.console.log(t);var n=i||this.getSelectNodes();n.forEach((function(i){var n=i.oldPos;i.attr({position:[n[0]+t,n[1]+e]}),o.moveEdge(t,e,i)})),2!==n[0].kind&&3!==n[0].kind||this.checkObstaceDistance(n[0])}},{key:"moveRefreshEdge",value:function(){this.fullSelectEdges.forEach((function(t){t.refresh()})),this.notFullSelectEdges.forEach((function(t){t.refresh()}))}},{key:"viewProGroup",value:function(){var t=this.getSelectNodes();t.forEach((function(t){t.nodeGroup?t.groupTime&&t.groupEndTime&&t.groupEndTime-t.groupTime>1e3&&t.nodeGroup.viewTemGroup("down",t):t.groupTime&&t.groupEndTime&&t.temporaryGroup&&t.groupEndTime-t.groupTime>1e3&&t.temporaryGroup.viewTemGroup("up",t)}))}},{key:"dropProGroup",value:function(){var t=this.getSelectNodes();t.forEach((function(t){t.nodeGroup?t.groupTime&&t.groupEndTime&&t.groupEndTime-t.groupTime>1e3&&t.nodeGroup.removeNode(t):t.groupTime&&t.groupEndTime&&t.temporaryGroup&&t.groupEndTime-t.groupTime>1e3&&t.temporaryGroup.addNode(t)}))}},{key:"moveEdge",value:function(t,e,i){this.fullSelectEdges.forEach((function(i){var o=L.a.util.clone(i.oldCpx);if(o.x1=o.x1+t,o.x2=o.x2+t,o.y1=o.y1+e,o.y2=o.y2+e,o.cpx1=o.cpx1+t,o.cpy1=o.cpy1+e,o.cpx2=o.cpx2+t,o.cpy2=o.cpy2+e,"polyline"==i.type){var n=o.points;n.forEach((function(i){i[0]=i[0]+t,i[1]=i[1]+e})),o.points=n;var a=o.lineCenter.slice();o.lineCenter[0]=a[0]+t,o.lineCenter[1]=a[1]+e}i.setCpx(o),i.refresh()})),this.notFullSelectEdges.forEach((function(t){"group"==i.nodeType&&i.create(),i.createAnchors(),t.fromNode==i?(t.setFromPoint(i.getAnchorByIndex(t.fromAnch.point.index)),t.refresh()):t.toNode==i&&(t.setToPoint(i.getAnchorByIndex(t.toAnch.point.index)),t.refresh())}))}},{key:"updateNodeAnch",value:function(){var t=this.getSelectNodes();t.forEach((function(t){t.createAnchors(),t.anch&&t.anch.refresh()}))}},{key:"setShadow",value:function(){this.nodes.forEach((function(t){return t.setShadow()})),this.groups.forEach((function(t){return t.setShadow()})),this.edges.forEach((function(t){return t.setShadow()}))}},{key:"cancelShadow",value:function(){this.nodes.forEach((function(t){return t.cancelShadow()})),this.groups.forEach((function(t){return t.cancelShadow()})),this.edges.forEach((function(t){return t.cancelShadow()}))}},{key:"leftAlign",value:function(){var t=[],e=this.getSelectNodes();if(e.length>1){var i=new L.a.Group,o=i.getBoundingRect(e);e.forEach((function(e){e.oldPos=e.position.slice();var n=i.getBoundingRect([e]),a=o.x-n.x,s=e.position.slice();s[0]=s[0]+parseInt(a),e.attr({position:s.slice()}),e.refreshEdge(),e.nodeGroup&&-1==t.indexOf(e.nodeGroup)&&t.push(e.nodeGroup)})),this.execute("moveNode",{},e),t.forEach((function(t){t.refresh()}))}}},{key:"rightAlign",value:function(){var t=[],e=this.getSelectNodes();if(e.length>1){var i=new L.a.Group,o=i.getBoundingRect(e);e.forEach((function(e){e.oldPos=e.position.slice();var n=i.getBoundingRect([e]),a=o.x+o.width-n.x-n.width,s=e.position.slice();s[0]=s[0]+parseInt(a),e.attr({position:s.slice()}),e.refreshEdge(),e.nodeGroup&&-1==t.indexOf(e.nodeGroup)&&t.push(e.nodeGroup)})),this.execute("moveNode",{},e),t.forEach((function(t){t.refresh()}))}}},{key:"verticalAlign",value:function(){var t=[],e=this.getSelectNodes();if(e.length>1){var i=new L.a.Group,o=i.getBoundingRect([e[0]]),n=o.x+o.width/2;e.forEach((function(o){if(o.oldPos=o.position.slice(),o!=e[0]){var a=i.getBoundingRect([o]),s=a.x+a.width/2,r=n-s,h=o.position.slice();h[0]=h[0]+parseInt(r),o.attr({position:h.slice()})}o.refreshEdge(),o.nodeGroup&&-1==t.indexOf(o.nodeGroup)&&t.push(o.nodeGroup)})),this.execute("moveNode",{},e),t.forEach((function(t){t.refresh()}))}}},{key:"horizontalAlign",value:function(){var t=[],e=this.getSelectNodes();if(e.length>1){var i=new L.a.Group,o=i.getBoundingRect([e[0]]),n=o.y+o.height/2;e.forEach((function(o){if(o.oldPos=o.position.slice(),o!=e[0]){var a=i.getBoundingRect([o]),s=a.y+a.height/2,r=n-s,h=o.position.slice();h[1]=h[1]+parseInt(r),o.attr({position:h.slice()})}o.refreshEdge(),o.nodeGroup&&-1==t.indexOf(o.nodeGroup)&&t.push(o.nodeGroup)})),this.execute("moveNode",{},e),t.forEach((function(t){t.refresh()}))}}},{key:"createGroup",value:function(){var t,e=this.getSelectNodes();if(e.length>1){var i=e.every((function(t){return!t.nodeGroup}));if(i)t=new ji(e),t.editor=this,this.execute("createGroup",{group:t});else{var o=e.every((function(t){return t.nodeGroup}));if(o){var n=e[0].nodeGroup,a=e.every((function(t){return t.nodeGroup==n}));if(a){var s=n.getLevel();t=new ji(e,"新建分组","#fafafa","#ccc","#333","dash",s+1),t.editor=this,t.topGroup=n,this.execute("createGroup",{group:t,topGroup:n})}}}}}},{key:"listen",value:function(t,e){this.zr.on(t,e)}},{key:"removeListen",value:function(t,e){this.zr.off(t,e)}},{key:"emit",value:function(t,e){this.zr.trigger(t,e)}},{key:"addGroup",value:function(t){var e=this;-1==this.groups.indexOf(t)&&(this.add(t),t.anch.bars.forEach((function(t){e.add(t)})),this.groups.push(t),t.editor=this)}},{key:"removeGroup",value:function(t){var e=this,i=this.groups.indexOf(t);i>-1&&(this.groups.splice(i,1),this.remove(t),t.anch.bars.forEach((function(t){e.remove(t)})))}},{key:"refreshGroup",value:function(){this.groups.forEach((function(t){t.refresh()}))}},{key:"showAnch",value:function(t,e){if("selectEdge"!=this.status&&"selectFrame"!=this.status){var i=new L.a.Group,o=this.position.slice(),n=0;"isCreateLink"!=this.status&&"changeEdge"!=this.status||(n=30);var a=this.nodes.concat(this.groups);a.forEach((function(a){if(a.dragging)a.anch&&a.anch.hide();else{var s=i.getBoundingRect([a]);s.x=s.x+o[0]-n,s.y=s.y+o[1]-n,s.width=s.width+2*n,s.height=s.height+2*n,s.contain(t,e)?a.anch&&a.anch.show():a.anch&&a.anch.hide()}}))}}},{key:"offEvent",value:function(){this.zr.off()}},{key:"initEvent",value:function(){var t=this;function e(t,e){clearTimeout(t.tId),t.tId=setTimeout((function(){t.call(e)}),300)}window.onresize=function(){e((function(){var e=document.getElementById("flowEditor").offsetWidth,i=document.getElementById("flowEditor").offsetHeight;t.zr.resize({width:e,height:i}),window.console.log(e,i)}))},this.zr.on("selectNode",(function(e){t.selectItem(e.node)})),this.zr.on("clearSelectItems",(function(){t.clearSelectItems()})),this.zr.on("judgeWidthGroup",(function(){t.judgeWidthGroup()})),this.zr.on("viewProGroup",(function(){t.viewProGroup()})),this.zr.on("hideFrame",(function(){t.frame.hide()})),this.zr.on("selectFrame",(function(){t.status="selectFrame"})),this.zr.on("moveGroup",(function(e){var i=e.group;t.execute("moveNode",{dx:l,dy:d},i.getAllItems())})),this.zr.on("refreshEdge",(function(e){var i,o=e.node;i="node"==o.nodeType?t.getEdgesByNode(o):t.getEdgesByGroup(o),i.forEach((function(t){t.fromNode==o?(t.setFromPoint(o.getAnchorByIndex(t.fromAnch.point.index)),t.refresh()):t.toNode==o&&(t.setToPoint(o.getAnchorByIndex(t.toAnch.point.index)),t.refresh())}))})),this.zr.on("moveNode",(function(e){var i=e.node,o=t.getSelectNodes();i&&-1==o.indexOf(i)&&(o=o.concat([i])),t.execute("moveNode",{dx:l,dy:d},o)})),this.zr.on("removeNodeFromGroup",(function(e){t.execute("removeNodeFromGroup",{node:e.node})})),this.zr.on("addNodeToGroup",(function(e){t.execute("addNodeToGroup",e)})),this.zr.on("resizeNode",(function(e){t.execute("resizeNode",e)})),this.zr.on("refreshSelectGroup",(function(){t.selectGroups.forEach((function(t){return t.refresh()}))}));var i,o,n,a,s=!1,r=0,h=0,c=!1,l=0,d=0,u=null,f=function(){},p=function e(){t.selectFrame.attr({shape:{x:0,y:0,width:0,heigt:0}}),t.status="",t.selectFrame.hide(),document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",e)};this.zr.on("mousedown",(function(e){if(r=e.offsetX,h=e.offsetY,s=!0,u=t.position.slice(),e.target||(t.zr.trigger("clearSelectItems"),"selectFrame"==t.status&&(t.selectFrame.attr({shape:{x:r,y:h}}),t.selectFrame.show()),document.addEventListener("mousemove",f),document.addEventListener("mouseup",p)),e.target){if(e.target.mark&&"anch"==e.target.mark){if(c&&i)return t.remove(i),t.status="",void(c=!1);a=e.target,t.status="isCreateLink",c=!0,i=new Pi(a.node),i.setFromPoint(Ni({},a.point)),i.fromAnch=a,t.add(i)}var l=t.getSelectNodes();l.forEach((function(t){t.oldPos=t.position.slice()})),"node"==e.target.nodeType&&t.multipleSelectEdges(),e.target.edge&&(t.status="changeEdge",o=e.target.edge,n=e.target)}})),this.zr.on("mousemove",(function(e){if(l=e.offsetX-r,d=e.offsetY-h,t.showAnch(e.offsetX,e.offsetY),s){if((c||"changeEdge"==t.status)&&c&&i.move(e.offsetX-u[0],e.offsetY-u[1]),"selectFrame"==t.status)return;if(!c&&e.target&&"node"==e.target.nodeType){if("resizeNode"==t.status||"changeEdge"==t.status)return;t.moveNode(l,d),t.viewProGroup()}if("changeEdge"==t.status&&o&&n){var a=n.oldCenter.x,f=n.oldCenter.y;n.attr({shape:{cx:a+l,cy:f+d}}),"from"==n.edgeType?o.setFromPoint({x:a+l,y:f+d},!0):o.setToPoint({x:a+l,y:f+d})}}})),this.zr.on("mouseup",(function(e){if(e.target&&e.target.mark&&"anch"==e.target.mark){if(c){if(e.target==a)return t.removeEdge(i),void(t.status="");try{i.setToNode(e.target.node),i.setToPoint(Ni({},e.target.point)),i.toAnch=e.target,t.execute("addEdge",{edge:i})}catch(e){t.removeEdge(i),i=null,t.status=""}finally{i=null,t.status=""}}if("changeEdge"==t.status){if("from"==n.edgeType)if(o.fromNode){if(o.fromAnch!=e.target){var l=o.fromNode,d=o.fromAnch;t.execute("changeEdge",{edge:o,type:"changeAnch",position:"from",oldNode:l,oldAnch:d,newNode:e.target.node,newAnch:e.target,mark:"anch"})}}else t.execute("changeEdge",{edge:o,type:"changeAnch",position:"from",oldCenter:Ni({},n.oldCenter),newCenter:{x:n.shape.cx,y:n.shape.cy},newNode:e.target.node,newAnch:e.target,mark:"point"});else if(o.toNode){if(o.toAnch!=e.target){var u=o.toNode,f=o.toAnch;t.execute("changeEdge",{edge:o,type:"changeAnch",position:"to",oldNode:u,oldAnch:f,newNode:e.target.node,newAnch:e.target,mark:"anch"})}}else t.execute("changeEdge",{edge:o,type:"changeAnch",position:"to",oldCenter:Ni({},n.oldCenter),newCenter:{x:n.shape.cx,y:n.shape.cy},newNode:e.target.node,newAnch:e.target,mark:"point"});o.refresh(),t.status="",n=null,o=null}}if("changeEdge"==t.status){if("from"==n.edgeType)if(o.fromNode){var p=o.fromNode,g=o.fromAnch;o.removeFromNode(),t.execute("changeEdge",{edge:o,type:"changeAnch",position:"from",oldNode:p,oldAnch:g,oldCenter:Ni({},n.oldCenter),newCenter:{x:n.shape.cx,y:n.shape.cy},mark:"anch"})}else t.execute("changeEdge",{edge:o,type:"changeAnch",position:"from",oldCenter:Ni({},n.oldCenter),newCenter:{x:n.shape.cx,y:n.shape.cy},mark:"point"});else if(o.toNode)if(o.toNode){var y=o.toNode,x=o.toAnch;o.removeToNode(),t.execute("changeEdge",{edge:o,type:"changeAnch",position:"to",oldNode:y,oldAnch:x,oldCenter:Ni({},n.oldCenter),newCenter:{x:n.shape.cx,y:n.shape.cy},mark:"anch"})}else t.execute("changeEdge",{edge:o,type:"changeAnch",position:"to",oldCenter:Ni({},n.oldCenter),newCenter:{x:n.shape.cx,y:n.shape.cy},mark:"point"});t.status="",n=null,o=null}i&&t.remove(i),t.selectFrame.ignore?t.updateNodeAnch():t.zr.trigger("selectNodes"),c=!1,s=!1,r=0,h=0}))}}]),e}(L.a.Group),Fi=zi,Gi=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"div-editable",attrs:{contenteditable:"true"},domProps:{innerHTML:t._s(t.innerText)},on:{input:t.changeText,focus:function(e){t.isChange=!1},blur:t.blurFunc}})},_i=[],Bi={name:"Edit",props:{value:{type:String,default:""}},data:function(){return{innerText:this.value,isChange:!0}},watch:{value:function(t){this.isChange&&(this.innerText=t)}},methods:{changeText:function(){this.$emit("input",this.$el.innerHTML)},blurFunc:function(){this.isChange=!0,this.$emit("blurFunc")}}},Ii=Bi,Ri=Object(w["a"])(Ii,Gi,_i,!1,null,null,null),Li=Ri.exports,$i=(i("4d63"),i("466d"),function(){var t=navigator.userAgent.toLowerCase(),e=window.opera,i={ie:/(msie\s|trident.*rv:)([\w.]+)/.test(t),opera:!!e&&e.version,webkit:t.indexOf(" applewebkit/")>-1,mac:t.indexOf("macintosh")>-1,quirks:"BackCompat"==document.compatMode};i.gecko="Gecko"==navigator.product&&!i.webkit&&!i.opera&&!i.ie;var o=0;if(i.ie){var n=t.match(/(?:msie\s([\w.]+))/),a=t.match(/(?:trident.*rv:([\w.]+))/);o=n&&a&&n[1]&&a[1]?Math.max(1*n[1],1*a[1]):n&&n[1]?1*n[1]:a&&a[1]?1*a[1]:0,i.ie11Compat=11==document.documentMode,i.ie9Compat=9==document.documentMode,i.ie8=!!document.documentMode,i.ie8Compat=8==document.documentMode,i.ie7Compat=7==o&&!document.documentMode||7==document.documentMode,i.ie6Compat=o<7||i.quirks,i.ie9above=o>8,i.ie9below=o<9}return/chrome\/(\d+\.\d)/i.test(t)&&(i.chrome=+RegExp["$1"]),/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(t)&&!/chrome/i.test(t)&&(i.safari=+(RegExp["$1"]||RegExp["$2"])),i.opera&&(o=parseFloat(e.version())),i.webkit&&(o=parseFloat(t.match(/ applewebkit\/(\d+)/)[1])),i.version=o,i.isCompatible=!i.mobile&&(i.ie&&o>=6||i.gecko&&o>=10801||i.opera&&o>=9.5||i.air&&o>=1||i.webkit&&o>=522||!1),i}),Mi=$i,Wi=function(){function t(t){for(var e in t)t[e.toUpperCase()]=t[e];return t}var e=function(t){for(var e=arguments,i=1;i<e.length;i++){var o=e[i];for(var n in o)t.hasOwnProperty(n)||(t[n]=o[n])}return t},i=t({isindex:1,fieldset:1}),o=t({input:1,button:1,select:1,textarea:1,label:1}),n=e(t({a:1}),o),a=e({iframe:1},n),s=t({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),r=t({ins:1,del:1,script:1,style:1}),h=e(t({b:1,acronym:1,bdo:1,var:1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),r),c=e(t({sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),h),l=e(t({p:1}),c),d=e(t({iframe:1}),c,o),u=t({img:1,embed:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,var:1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1}),f=e(t({a:0}),d),p=t({tr:1}),g=t({"#":1}),y=e(t({param:1}),u),x=e(t({form:1}),i,a,s,l),v=t({li:1,ol:1,ul:1}),m=t({style:1,script:1}),w=t({base:1,link:1,meta:1,title:1}),b=e(w,m),k=t({head:1,body:1}),O=t({html:1}),A=t({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1}),D=t({area:1,base:1,basefont:1,br:1,col:1,command:1,dialog:1,embed:1,hr:1,img:1,input:1,isindex:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1});return t({$nonBodyContent:e(O,k,w),$block:A,$inline:f,$inlineWithA:e(t({a:1}),f),$body:e(t({script:1,style:1}),A),$cdata:t({script:1,style:1}),$empty:D,$nonChild:t({iframe:1,textarea:1}),$listItem:t({dd:1,dt:1,li:1}),$list:t({ul:1,ol:1,dl:1}),$isNotEmpty:t({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1}),$removeEmpty:t({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,var:1}),$removeEmptyBlock:t({p:1,div:1}),$tableContent:t({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:t({pre:1,script:1,style:1,textarea:1}),html:k,head:b,style:g,script:g,body:x,base:{},link:{},meta:{},title:g,col:{},tr:t({td:1,th:1}),img:{},embed:{},colgroup:t({thead:1,col:1,tbody:1,tr:1,tfoot:1}),noscript:x,td:x,br:{},th:x,center:x,kbd:f,button:e(l,s),basefont:{},h5:f,h4:f,samp:f,h6:f,ol:v,h1:f,h3:f,option:g,h2:f,form:e(i,a,s,l),select:t({optgroup:1,option:1}),font:f,ins:f,menu:v,abbr:f,label:f,table:t({thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1}),code:f,tfoot:p,cite:f,li:x,input:{},iframe:x,strong:f,textarea:g,noframes:x,big:f,small:f,span:t({"#":1,br:1,b:1,strong:1,u:1,i:1,em:1,sub:1,sup:1,strike:1,span:1}),hr:f,dt:f,sub:f,optgroup:t({option:1}),param:{},bdo:f,var:f,div:x,object:y,sup:f,dd:x,strike:f,area:{},dir:v,map:e(t({area:1,form:1,p:1}),i,r,s),applet:y,dl:t({dt:1,dd:1}),del:f,isindex:{},fieldset:e(t({legend:1}),u),thead:p,ul:v,acronym:f,b:f,a:e(t({a:1}),d),blockquote:e(t({td:1,tr:1,tbody:1,li:1}),x),caption:f,i:f,u:f,tbody:p,s:f,address:e(a,l),tt:f,legend:f,q:f,pre:e(h,n),p:e(t({a:1}),f),em:f,dfn:f})},Ui=Wi;function Hi(t){return t?t.replace(/&((g|l|quo)t|amp|#39);/g,(function(t){return{"&lt;":"<","&amp;":"&","&quot;":'"',"&gt;":">","&#39;":"'"}[t]})):""}var qi=Mi().ie&&"6"==Mi().version?"\ufeff":"​",Ji=function(t){var e=new RegExp(qi,"g"),i=t.replace(/[\n\r]/g,"");return i=i.replace(/<(p|div)[^>]*>(<br\/?>|&nbsp;)<\/\1>/gi,"\n").replace(/<br\/?>/gi,"\n").replace(/<[^>/]+>/g,"").replace(/(\n)?<\/([^>]+)>/g,(function(t,e,i){return Ui().$block[i]?"\n":e||""})),Hi(i.replace(e,"").replace(/\u00a0/g," ").replace(/&nbsp;/g," "))},Yi=Ji,Ki={name:"Editor",components:{Edit:Li},data:function(){return{left:0,top:0,width:0,height:0,text:"",plainTxt:"",editModel:!1,icon:[],colors:"#194d33",show:!1,edge:null}},mounted:function(){var t=this,e=this;function i(t,e){var i=document.createElement("a"),o=new Blob([t]),n=window.URL.createObjectURL(o);i.href=n,i.download=e,i.click(),window.URL.revokeObjectURL(n)}function o(t){if(window.getSelection){t.focus();var e=window.getSelection();e.selectAllChildren(t),e.collapseToEnd()}else if(document.selection){var i=document.selection.createRange();i.moveToElementText(t),i.collapse(!1),i.select()}}this.editor=new Fi("flowEditor"),x.$on("leftAlign",(function(){t.editor.leftAlign()})),x.$on("rightAlign",(function(){t.editor.rightAlign()})),x.$on("horizontalAlign",(function(){t.editor.horizontalAlign()})),x.$on("verticalAlign",(function(){t.editor.verticalAlign()})),x.$on("createGroup",(function(){t.editor.createGroup()})),x.$on("redo",(function(){t.editor.redo()})),x.$on("undo",(function(){t.editor.undo()})),x.$on("undo",(function(){t.editor.undo()})),x.$on("rotate",(function(){if("selectNode"==t.status&&3===t.node.kind){t.editor.execute("deleteNode",{node:t.node}),void 0===t.node.x&&(t.node.x=t.node.position[0],t.node.y=t.node.position[1]);var e=t.node.safe;"0"===t.node.face?t.node.face="1":"1"===t.node.face?t.node.face="2":"2"===t.node.face?t.node.face="3":"3"===t.node.face&&(t.node.face="0");var i=[e.left,e.up,e.right,e.down];e.up=i[0],e.right=i[1],e.down=i[2],e.left=i[3];var o=t.node.shape.width;t.node.shape.width=t.node.shape.height,t.node.shape.height=o,t.editor.execute("addShape",t.node),x.$emit("clearSelect")}})),x.$on("initFlow",(function(e){try{t.editor.clearHistory(),t.editor.refreshHistory(),t.editor.init(e.data),x.$emit("refreshMap",{editor:t.editor})}catch(e){window.console.log(e),alert("不支持的数据")}})),x.$on("copy",(function(){t.editStatus||("selectNode"==t.status||"selectNodes"==t.status?t.editor.copy("node",t.editor.getSelectNodes()):"selectGroup"==t.status&&t.editor.copy("group",t.group))})),x.$on("delete",(function(){"selectNode"==t.status?t.editor.execute("deleteNode",{node:t.node}):"selectNodes"==t.status?t.editor.execute("deleteNodes",{nodes:t.nodes}):"selectGroup"==t.status?t.editor.execute("deleteGroup",{group:t.group}):"selectEdge"==t.status&&t.editor.execute("deleteEdge",{edge:t.edge})})),x.$on("deleteAll",(function(){t.editor.execute("deleteAll",{node:t.node})})),x.$on("saveData",(function(e){var o=null,n=null;switch(e.type){case"json":var a=JSON.stringify(t.editor._());i(a,"flowchart.json");break;case"png":o={x:0,y:0,width:800,height:800},document.getElementById("download-canvas").style.width=o.width+"px",document.getElementById("download-canvas").style.height=o.height+"px",n=new Fi("download-canvas"),n.init(JSON.parse(JSON.stringify(t.editor.getData())),!0),n.attr({position:[-parseInt(o.x),-parseInt(o.y)]});try{n.zr.painter.getRenderedCanvas({backgroundColor:"transparent"}).toBlob((function(t){var e=window.URL.createObjectURL(t);window.console.log(e),window.open(e)}),"image/png")}catch(e){document.getElementById("download-win").style.display="block"}break;case"jpg":o=t.editor.getBoundingRect(t.editor.nodes.concat(t.editor.groups).concat(t.editor.edges)),document.getElementById("download-canvas").style.width=o.width+"px",document.getElementById("download-canvas").style.height=o.height+"px",n=new Fi("download-canvas"),n.init(JSON.parse(JSON.stringify(t.editor.getData())),!0),n.attr({position:[-o.x,-o.y]});try{n.zr.painter.getRenderedCanvas({backgroundColor:"#fff"}).toBlob((function(t){var e=window.URL.createObjectURL(t);window.open(e)}),"image/jpeg")}catch(e){document.getElementById("download-win").style.display="block"}break}})),x.$on("changeNode",(function(e){var i=e.nodes||t.editor.getSelectNodes();t.editor.execute("changeNode",e,i)})),x.$on("align",(function(e){t.editor[e.align]&&t.editor[e.align]()})),x.$on("changeGroup",(function(e){t.editor.execute("changeGroup",e)})),x.$on("changeEdge",(function(e){t.editor.execute("changeEdge",e)})),x.$on("ungroup",(function(){t.editStatus||"selectGroup"==t.status&&t.editor.execute("ungroup",{group:t.group})})),x.$on("selectFrame",(function(){t.editor.emit("selectFrame")})),x.$on("shadow",(function(e){var i=e.shadow;i?t.editor.setShadow():t.editor.cancelShadow()})),this.editor.listen("selectNode",(function(t){e.status="selectNode",e.node=t.node,x.$emit("selectNode",{node:t.node}),2!==t.node.kind&&3!==t.node.kind||e.editor.checkObstaceDistance(t.node)})),this.editor.listen("selectNodes",(function(i){if(i&&i.nodes.length>1)e.status="selectNodes",e.nodes=i.nodes,x.$emit("selectNodes",{nodes:i.nodes});else{var o=t.editor.getSelectNodes();1==o.length?(e.status="selectNode",e.node=o[0],x.$emit("selectNode",{node:o[0]})):o.length>1&&(e.status="selectNodes",e.nodes=o,x.$emit("selectNodes",{nodes:o}))}})),this.editor.listen("selectGroup",(function(t){e.status="selectGroup",e.group=t.group,x.$emit("selectGroup",t)})),this.editor.listen("selectEdge",(function(i){e.status="selectEdge",t.editor.status="selectEdge",e.edge=i.edge,x.$emit("selectEdge",i)})),this.editor.listen("undoredo",(function(e){x.$emit("undoredo",e),x.$emit("refreshMap",{editor:t.editor})})),this.editor.listen("clearSelectItems",(function(){x.$emit("clearSelect"),t.editor.execute("clearOBAlert",t.node)})),this.editor.listen("edit",(function(i){e.editStatus=i.status;var n=new L.a.Group,a=null,s=i.text,r=null;switch(e.editModel=!0,i.status){case"editNode":e.node=i.node,a=n.getBoundingRect([t.node]),e.left=a.x+t.editor.position[0],e.top=a.y+t.editor.position[1],e.width=a.width,e.height=a.height,e.text=e.domText(s),s="";break;case"editGroup":e.editGroup=i.group,a=n.getBoundingRect([e.group.groupHead]),r=n.getBoundingRect([e.group]),e.left=r.x+t.editor.position[0],e.top=r.y+t.editor.position[1],e.width=a.width,e.height=a.height,e.text=e.domText(s),s="";break;case"editEdge":e.edge=i.edge;var h=i.edge.getData();if(h.text)a=n.getBoundingRect([i.edge.relateText]),e.left=a.x+t.editor.position[0],e.top=a.y+t.editor.position[1],e.width=a.width,e.height=a.height,e.text=e.domText(h.text);else{var c=h.cpx;e.left=c.x1+t.editor.position[0],e.top=c.y1+t.editor.position[1],e.width=80,e.height=20}break}e.$nextTick((function(){o(e.$refs["edit"].$el)}))}))},methods:{dragover:function(t){t.preventDefault()},dragstart:function(t){t.preventDefault()},drop:function(t){var e,i,o=t.dataTransfer.getData("addShape");t.offsetX?(e=parseInt(t.offsetX)+.5,i=parseInt(t.offsetY)+.5):(e=parseInt(t.pageX)+.5-140,i=parseInt(t.pageY)+.5-50);try{var n=JSON.parse(o);n["x"]=e,n["y"]=i,this.editor.addShape(n)}catch(a){}},trim:function(t){return t.replace(/^\s+|\s+$/gm,"")},updateText:function(){var t=Yi(this.text);this.plainTxt=this.trim(t),"editNode"==this.editStatus&&x.$emit("changeNode",{style:{text:this.trim(t)},nodes:[this.node]}),"editGroup"==this.editStatus&&x.$emit("changeGroup",{mark:"head",style:{text:this.trim(t)},group:this.editGroup}),"editEdge"==this.editStatus&&x.$emit("changeEdge",{mark:"text",style:{text:this.trim(t)},edge:this.edge}),this.editModel=!1,this.editStatus="",this.text="",this.plainTxt=""},domText:function(t){var e=[],i=t.split("\n");return i.forEach((function(t){e.push("<div>"+t+"</div>")})),e.join("")},closeDownLoadWin:function(){document.getElementById("download-win").style.display="none"}}},Qi=Ki,Xi=(i("ae26"),Object(w["a"])(Qi,j,E,!1,null,"40db7b8e",null)),Vi=Xi.exports,Zi=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"property"},[i("v-canvas",{directives:[{name:"show",rawName:"v-show",value:t.showCanvas,expression:"showCanvas"}]}),i("Node",{directives:[{name:"show",rawName:"v-show",value:t.showNode,expression:"showNode"}]}),i("Group",{directives:[{name:"show",rawName:"v-show",value:t.showGroup,expression:"showGroup"}]}),i("Edge",{directives:[{name:"show",rawName:"v-show",value:t.showEdge,expression:"showEdge"}]})],1)},to=[],eo=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"node",on:{click:function(e){return t.hideWin(e)}}},[i("div",{staticClass:"node-header"},[t._v(" "+t._s(t.text)+" ")]),i("div",{staticClass:"section-group clearfix"},[i("h3",[t._v(t._s(t.$t("node.head")))]),i("p",[i("span",[t._v(t._s(t.$t("node.fill")))]),i("span",{staticClass:"color-picker",style:{background:t.nodeData.style.fill},on:{click:function(e){return e.stopPropagation(),t.showColorPicker("fill")}}}),i("Sketch-picker",{directives:[{name:"show",rawName:"v-show",value:t.nodeData.fillshow,expression:"nodeData.fillshow"}],on:{input:t.updateFill},model:{value:t.nodeData.style.fill,callback:function(e){t.$set(t.nodeData.style,"fill",e)},expression:"nodeData.style.fill"}})],1),i("p",[i("span",[t._v(t._s(t.$t("node.stroke")))]),i("span",{staticClass:"color-picker",style:{background:t.nodeData.style.stroke},on:{click:function(e){return e.stopPropagation(),t.showColorPicker("stroke")}}}),i("Sketch-picker",{directives:[{name:"show",rawName:"v-show",value:t.nodeData.strokeshow,expression:"nodeData.strokeshow"}],on:{input:t.updateStroke},model:{value:t.nodeData.style.stroke,callback:function(e){t.$set(t.nodeData.style,"stroke",e)},expression:"nodeData.style.stroke"}})],1)]),i("div",{staticClass:"section-group clearfix"},[i("h3",[t._v(t._s(t.$t("node.font")))]),i("p",[i("span",[t._v(t._s(t.$t("node.fontSize")))]),i("span",{staticClass:"font-size right color-picker",on:{click:function(e){return e.stopPropagation(),t.showColorPicker("fontsize")}}},[t._v(t._s(t.nodeData.style.fontSize))]),i("ul",{directives:[{name:"show",rawName:"v-show",value:t.nodeData.fontsizeshow,expression:"nodeData.fontsizeshow"}],staticClass:"font-size-select"},t._l(t.fontsize,(function(e){return i("li",{key:e,on:{click:function(i){return t.pickFontSize(e)}}},[t._v(t._s(e))])})),0)]),i("p",[i("span",[t._v(t._s(t.$t("node.textFill")))]),i("span",{staticClass:"color-picker",style:{background:t.nodeData.style.textFill},on:{click:function(e){return e.stopPropagation(),t.showColorPicker("textFill")}}}),i("Sketch-picker",{directives:[{name:"show",rawName:"v-show",value:t.nodeData.textfillshow,expression:"nodeData.textfillshow"}],on:{input:t.updateTextFill},model:{value:t.nodeData.style.textFill,callback:function(e){t.$set(t.nodeData.style,"textFill",e)},expression:"nodeData.style.textFill"}})],1),i("p",[i("span",{staticClass:"left"},[t._v(t._s(t.$t("node.fontStyle")))]),i("span",{class:"textPos right iconfont icon-qingxie"+("italic"==t.nodeData.style.fontStyle?" active":""),on:{click:function(e){return t.setStyle(e)}}}),i("span",{class:"textPos right iconfont icon-jiacu"+("bold"==t.nodeData.style.fontWeight?" active":""),on:{click:function(e){return t.setBold(e)}}})]),i("p",[i("span",{staticClass:"left"},[t._v(t._s(t.$t("node.position")))]),i("span",{class:"textPos right iconfont icon-you"+("left"==t.nodeData.style.textPosition?" active":""),staticStyle:{transform:"rotate(180deg)"},on:{click:function(e){return t.setTextPos(e,"left")}}}),i("span",{class:"textPos right iconfont icon-arrow-down-last"+("bottom"==t.nodeData.style.textPosition?" active":""),on:{click:function(e){return t.setTextPos(e,"bottom")}}}),i("span",{class:"textPos right iconfont icon-you"+("right"==t.nodeData.style.textPosition?" active":""),on:{click:function(e){return t.setTextPos(e,"right")}}}),i("span",{class:"textPos right iconfont icon-arrow-down-last"+("top"==t.nodeData.style.textPosition?" active":""),staticStyle:{transform:"rotate(180deg)"},on:{click:function(e){return t.setTextPos(e,"top")}}}),i("span",{class:"textPos right iconfont icon-juzhong"+("inside"==t.nodeData.style.textPosition?" active":""),on:{click:function(e){return t.setTextPos(e,"inside")}}})])]),t.multipleSelect?i("div",{staticClass:"section-group clearfix"},[i("h3",[t._v(t._s(t.$t("node.nodeAlign")))]),i("ul",[i("li",{staticClass:"iconfont icon-halign",on:{click:function(e){return t.align("horizontalAlign")}}}),i("li",{staticClass:"iconfont icon-juzhongduiqi",on:{click:function(e){return t.align("verticalAlign")}}}),i("li",{staticClass:"iconfont icon-align-left",on:{click:function(e){return t.align("leftAlign")}}}),i("li",{staticClass:"iconfont icon-youduiqi",on:{click:function(e){return t.align("rightAlign")}}})])]):t._e(),i("div",{staticClass:"section-group clearfix"},[i("h3",[t._v(t._s(t.$t("node.prefabrication")))]),i("ul",{staticClass:"theme"},t._l(t.preStyle,(function(e,o){return i("li",{key:o,staticClass:"theme-item",style:{background:e.fill,"border-color":e.stroke},on:{click:function(i){return t.changeNodeStyle(e)}}})})),0)])])},io=[],oo=i("c345"),no={node:[{fill:"rgb(231,253,250)",stroke:"rgb(149, 231, 226)",textFill:"#333"},{fill:"#e7f7fe",stroke:"#b2defe",textFill:"#333"},{fill:"#fef7e7",stroke:"#fedcab",textFill:"#333"},{fill:"#f8f0fe",stroke:"#d7bdf4",textFill:"#333"},{fill:"rgb(255, 218, 218)",stroke:"rgb(247, 155, 155)",textFill:"#333"},{fill:"#fbfbca",stroke:"#f7f71c",textFill:"#333"},{fill:"#7EA6E0",stroke:"#333",textFill:"#333"},{fill:"#FFCE9F",stroke:"#333",textFill:"#333"},{fill:"#A9C4EB",stroke:"#333",textFill:"#333"},{fill:"#DFEFCA",stroke:"#333",textFill:"#333"},{fill:"#D1F5FF",stroke:"#333",textFill:"#333"},{fill:"#D4AEF9",stroke:"#333",textFill:"#333"},{fill:"#80beaf",stroke:"#333",textFill:"#333"},{fill:"#b3ddd1",stroke:"#333",textFill:"#333"},{fill:"#d1dce2",stroke:"#333",textFill:"#333"},{fill:"#f58994",stroke:"#333",textFill:"#333"},{fill:"#ee9c6c",stroke:"#333",textFill:"#333"},{fill:"#86e3ce",stroke:"#333",textFill:"#333"},{fill:"#d0e6a5",stroke:"#333",textFill:"#333"},{fill:"#ffdd94",stroke:"#333",textFill:"#333"},{fill:"#fa897b",stroke:"#333",textFill:"#333"},{fill:"#ccabd8",stroke:"#333",textFill:"#333"},{fill:"#60efdb",stroke:"#333",textFill:"#333"},{fill:"#bef2e5",stroke:"#333",textFill:"#333"},{fill:"#c5e7f1",stroke:"#333",textFill:"#333"},{fill:"#79ceed",stroke:"#333",textFill:"#333"},{fill:"#6f89a2",stroke:"#333",textFill:"#333"},{fill:"#dea3dc",stroke:"#333",textFill:"#333"},{fill:"#f7db70",stroke:"#333",textFill:"#333"},{fill:"#eabebf",stroke:"#333",textFill:"#333"},{fill:"#75cce8",stroke:"#333",textFill:"#333"},{fill:"#a5dee5",stroke:"#333",textFill:"#333"},{fill:"#5d7599",stroke:"#333",textFill:"#333"},{fill:"#abb6c8",stroke:"#333",textFill:"#333"},{fill:"#dadada",stroke:"#333",textFill:"#333"},{fill:"#f7f0c6",stroke:"#333",textFill:"#333"},{fill:"#c2c4b6",stroke:"#333",textFill:"#333"},{fill:"#478ba2",stroke:"#333",textFill:"#333"},{fill:"#de5b6d",stroke:"#333",textFill:"#333"},{fill:"#e9765b",stroke:"#333",textFill:"#333"},{fill:"#f2a490",stroke:"#333",textFill:"#333"},{fill:"#b9d4db",stroke:"#333",textFill:"#333"}],group:[{headStyle:{fill:"#F1ECAA",stroke:"#333",textFill:"#333",textPosition:"insideLeft",fontSize:14,fontStyle:"normal",fontWeight:"normal"},groupStyle:{fill:"#F0BABA",stroke:"#333"}},{headStyle:{fill:"#FD9973",stroke:"#333",textFill:"#333",textPosition:"insideLeft",fontSize:14,fontStyle:"normal",fontWeight:"normal"},groupStyle:{fill:"#5AC39D",stroke:"#333"}},{headStyle:{fill:"#5AB978",stroke:"#333",textFill:"#333",textPosition:"insideLeft",fontSize:14,fontStyle:"normal",fontWeight:"normal"},groupStyle:{fill:"#DD727F",stroke:"#333"}}]},ao=no;function so(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,o)}return i}function ro(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?so(Object(i),!0).forEach((function(e){Object(N["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):so(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var ho={name:"Node",components:{"Sketch-picker":oo["Sketch"]},data:function(){return{text:"Single Node",multipleSelect:!1,fontsize:[8,10,12,14,16,18,20,24,28,32,36,40],nodeData:{fillshow:!1,strokeshow:!1,textfillshow:!1,fontsizeshow:!1,style:{fill:"#fff",stroke:"transparent",textFill:"transparent",text:"",lineWidth:1,opacity:1,fontSize:12,fontWeight:"normal",fontStyle:"italic",textPosition:"inside"},shape:{},z:10},preStyle:ao.node}},mounted:function(){var t=this;x.$on("selectNode",(function(e){t.text="Single Node",t.multipleSelect=!1,t.node=e.node;var i=t.node.getData();t.nodeData=ro({},t.nodeData,{},i)})),x.$on("selectNodes",(function(e){t.text="Multiple Node",t.multipleSelect=!0,t.nodes=e.nodes})),x.$on("changeLanguage",(function(t){c(t.language)})),this.language=localStorage.getItem("localeLanguage")||"zh",c(this.language)},methods:{align:function(t){x.$emit("align",{align:t})},showColorPicker:function(t){switch(t){case"fill":this.nodeData.strokeshow=!1,this.nodeData.textfillshow=!1,this.nodeData.fontsizeshow=!1,this.nodeData.fillshow?this.nodeData.fillshow=!1:this.nodeData.fillshow=!0;break;case"stroke":this.nodeData.fillshow=!1,this.nodeData.textfillshow=!1,this.nodeData.fontsizeshow=!1,this.nodeData.strokeshow?this.nodeData.strokeshow=!1:this.nodeData.strokeshow=!0;break;case"textFill":this.nodeData.fillshow=!1,this.nodeData.strokeshow=!1,this.nodeData.fontsizeshow=!1,this.nodeData.textfillshow?this.nodeData.textfillshow=!1:this.nodeData.textfillshow=!0;break;case"fontsize":this.nodeData.fillshow=!1,this.nodeData.strokeshow=!1,this.nodeData.textfillshow=!1,this.nodeData.fontsizeshow?this.nodeData.fontsizeshow=!1:this.nodeData.fontsizeshow=!0;break}},updateFill:function(t){var e=t.rgba,i="rgba(".concat(e.r,",").concat(e.g,",").concat(e.b,",").concat(e.a,")");this.nodeData.style.fill=i,x.$emit("changeNode",{style:{fill:i}})},updateStroke:function(t){var e=t.rgba,i="rgb(".concat(e.r,",").concat(e.g,",").concat(e.b,")");this.nodeData.style.stroke=i,x.$emit("changeNode",{style:{stroke:i}})},updateTextFill:function(t){var e=t.rgba,i="rgb(".concat(e.r,",").concat(e.g,",").concat(e.b,")");this.nodeData.style.textFill=i,x.$emit("changeNode",{style:{textFill:i}})},setStyle:function(){"italic"==this.nodeData.style.fontStyle?(this.nodeData.style.fontStyle="",x.$emit("changeNode",{style:{fontStyle:""}})):(this.nodeData.style.fontStyle="italic",x.$emit("changeNode",{style:{fontStyle:"italic"}}))},setBold:function(){"bold"==this.nodeData.style.fontWeight?(this.nodeData.style.fontWeight="",x.$emit("changeNode",{style:{fontWeight:""}})):(this.nodeData.style.fontWeight="bold",x.$emit("changeNode",{style:{fontWeight:"bold"}}))},pickFontSize:function(t){this.nodeData.style.fontSize!=t&&(this.nodeData.style.fontSize=t,x.$emit("changeNode",{style:{fontSize:t}}))},setTextPos:function(t,e){this.nodeData.style.textPosition!=e&&(this.nodeData.style.textPosition=e,x.$emit("changeNode",{style:{textPosition:e}}))},changeNodeStyle:function(t){this.nodeData.style.fill=t.fill,this.nodeData.style.stroke=t.stroke,this.nodeData.style.fontSize=t.fontSize;var e=ro({},{},{},t);x.$emit("changeNode",{style:e,z:this.nodeData.z})},hideColorPicker:function(){this.nodeData.fillshow=!1,this.nodeData.strokeshow=!1,this.nodeData.textfillshow=!1,this.nodeData.fontsizeshow=!1},hideWin:function(t){var e=t.target,i=!1;while(e){if(1==e.nodeType&&e&&e.className&&e.className.indexOf("vc-sketch")>-1){i=!0;break}e=e.parentElement}i||this.hideColorPicker()}}},co=ho,lo=(i("8dc2"),Object(w["a"])(co,eo,io,!1,null,"1af651cb",null)),uo=lo.exports,fo=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"group",on:{click:t.hideWin}},[i("div",{staticClass:"node-header"},[t._v(" "+t._s(t.text)+" ")]),i("div",{staticClass:"section-group clearfix"},[i("h3",[t._v(t._s(t.$t("group.head")))]),i("p",[i("span",[t._v(t._s(t.$t("group.fill")))]),i("span",{staticClass:"color-picker",style:{background:t.groupData.groupFill},on:{click:function(e){return e.stopPropagation(),t.showColorPicker("groupfill")}}}),i("Sketch-picker",{directives:[{name:"show",rawName:"v-show",value:t.groupData.groupfillshow,expression:"groupData.groupfillshow"}],on:{input:t.updateFill},model:{value:t.groupData.groupFill,callback:function(e){t.$set(t.groupData,"groupFill",e)},expression:"groupData.groupFill"}})],1),i("p",[i("span",[t._v(t._s(t.$t("group.stroke")))]),i("span",{staticClass:"color-picker",style:{background:t.groupData.stroke},on:{click:function(e){return e.stopPropagation(),t.showColorPicker("stroke")}}}),i("Sketch-picker",{directives:[{name:"show",rawName:"v-show",value:t.groupData.strokeshow,expression:"groupData.strokeshow"}],on:{input:t.updateStroke},model:{value:t.groupData.stroke,callback:function(e){t.$set(t.groupData,"stroke",e)},expression:"groupData.stroke"}})],1),i("p",{staticStyle:{"line-height":"20px","margin-top":"6px"}},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.groupData.showHead,expression:"groupData.showHead"}],staticClass:"magic-checkbox",attrs:{type:"checkbox",id:"showhead",name:"checkbox"},domProps:{checked:Array.isArray(t.groupData.showHead)?t._i(t.groupData.showHead,null)>-1:t.groupData.showHead},on:{change:function(e){var i=t.groupData.showHead,o=e.target,n=!!o.checked;if(Array.isArray(i)){var a=null,s=t._i(i,a);o.checked?s<0&&t.$set(t.groupData,"showHead",i.concat([a])):s>-1&&t.$set(t.groupData,"showHead",i.slice(0,s).concat(i.slice(s+1)))}else t.$set(t.groupData,"showHead",n)}}}),i("label",{attrs:{for:"showhead"}},[t._v(t._s(t.$t("group.showHead")))])])]),i("div",{staticClass:"section-group clearfix"},[i("h3",[t._v(t._s(t.$t("group.font")))]),i("p",[i("span",[t._v(t._s(t.$t("group.fontSize")))]),i("span",{staticClass:"font-size right color-picker",on:{click:function(e){return e.stopPropagation(),t.showColorPicker("fontsize")}}},[t._v(t._s(t.groupData.fontSize))]),i("ul",{directives:[{name:"show",rawName:"v-show",value:t.groupData.fontsizeshow,expression:"groupData.fontsizeshow"}],staticClass:"font-size-select"},t._l(t.fontsize,(function(e){return i("li",{key:e,on:{click:function(i){return t.pickFontSize(e)}}},[t._v(t._s(e))])})),0)]),i("p",[i("span",[t._v(t._s(t.$t("group.textFill")))]),i("span",{staticClass:"color-picker",style:{background:t.groupData.textFill},on:{click:function(e){return e.stopPropagation(),t.showColorPicker("textfill")}}}),i("Sketch-picker",{directives:[{name:"show",rawName:"v-show",value:t.groupData.textfillshow,expression:"groupData.textfillshow"}],on:{input:t.updateTextFill},model:{value:t.groupData.textFill,callback:function(e){t.$set(t.groupData,"textFill",e)},expression:"groupData.textFill"}})],1),i("p",[i("span",{staticClass:"left"},[t._v(t._s(t.$t("group.fontStyle")))]),i("span",{class:"textPos right iconfont icon-qingxie"+("italic"==t.groupData.fontStyle?" active":""),on:{click:function(e){return t.setStyle(e)}}}),i("span",{class:"textPos right iconfont icon-jiacu"+("bold"==t.groupData.fontWeight?" active":""),on:{click:function(e){return t.setBold(e)}}})]),i("p",[i("span",[t._v(t._s(t.$t("group.fill")))]),i("span",{staticClass:"color-picker",style:{background:t.groupData.fill},on:{click:function(e){return e.stopPropagation(),t.showColorPicker("fill")}}}),i("Sketch-picker",{directives:[{name:"show",rawName:"v-show",value:t.groupData.fillshow,expression:"groupData.fillshow"}],on:{input:t.updateHeadFill},model:{value:t.groupData.fill,callback:function(e){t.$set(t.groupData,"fill",e)},expression:"groupData.fill"}})],1),i("p",[i("span",{staticClass:"left"},[t._v(t._s(t.$t("group.align")))]),i("span",{class:"textPos right iconfont icon-juyou"+("insideRight"==t.groupData.textPosition?" active":""),on:{click:function(e){return t.setTextPos(e,"insideRight")}}}),i("span",{class:"textPos right iconfont icon-juzhong1"+("inside"==t.groupData.textPosition?" active":""),on:{click:function(e){return t.setTextPos(e,"inside")}}}),i("span",{class:"textPos right iconfont icon-juzuo"+("insideLeft"==t.groupData.textPosition?" active":""),on:{click:function(e){return t.setTextPos(e,"insideLeft")}}})])])])},po=[];function go(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,o)}return i}function yo(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?go(Object(i),!0).forEach((function(e){Object(N["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):go(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var xo={name:"Group",components:{"Sketch-picker":oo["Sketch"]},data:function(){return{text:"Group",fontsize:[12,14,16,18,20,24,28,32,36,40],groupData:{fillshow:!1,strokeshow:!1,textfillshow:!1,fontsizeshow:!1,groupfillshow:!1,showHead:!0,groupFill:"",stroke:"",fill:"",textAlign:"left",fontSize:14,fontStyle:"",fontWeight:"",textFill:""},theme:ao.group}},watch:{"groupData.showHead":{handler:function(t){x.$emit("changeGroup",{mark:"showHead",showHead:t,group:this.group})}}},mounted:function(){var t=this;x.$on("selectGroup",(function(e){var i=e&&e.group;if(i){var o=i.getStyle();t.groupData=yo({},t.groupData,{},o),t.group=i}})),x.$on("changeLanguage",(function(t){c(t.language)})),this.language=localStorage.getItem("localeLanguage")||"zh",c(this.language)},methods:{align:function(t){x.$emit("align",{align:t})},showColorPicker:function(t){switch(t){case"groupfill":this.groupData.strokeshow=!1,this.groupData.textfillshow=!1,this.groupData.fontsizeshow=!1,this.groupData.fillshow=!1,this.groupData.groupfillshow?this.groupData.groupfillshow=!1:this.groupData.groupfillshow=!0;break;case"stroke":this.groupData.fillshow=!1,this.groupData.textfillshow=!1,this.groupData.fontsizeshow=!1,this.groupData.groupfillshow=!1,this.groupData.strokeshow?this.groupData.strokeshow=!1:this.groupData.strokeshow=!0;break;case"textfill":this.groupData.fillshow=!1,this.groupData.strokeshow=!1,this.groupData.fontsizeshow=!1,this.groupData.groupfillshow=!1,this.groupData.textfillshow?this.groupData.textfillshow=!1:this.groupData.textfillshow=!0;break;case"fontsize":this.groupData.fillshow=!1,this.groupData.strokeshow=!1,this.groupData.textfillshow=!1,this.groupData.groupfillshow=!1,this.groupData.fontsizeshow?this.groupData.fontsizeshow=!1:this.groupData.fontsizeshow=!0;break;case"fill":this.groupData.groupfillshow=!1,this.groupData.strokeshow=!1,this.groupData.textfillshow=!1,this.groupData.fontsizeshow=!1,this.groupData.fillshow?this.groupData.fillshow=!1:this.groupData.fillshow=!0;break}},getRgba:function(t){var e=t.rgba,i="rgba(".concat(e.r,",").concat(e.g,",").concat(e.b,",").concat(e.a,")");return i},updateFill:function(t){var e=this.getRgba(t);this.groupData.groupFill=e,x.$emit("changeGroup",{mark:"group",style:{fill:e},group:this.group})},updateStroke:function(t){var e=this.getRgba(t);this.groupData.stroke=e,x.$emit("changeGroup",{mark:"group",style:{stroke:e},group:this.group})},updateTextFill:function(t){var e=this.getRgba(t);this.groupData.textFill=e,x.$emit("changeGroup",{mark:"head",style:{textFill:e},group:this.group})},updateHeadFill:function(t){var e=this.getRgba(t);this.groupData.fill=e,x.$emit("changeGroup",{mark:"head",style:{fill:e},group:this.group})},setStyle:function(){"italic"==this.groupData.fontStyle?(this.groupData.fontStyle="",x.$emit("changeGroup",{mark:"head",style:{fontStyle:""},group:this.group})):(this.groupData.fontStyle="italic",x.$emit("changeGroup",{mark:"head",style:{fontStyle:"italic"},group:this.group}))},setBold:function(){"bold"==this.groupData.fontWeight?(this.groupData.fontWeight="",x.$emit("changeGroup",{mark:"head",style:{fontWeight:""},group:this.group})):(this.groupData.fontWeight="bold",x.$emit("changeGroup",{mark:"head",style:{fontWeight:"bold"},group:this.group}))},pickFontSize:function(t){this.groupData.fontSize!=t&&(this.groupData.fontSize=t,x.$emit("changeGroup",{mark:"head",style:{fontSize:t},group:this.group}))},setTextPos:function(t,e){this.groupData.textPosition!=e&&(this.groupData.textPosition=e,x.$emit("changeGroup",{mark:"head",style:{textPosition:e},group:this.group}))},hideColorPicker:function(){this.groupData.fillshow=!1,this.groupData.strokeshow=!1,this.groupData.textfillshow=!1,this.groupData.fontsizeshow=!1,this.groupData.groupfillshow=!1},hideWin:function(t){var e=t.target,i=!1;while(e){if(1==e.nodeType&&e&&e.className&&e.className.indexOf("vc-sketch")>-1){i=!0;break}e=e.parentElement}i||this.hideColorPicker()}}},vo=xo,mo=(i("9168"),Object(w["a"])(vo,fo,po,!1,null,"6edfa479",null)),wo=mo.exports,bo=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},ko=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"canvas",staticStyle:{display:"none"}},[i("div",{staticClass:"node-header"},[t._v("Canvas")]),i("div",{staticClass:"section-group"})])}],Oo={name:"Canvas",data:function(){return{shadow:!1}},mounted:function(){},methods:{changeShadow:function(){this.shadow=!this.shadow,x.$emit("shadow",{shadow:this.shadow})}}},Ao=Oo,Do=(i("7269"),Object(w["a"])(Ao,bo,ko,!1,null,"884dae7c",null)),Po=Do.exports,So=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"edge",on:{click:t.hideWin}},[i("div",{staticClass:"node-header"},[t._v("Relate Link")]),i("div",{staticClass:"section-group"},[i("h3",[t._v(t._s(t.$t("edge.head")))]),i("p",[i("span",[t._v(t._s(t.$t("edge.stroke")))]),i("span",{staticClass:"color-picker",style:{background:t.edgeData.stroke},on:{click:function(e){return e.stopPropagation(),t.showColorPicker("stroke")}}}),i("Sketch-picker",{directives:[{name:"show",rawName:"v-show",value:t.edgeData.strokeshow,expression:"edgeData.strokeshow"}],on:{input:t.updateStroke},model:{value:t.edgeData.stroke,callback:function(e){t.$set(t.edgeData,"stroke",e)},expression:"edgeData.stroke"}})],1),i("p",[i("span",[t._v(t._s(t.$t("edge.lineDash")))]),t._l(t.lineDash,(function(e,o){return i("span",{key:o,class:"iconfont right lineType lineDash "+e.icon+(t.edgeData.lineDashType==e.name?" active":""),on:{click:function(i){return i.stopPropagation(),t.changeLineDash(e.name)}}})}))],2),i("p",[i("span",[t._v(t._s(t.$t("edge.lineStyle")))]),i("span",{class:"iconfont icon-quxianjiantou right lineType"+("bs"==t.edgeData.type?" active":""),on:{click:function(e){return e.stopPropagation(),t.changeLineType("bs")}}}),i("span",{class:"iconfont icon-zhexianjiantou right lineType"+("polyline"==t.edgeData.type?" active":""),on:{click:function(e){return e.stopPropagation(),t.changeLineType("polyline")}}}),i("span",{class:"iconfont icon-zhixianjiantou right lineType"+("line"==t.edgeData.type?" active":""),on:{click:function(e){return e.stopPropagation(),t.changeLineType("line")}}})]),i("p",{directives:[{name:"show",rawName:"v-show",value:"polyline"==t.edgeData.type,expression:"edgeData.type=='polyline'"}]},[i("span",[t._v(t._s(t.$t("edge.turningDistance")))]),i("span",{staticClass:"font-size right color-picker",on:{click:function(e){return e.stopPropagation(),t.showColorPicker("ext")}}},[t._v(t._s(t.edgeData.ext))]),i("ul",{directives:[{name:"show",rawName:"v-show",value:t.edgeData.extshow,expression:"edgeData.extshow"}],staticClass:"ext-select"},t._l(t.exts,(function(e){return i("li",{key:e,on:{click:function(i){return t.pickExt(e)}}},[t._v(t._s(e))])})),0)])]),i("div",{staticClass:"section-group"},[i("h3",[t._v(t._s(t.$t("edge.font")))]),i("p",[i("span",[t._v(t._s(t.$t("edge.fontSize")))]),i("span",{staticClass:"font-size right color-picker",on:{click:function(e){return e.stopPropagation(),t.showColorPicker("fontsize")}}},[t._v(t._s(t.edgeData.fontSize))]),i("ul",{directives:[{name:"show",rawName:"v-show",value:t.edgeData.fontsizeshow,expression:"edgeData.fontsizeshow"}],staticClass:"font-size-select"},t._l(t.fontsize,(function(e){return i("li",{key:e,on:{click:function(i){return t.pickFontSize(e)}}},[t._v(t._s(e))])})),0)]),i("p",[i("span",[t._v(t._s(t.$t("edge.textFill")))]),i("span",{staticClass:"color-picker",style:{background:t.edgeData.textFill},on:{click:function(e){return e.stopPropagation(),t.showColorPicker("textFill")}}}),i("Sketch-picker",{directives:[{name:"show",rawName:"v-show",value:t.edgeData.textfillshow,expression:"edgeData.textfillshow"}],on:{input:t.updateTextFill},model:{value:t.edgeData.textFill,callback:function(e){t.$set(t.edgeData,"textFill",e)},expression:"edgeData.textFill"}})],1),i("p",[i("span",{staticClass:"left"},[t._v(t._s(t.$t("edge.fontStyle")))]),i("span",{class:"textPos right iconfont icon-qingxie"+("italic"==t.edgeData.fontStyle?" active":""),on:{click:function(e){return t.setStyle(e)}}}),i("span",{class:"textPos right iconfont icon-jiacu"+("bold"==t.edgeData.fontWeight?" active":""),on:{click:function(e){return t.setBold(e)}}})]),i("p",[i("span",[t._v(t._s(t.$t("edge.fill")))]),i("span",{staticClass:"color-picker",style:{background:t.edgeData.fill},on:{click:function(e){return e.stopPropagation(),t.showColorPicker("fill")}}}),i("Sketch-picker",{directives:[{name:"show",rawName:"v-show",value:t.edgeData.fillshow,expression:"edgeData.fillshow"}],on:{input:t.updateFill},model:{value:t.edgeData.fill,callback:function(e){t.$set(t.edgeData,"fill",e)},expression:"edgeData.fill"}})],1)])])},To=[];function Co(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,o)}return i}function jo(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Co(Object(i),!0).forEach((function(e){Object(N["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Co(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var Eo={name:"Edge",components:{"Sketch-picker":oo["Sketch"]},data:function(){return{fontsize:[12,14,16,18,20,24,28,32,36,40],exts:[20,30,40,50,60,70,80,90,100,120,140,160,180,200,240,280,320,400,460,520,600,700,800,900,1e3],lineDash:[{dash:[6,2,2,2],name:"dashed",icon:"icon-line1"},{dash:[4,2],name:"dash",icon:"icon-line-dashed"},{dash:[1,1],name:"dott",icon:"icon-linedotted"},{dash:[0],name:"solid",icon:"icon-line"}],edgeData:{strokeshow:!1,fillshow:!1,textfillshow:!1,fontsizeshow:!1,extshow:!1,stroke:"",fontSize:12,fontStyle:"",fontWeight:"",fill:"",textFill:"",ext:30,lineDashType:"solid"},edge:null}},mounted:function(){var t=this;x.$on("selectEdge",(function(e){var i=e.edge.getData();t.edge=e.edge,t.edgeData=jo({},t.edgeData,{},i)})),x.$on("changeLanguage",(function(t){c(t.language)})),this.language=localStorage.getItem("localeLanguage")||"zh",c(this.language)},methods:{showColorPicker:function(t){switch(t){case"stroke":this.edgeData.fillshow=!1,this.edgeData.textfillshow=!1,this.edgeData.fontsizeshow=!1,this.edgeData.extshow=!1,this.edgeData.strokeshow?this.edgeData.strokeshow=!1:this.edgeData.strokeshow=!0;break;case"textFill":this.edgeData.fillshow=!1,this.edgeData.strokeshow=!1,this.edgeData.fontsizeshow=!1,this.edgeData.extshow=!1,this.edgeData.textfillshow?this.edgeData.textfillshow=!1:this.edgeData.textfillshow=!0;break;case"fontsize":this.edgeData.fillshow=!1,this.edgeData.strokeshow=!1,this.edgeData.textfillshow=!1,this.edgeData.extshow=!1,this.edgeData.fontsizeshow?this.edgeData.fontsizeshow=!1:this.edgeData.fontsizeshow=!0;break;case"fill":this.edgeData.fontsizeshow=!1,this.edgeData.strokeshow=!1,this.edgeData.textfillshow=!1,this.edgeData.extshow=!1,this.edgeData.fillshow?this.edgeData.fillshow=!1:this.edgeData.fillshow=!0;break;case"ext":this.edgeData.fontsizeshow=!1,this.edgeData.strokeshow=!1,this.edgeData.textfillshow=!1,this.edgeData.fillshow=!1,this.edgeData.extshow?this.edgeData.extshow=!1:this.edgeData.extshow=!0;break}},getRgba:function(t){var e=t.rgba,i="rgba(".concat(e.r,",").concat(e.g,",").concat(e.b,",").concat(e.a,")");return i},updateStroke:function(t){var e=this.getRgba(t);this.edgeData.stroke=e,x.$emit("changeEdge",{style:{stroke:e},mark:"line",edge:this.edge})},updateTextFill:function(t){var e=this.getRgba(t);this.edgeData.textFill=e,x.$emit("changeEdge",{style:{textFill:e},mark:"text",edge:this.edge})},updateFill:function(t){var e=this.getRgba(t);this.edgeData.fill=e,x.$emit("changeEdge",{style:{fill:e},mark:"text",edge:this.edge})},pickFontSize:function(t){this.edgeData.fontSize!=t&&(this.edgeData.fontSize=t,x.$emit("changeEdge",{mark:"text",style:{fontSize:t},edge:this.edge}))},pickExt:function(t){this.edgeData.ext!=t&&(this.edgeData.ext=t,x.$emit("changeEdge",{mark:"line",style:{ext:t},edge:this.edge}))},setStyle:function(){"italic"==this.edgeData.fontStyle?(this.edgeData.fontStyle="",x.$emit("changeEdge",{style:{fontStyle:""},edge:this.edge,mark:"text"})):(this.edgeData.fontStyle="italic",x.$emit("changeEdge",{style:{fontStyle:"italic"},edge:this.edge,mark:"text"}))},setBold:function(){"bold"==this.edgeData.fontWeight?(this.edgeData.fontWeight="",x.$emit("changeEdge",{style:{fontWeight:""},edge:this.edge,mark:"text"})):(this.edgeData.fontWeight="bold",x.$emit("changeEdge",{style:{fontWeight:"bold"},edge:this.edge,mark:"text"}))},changeLineType:function(t){this.edgeData.type=t,x.$emit("changeEdge",{mark:"type",style:{type:t},edge:this.edge})},changeLineDash:function(t){this.edgeData.lineDashType=t,x.$emit("changeEdge",{mark:"type",style:{lineDashType:t},edge:this.edge})},hideWin:function(t){var e=t.target,i=!1;while(e){if(1==e.nodeType&&e&&e.className&&e.className.indexOf("vc-sketch")>-1){i=!0;break}e=e.parentElement}i||this.hideColorPicker()},hideColorPicker:function(){this.edgeData.fillshow=!1,this.edgeData.strokeshow=!1,this.edgeData.textfillshow=!1,this.edgeData.fontsizeshow=!1,this.edgeData.extshow=!1}}},No=Eo,zo=(i("d51a"),Object(w["a"])(No,So,To,!1,null,"647d7996",null)),Fo=zo.exports,Go={name:"Property",components:{Node:uo,Group:wo,"v-canvas":Po,Edge:Fo},data:function(){return{showCanvas:!0,showGroup:!1,showNode:!1,showLink:!1,showEdge:!1,node:null,group:null,nodes:null,edge:null}},mounted:function(){var t=this;x.$on("clearSelect",(function(){t.showGroup=!1,t.showNode=!1,t.showLink=!1,t.showCanvas=!0,t.showEdge=!1})),x.$on("selectNode",(function(){t.showGroup=!1,t.showNode=!0,t.showLink=!1,t.showCanvas=!1,t.showEdge=!1})),x.$on("selectNodes",(function(){t.showGroup=!1,t.showNode=!0,t.showLink=!1,t.showCanvas=!1,t.showEdge=!1})),x.$on("selectLink",(function(){t.showGroup=!1,t.showNode=!1,t.showLink=!0,t.showCanvas=!1,t.showEdge=!1})),x.$on("selectGroup",(function(){t.showGroup=!0,t.showNode=!1,t.showLink=!1,t.showCanvas=!1,t.showEdge=!1})),x.$on("selectEdge",(function(){t.showGroup=!1,t.showNode=!1,t.showLink=!1,t.showCanvas=!1,t.showEdge=!0}))},methods:{}},_o=Go,Bo=(i("dd11"),Object(w["a"])(_o,Zi,to,!1,null,"78e8f960",null)),Io=Bo.exports,Ro=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"flow-map",staticStyle:{display:"none"}},[i("div",{staticClass:"flowmap-container",on:{mousedown:t.mousedown,mousemove:t.mousemove,mouseup:t.mouseup}},[i("div",{attrs:{id:"canvas-map"}})])])},Lo=[],$o={name:"Map",data:function(){return{width:0,height:0,sx:0,sy:0,dx:0,dy:0,pos:[],drag:!1}},mounted:function(){var t=this,e=document.getElementById("canvas-map");this.width=e.offsetWidth,this.height=e.offsetHeight;var i=this.width/this.height;this.mapeditor=new Fi("canvas-map"),this.mapeditor.offEvent(),x.$on("refreshMap",(function(e){var o=e.editor;t.edit=e.editor;var n=JSON.stringify(o.getData()),a=o.getBoundingRect(o.nodes.concat(o.groups).concat(o.edges)),s=a.width,r=a.height,h=s/r,c=1;c=h>i?t.width/a.width:t.height/a.height,t.mapeditor.init(JSON.parse(n),!0),t.mapeditor.attr({position:[-a.x*c,-a.y*c],scale:[c,c]})}))},methods:{mousedown:function(t){this.pos=this.edit.position.slice(),this.sx=t.offsetX,this.sy=t.offsetY,this.drag=!0},mousemove:function(t){this.drag&&(this.dx=t.offsetX-this.sx,this.dy=t.offsetY-this.sy,this.edit.attr({position:[this.pos[0]-2*this.dx,this.pos[1]-2*this.dy]}))},mouseup:function(){this.drag=!1,this.dx=0,this.dy=0,this.pos=[0,0]}}},Mo=$o,Wo=(i("5490"),Object(w["a"])(Mo,Ro,Lo,!1,null,null,null)),Uo=Wo.exports,Ho={name:"MainPage",components:{Header:k,Toolbar:C,Editor:Vi,Property:Io,Map:Uo},data:function(){return{}},mounted:function(){}},qo=Ho,Jo=(i("8e49"),Object(w["a"])(qo,f,p,!1,null,"22f80f01",null)),Yo=Jo.exports,Ko={name:"app",components:{MainPage:Yo}},Qo=Ko,Xo=(i("034f"),Object(w["a"])(Qo,d,u,!1,null,null,null)),Vo=Xo.exports;i("a75e");o["a"].config.productionTip=!1,new o["a"]({i18n:l,render:function(t){return t(Vo)}}).$mount("#app")},"6dad":function(t,e,i){},7269:function(t,e,i){"use strict";var o=i("3efa"),n=i.n(o);n.a},"859b":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFYAAABXCAYAAACeCrJSAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAGSSURBVHhe7dkxisJQGEXh2XY2YpPGIo2NjUWaELCxcAPuwDVYCG/mwS+IRp0k78CEOQduoaYwHyKafCVDEhZKWKgn2NPp5Gbs1iCsTUtYKGGhhIUSFkpYKGGhhIUSFkpYKGGhhIUSFkpYKGGhhIUSFkpYKGGhhIUSFkpYKGGhhIUSFurfw57P53Q8HuNRuYT9ga2qKh0Oh3imTMIGbN5+v49n5yfsHWxe13XxyryEfYDNa9s2Xp2esAOwebvdLo6YlrAvYPO2220cNT5h38DmbTabOHJcwn6AzWuaJo7+fShs3/eDb3SJW6/X6Xq9xpl9TtgRq+s6XS6XOLv3CTtyq9Uqzu59wo6Yn1hgf+o7dgkt8lfBEvJ3LJT/vKBewXqtYGZDsF7dKtAjrNdjC3UP6x2Egt1gvedVuAzrXdoFJSyUsFDCQgkLJSyUsFDCQgkLJSyUsFDCQgkLJSyUsFDCQgkLJSyUsFDCQgkLJSyUsFDCQgkLJSyUsFDCQgkLJSzUR1g3fbeeYK1MwkIJCyUsUkrfK3jHcL47ZMgAAAAASUVORK5CYII="},"85ec":function(t,e,i){},"8dc2":function(t,e,i){"use strict";var o=i("d79d"),n=i.n(o);n.a},"8e49":function(t,e,i){"use strict";var o=i("9860"),n=i.n(o);n.a},9168:function(t,e,i){"use strict";var o=i("4813"),n=i.n(o);n.a},9860:function(t,e,i){},a6b6:function(t,e,i){},a75e:function(t,e,i){},ae26:function(t,e,i){"use strict";var o=i("cd6c"),n=i.n(o);n.a},be14:function(t,e,i){"use strict";var o=i("3e69"),n=i.n(o);n.a},cd6c:function(t,e,i){},d51a:function(t,e,i){"use strict";var o=i("e489"),n=i.n(o);n.a},d79d:function(t,e,i){},dc17:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFUAAABVCAYAAAA49ahaAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAGbSURBVHhe7dKxagJBFEbhvLbgM9jb2ChY2NjYiNjY2Fj7JDYWbrjChsgOJlGPe4ecAz8s4+4UH3409vJEBRIV6Ab1eDy6J9bWQbXHEhVIVCBRgUQFEhVIVCBRgUQFEhVIVCBRgapEPZ1O12WtOtTz+dyMx+Pr4jljVaFeLpdmMpk0g8HguniOs2xVhTqdTr9A28VZtqpBnc/nHdB28VumqkBdLBZFzO+Ld7KUHnW5XBYRS4t3M5QadbVaFfHuLb7pu7So6/W6iPabxbd9lhJ1u90Wsf6yuKOv0qHudrsi0iOLu/ooFep+vy/iPLO4892lQT0cDs1sNru70WjUQYuz0rvfF3e/s1T/1J/abDYd1DjLlqhAogKJCiQqkKhAogKJCiQqkKhAogKJCiQqkKhAogKJCiQqkKhAogKJCiQqkKhAogKJCiQqkKhAogKJCiQqkKhAogKJCiQqkKhAogKJCiQqkKhAogKJCiQqUHWow+HwZqL+k0QFEhVIVCBRgUQFEhVIVCBRgUQFEhXoLqp7fG03qPaaRH15TfMJ/HS/NAYMi2AAAAAASUVORK5CYII="},dd11:function(t,e,i){"use strict";var o=i("42ec"),n=i.n(o);n.a},e489:function(t,e,i){},edd4:function(t){t.exports=JSON.parse('{"node":{"title1":"Single Node","titl2":"Multiple Node","head":"Style","fill":"Fill","stroke":"Stroke","font":"Font","fontStyle":"Font Style","fontSize":"Font Size","textFill":"Text Fill","nodeAlign":"Node Alignment","position":"Position","prefabrication":"Prefabrication Style"},"group":{"head":"Style","fill":"Fill","stroke":"Stroke","showHead":"Show Head","font":"Font","fontStyle":"Font Style","fontSize":"Font Size","fontBackground":"Font Background","align":"Text Align","textFill":"Text Fill","position":"Position","prefabrication":"Prefabrication Style"},"edge":{"head":"Style","fill":"Fill","stroke":"Stroke","lineDash":"Line Dash","lineStyle":"Line Style","turningDistance":"Turning Distance","font":"Font","fontStyle":"Font Style","fontSize":"Font Size","textFill":"Text Fill","nodeAlign":"Node Alignment","position":"Position","prefabrication":"Prefabrication Style"}}')},ee1c:function(t,e,i){"use strict";var o=i("6dad"),n=i.n(o);n.a}});
//# sourceMappingURL=app.d39cd0f0.js.map